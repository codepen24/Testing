<?php
/**
 * Copyright (c) 2012-2020 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 if (! defined('ABSPATH') ) { die(); } final class wpalm4is_gfgl50 { private $wpdb; private $sessions_table; private $ttl; private $simultaneous_sessions; private $encrypted; function __construct() { global $wpdb; $this->wpdb = $wpdb; $this->sessions_table = MEMBERIUM_DB_SESSIONS; $this->ttl = (int) ini_get('session.gc_maxlifetime'); $this->simultaneous_sessions = 0; $this->encrypted = function_exists('gzuncompress') && function_exists('gzcompress'); return true; } function __destruct() { return true; } function wpalm4is_a4z9ar0k($vwpalm4is__mnral5zjy) { $this->sessions_table = $vwpalm4is__mnral5zjy; return true; } function wpalm4is_ghksyf1($vwpalm4is_i3hgti6) { $this->wpdb = $vwpalm4is_i3hgti6; return true; } function wpalm4is_nuh95in($vwpalm4is_ngld2o_6) { $this->simultaneous_sessions = (int) $vwpalm4is_ngld2o_6; return true; } function wpalm4is_m0im4bzvr8($vwpalm4is_tvumqo5219hz) { $this->ttl = (int) $vwpalm4is_tvumqo5219hz; return true; } function wpalm4is_nie2r1tfkx($vwpalm4is_d0jmun374, $vwpalm4is_uu98y_3) { return true; } function wpalm4is_ge7lj5xnouk() { return true; } function wpalm4is_mznx1t4d_($vwpalm4is_x3e6m_hobj) { $vwpalm4is_cevdqnb5lzm = "SELECT `value` FROM `{$this->sessions_table}` WHERE `session_key` = %s "; $vwpalm4is_ukra4p = $this->wpdb->prepare($vwpalm4is_cevdqnb5lzm, $vwpalm4is_x3e6m_hobj); $elvdata = $this->wpdb->get_var($vwpalm4is_ukra4p); if (empty($vwpalm4is_n0wrho_2u) ) { return ''; } $vwpalm4is_cevdqnb5lzm = "UPDATE `{$this->sessions_table}` SET `expiration` = %d WHERE `session_key` = %s "; $vwpalm4is_cevdqnb5lzm = $this->wpdb->prepare($vwpalm4is_cevdqnb5lzm, time() + $this->ttl, $vwpalm4is_x3e6m_hobj); $this->wpdb->query($vwpalm4is_cevdqnb5lzm); if ($this->encrypted && substr($vwpalm4is_n0wrho_2u, 0, 2) == 'eN') { $vwpalm4is_n0wrho_2u = gzuncompress(base64_decode($vwpalm4is_n0wrho_2u) ); } session_decode($vwpalm4is_n0wrho_2u); return $vwpalm4is_n0wrho_2u; } function wpalm4is_g56gc21nriew($vwpalm4is_x3e6m_hobj, $vwpalm4is_n0wrho_2u) { if (empty($vwpalm4is_n0wrho_2u) ) { return true; } global $user_email, $user_login; $vwpalm4is_cbjka3o = (! empty($user_login) ) ? strtolower($user_login) : ''; $vwpalm4is__diwln = (! empty($user_email) ) ? strtolower($user_email) : '';  if ($this->simultaneous_sessions == 1) { if ($vwpalm4is__diwln > '' && isset($_SESSION['admin']) && (int) $_SESSION['admin'] == 0) { $vwpalm4is_cevdqnb5lzm = "DELETE FROM `{$this->sessions_table}` WHERE `email_key` = %s AND `session_key` <> %s"; $vwpalm4is_cevdqnb5lzm = $this->wpdb->prepare($vwpalm4is_cevdqnb5lzm, $vwpalm4is__diwln, $vwpalm4is_x3e6m_hobj); $vwpalm4is_kmqnwo6cu5 = $this->wpdb->query($vwpalm4is_cevdqnb5lzm); } }  if ($this->encrypted) { $vwpalm4is_n0wrho_2u = base64_encode(gzcompress($vwpalm4is_n0wrho_2u, 9) ); } $vwpalm4is_cevdqnb5lzm = "REPLACE INTO `{$this->sessions_table}` (session_key, email_key, expiration, value) VALUES (%s, %s, %d, %s)"; $vwpalm4is_cevdqnb5lzm = $this->wpdb->prepare($vwpalm4is_cevdqnb5lzm, $vwpalm4is_x3e6m_hobj, $vwpalm4is__diwln, time() + $this->ttl, $vwpalm4is_n0wrho_2u); $vwpalm4is_kmqnwo6cu5 = $this->wpdb->query($vwpalm4is_cevdqnb5lzm); $row_id = $this->wpdb->insert_id; return $row_id; } function wpalm4is_jyor0gea7982($vwpalm4is_x3e6m_hobj) { $vwpalm4is_cevdqnb5lzm = "DELETE FROM {$this->sessions_table} WHERE `session_key` = %s"; $vwpalm4is_cevdqnb5lzm = $this->wpdb->prepare($vwpalm4is_cevdqnb5lzm, $vwpalm4is_x3e6m_hobj); $vwpalm4is_ukra4p = $this->wpdb->query($vwpalm4is_cevdqnb5lzm); return true; } static function wpalm4is_i087ke($vwpalm4is_do3ci428ufr) { global $wpdb; $vwpalm4is__mnral5zjy = MEMBERIUM_DB_SESSIONS; $vwpalm4is_yq9zlicjw = time(); $vwpalm4is_cevdqnb5lzm = "DELETE FROM `{$vwpalm4is__mnral5zjy}` WHERE `expiration` < {$vwpalm4is_yq9zlicjw} OR value = ''; " ; $vwpalm4is_kmqnwo6cu5 = $wpdb->query($vwpalm4is_cevdqnb5lzm); return $vwpalm4is_kmqnwo6cu5; } }
