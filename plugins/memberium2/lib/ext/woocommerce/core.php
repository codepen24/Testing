<?php
/**
 * Copyright (c) 2017-2020 David J Bullock
 * Web Power and Light
 */

 if (! defined('ABSPATH') ) { die(); }  class wpalm4is_plex8z { public $post_keys = array( 'canc' => '_memberium_canc_tag', 'main' => '_memberium_main_tag', 'payf' => '_memberium_payf_tag', 'susp' => '_memberium_susp_tag', ); function __construct() { $this->wpalm4is_qka65vyfn(); if (is_admin() ) { new wpalm4is_xw64g5(); } else { new wpalm4is_yh1ztwbc(); } }  private function wpalm4is_qka65vyfn() { add_action('woocommerce_order_status_changed', array($this, 'wpalm4is_omp50sxner'), 10, 3); add_action('woocommerce_subscription_status_updated', array($this, 'wpalm4is_ousxect'), 10, 3); } private function wpalm4is_zev2j07hxr($vwpalm4is_vg4wlrco) { return; $vwpalm4is_g87myl0d = array( 'fields' => array( 'email' => $vwpalm4is_vg4wlrco->get_billing_email, 'first_name' => $vwpalm4is_vg4wlrco->get_billing_first_name, 'last_name' => $vwpalm4is_vg4wlrco->get_billing_last_name,  ), );  return $vwpalm4is_s13i75n4ph; } private function wpalm4is_m7bzhskdf4l($vwpalm4is_wikmdre, $vwpalm4is_ecxbw_) { if (empty($vwpalm4is_ecxbw_) || ! $vwpalm4is_wikmdre) { return; } $vwpalm4is_yq9zlicjw = current_time('mysql'); $vwpalm4is_ecxbw_ = trim($vwpalm4is_ecxbw_); if ( is_user_logged_in() ) { $vwpalm4is_n_bsw6d3x = wp_get_current_user(); $vwpalm4is_tcon6xrp = $vwpalm4is_n_bsw6d3x->ID; $vwpalm4is_y47lrh = $vwpalm4is_n_bsw6d3x->user_login; $vwpalm4is_ix8ejwc = $vwpalm4is_n_bsw6d3x->user_email; } else { $vwpalm4is_tcon6xrp = 0; $vwpalm4is_y47lrh = 'System'; $vwpalm4is_ix8ejwc = ''; } $vwpalm4is_x3g_pkm01u6 = array( 'comment_agent' => 'Memberium', 'comment_approved' => 1, 'comment_author_email' => $vwpalm4is_ix8ejwc, 'comment_author_IP' => '', 'comment_author_url' => '', 'comment_author' => $vwpalm4is_y47lrh, 'comment_content' => $vwpalm4is_ecxbw_, 'comment_date' => $vwpalm4is_yq9zlicjw, 'comment_parent' => 0, 'comment_post_ID' => (int) $vwpalm4is_wikmdre, 'comment_type' => 'order_note', 'user_id' => $vwpalm4is_tcon6xrp, ); wp_insert_comment($vwpalm4is_x3g_pkm01u6); } private function wpalm4is_c6x1eg($vwpalm4is_s13i75n4ph, $vwpalm4is_flb8_x3u, $vwpalm4is_b3i5ys_4twb, $vwpalm4is_p3kdx08if) { if ($vwpalm4is_s13i75n4ph && $vwpalm4is_flb8_x3u) { $vwpalm4is_gf2m1t7v8nbz = $this->wpalm4is__3p8xf($vwpalm4is_flb8_x3u); $vwpalm4is_jt4c7masel5p = ''; $vwpalm4is_zml72n91_6 = 'Memberium '; $vwpalm4is_fpd84rz3 = array( 'active', 'completed', 'processing' ); $vwpalm4is_u91hpm2k6qe0 = array( 'cancelled', 'expired', 'refunded' ); if ( in_array($vwpalm4is_p3kdx08if, $vwpalm4is_fpd84rz3) ) { memberium_app()->wpalm4is_yp5awiqcv($vwpalm4is_gf2m1t7v8nbz['main'], $vwpalm4is_s13i75n4ph); memberium_app()->wpalm4is_yp5awiqcv(0 - $vwpalm4is_gf2m1t7v8nbz['canc'], $vwpalm4is_s13i75n4ph); memberium_app()->wpalm4is_yp5awiqcv(0 - $vwpalm4is_gf2m1t7v8nbz['payf'], $vwpalm4is_s13i75n4ph); memberium_app()->wpalm4is_yp5awiqcv(0 - $vwpalm4is_gf2m1t7v8nbz['susp'], $vwpalm4is_s13i75n4ph); if ($vwpalm4is_gf2m1t7v8nbz['main']) $vwpalm4is_jt4c7masel5p .= "{$vwpalm4is_zml72n91_6} added tag {$vwpalm4is_gf2m1t7v8nbz['main']}<br>"; if ($vwpalm4is_gf2m1t7v8nbz['canc']) $vwpalm4is_jt4c7masel5p .= "{$vwpalm4is_zml72n91_6} removed tag {$vwpalm4is_gf2m1t7v8nbz['canc']}<br>"; if ($vwpalm4is_gf2m1t7v8nbz['payf']) $vwpalm4is_jt4c7masel5p .= "{$vwpalm4is_zml72n91_6} removed tag {$vwpalm4is_gf2m1t7v8nbz['payf']}<br>"; if ($vwpalm4is_gf2m1t7v8nbz['susp']) $vwpalm4is_jt4c7masel5p .= "{$vwpalm4is_zml72n91_6} removed tag {$vwpalm4is_gf2m1t7v8nbz['susp']}<br>"; } elseif ($vwpalm4is_p3kdx08if == 'failed') { memberium_app()->wpalm4is_yp5awiqcv($vwpalm4is_gf2m1t7v8nbz['payf'], $vwpalm4is_s13i75n4ph); if ($vwpalm4is_gf2m1t7v8nbz['main']) $vwpalm4is_jt4c7masel5p .= "{$vwpalm4is_zml72n91_6} added tag {$vwpalm4is_gf2m1t7v8nbz['payf']}<br>"; } elseif ( in_array($vwpalm4is_p3kdx08if, $vwpalm4is_u91hpm2k6qe0) ) { memberium_app()->wpalm4is_yp5awiqcv($vwpalm4is_gf2m1t7v8nbz['canc'], $vwpalm4is_s13i75n4ph); if ($vwpalm4is_gf2m1t7v8nbz['main']) $vwpalm4is_jt4c7masel5p .= "{$vwpalm4is_zml72n91_6} added tag {$vwpalm4is_gf2m1t7v8nbz['canc']}<br>"; } elseif ($vwpalm4is_p3kdx08if == 'expired') { memberium_app()->wpalm4is_yp5awiqcv(0 - $vwpalm4is_gf2m1t7v8nbz['main'], $vwpalm4is_s13i75n4ph); if ($vwpalm4is_gf2m1t7v8nbz['main']) $vwpalm4is_jt4c7masel5p .= "{$vwpalm4is_zml72n91_6} removed tag {$vwpalm4is_gf2m1t7v8nbz['main']}<br>"; } elseif ($vwpalm4is_p3kdx08if == 'on-hold') { memberium_app()->wpalm4is_yp5awiqcv($vwpalm4is_gf2m1t7v8nbz['susp'], $vwpalm4is_s13i75n4ph); if ($vwpalm4is_gf2m1t7v8nbz['main']) $vwpalm4is_jt4c7masel5p .= "{$vwpalm4is_zml72n91_6} added tag {$vwpalm4is_gf2m1t7v8nbz['susp']}<br>"; } } $this->wpalm4is_m7bzhskdf4l($vwpalm4is_b3i5ys_4twb, $vwpalm4is_jt4c7masel5p); }  function wpalm4is_scn5_dtuk() { return $this->post_keys; } function wpalm4is__3p8xf($vwpalm4is_flb8_x3u) { $vwpalm4is_ougfb1hd = get_post_meta($vwpalm4is_flb8_x3u); $vwpalm4is_gf2m1t7v8nbz = array(); if (is_array($vwpalm4is_ougfb1hd) ) { foreach($this->post_keys as $vwpalm4is_gtyqfor0c8ib => $vwpalm4is_x3e6m_hobj) { $vwpalm4is_gf2m1t7v8nbz[$vwpalm4is_gtyqfor0c8ib] = empty($vwpalm4is_ougfb1hd[$vwpalm4is_x3e6m_hobj][0]) ? 0 : $vwpalm4is_ougfb1hd[$vwpalm4is_x3e6m_hobj][0]; } } return $vwpalm4is_gf2m1t7v8nbz; }  function wpalm4is_ousxect($vwpalm4is_rgln0x3j, $vwpalm4is_lgdz8lu54eh6, $vwpalm4is_g97mo3kjf) { $vwpalm4is_tcon6xrp = $vwpalm4is_rgln0x3j->get_user_id(); if (! $vwpalm4is_tcon6xrp) { return; } $vwpalm4is_s13i75n4ph = wpalm4is_bd5uye4ng3l::wpalm4is_titrm5z4( $vwpalm4is_tcon6xrp ); if (! $vwpalm4is_s13i75n4ph) { return; } $vwpalm4is_yper_0m = $vwpalm4is_rgln0x3j->get_items(); if (is_array($vwpalm4is_yper_0m) && ! empty($vwpalm4is_yper_0m) ) { foreach($vwpalm4is_yper_0m as $vwpalm4is_hl1pcu => $vwpalm4is_vnz9uf) { $vwpalm4is_flb8_x3u = $vwpalm4is_vnz9uf->get_product_id(); if ( in_array($vwpalm4is_lgdz8lu54eh6, array('on-hold', 'cancelled', 'expired', 'refunded') ) ) { $vwpalm4is_zcit2lqg4ynb = wcs_user_has_subscription($vwpalm4is_tcon6xrp, $vwpalm4is_flb8_x3u, 'active'); if ($vwpalm4is_zcit2lqg4ynb) { break; } } $this->wpalm4is_c6x1eg($vwpalm4is_s13i75n4ph, $vwpalm4is_flb8_x3u, $vwpalm4is_rgln0x3j->id, $vwpalm4is_lgdz8lu54eh6); } } } function wpalm4is_omp50sxner($vwpalm4is_b3i5ys_4twb, $vwpalm4is_g97mo3kjf, $vwpalm4is_lgdz8lu54eh6) { $vwpalm4is_vg4wlrco = wc_get_order($vwpalm4is_b3i5ys_4twb); $vwpalm4is_tcon6xrp = $vwpalm4is_vg4wlrco->get_user_id(); if (! $vwpalm4is_tcon6xrp) { return; } $vwpalm4is_s13i75n4ph = wpalm4is_bd5uye4ng3l::wpalm4is_titrm5z4($vwpalm4is_tcon6xrp); if (! $vwpalm4is_s13i75n4ph) { return; } $vwpalm4is_yper_0m = $vwpalm4is_vg4wlrco->get_items(); if (is_array($vwpalm4is_yper_0m) && ! empty($vwpalm4is_yper_0m) ) { foreach ($vwpalm4is_yper_0m as $item_key => $vwpalm4is_vnz9uf ) { $vwpalm4is_flb8_x3u = $vwpalm4is_vnz9uf->get_product_id(); $this->wpalm4is_c6x1eg($vwpalm4is_s13i75n4ph, $vwpalm4is_flb8_x3u, $vwpalm4is_b3i5ys_4twb, $vwpalm4is_lgdz8lu54eh6); } } } }
