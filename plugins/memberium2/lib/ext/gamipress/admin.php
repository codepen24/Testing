<?php
/**
 * Copyright (c) 2020-2020 David J Bullock
 * Web Power and Light
 */

 if ( !defined( 'ABSPATH' ) ) { die(); } final class wpalm4is_iwzdr6 { function __construct() { add_action('admin_init', array( __CLASS__, 'wpalm4is_y6ib81tr') ); add_filter('memberium_unenhanced_posts', array(__CLASS__, 'wpalm4is_ia9kjbif'), 10, 1); } static function wpalm4is_y6ib81tr() { self::wpalm4is_xwt0jsx7_(); } static function wpalm4is_ia9kjbif($vwpalm4is_s0jqewt256 =array() ) { $vwpalm4is_s0jqewt256[] = 'achievement-type'; $vwpalm4is_s0jqewt256[] = 'nomination'; $vwpalm4is_s0jqewt256[] = 'step'; $vwpalm4is_s0jqewt256[] = 'submission'; $achievements = self::wpalm4is__nb2s89j1(); $vwpalm4is_s0jqewt256 = array_merge($vwpalm4is_s0jqewt256, $achievements); return $vwpalm4is_s0jqewt256; } static function wpalm4is__nb2s89j1() { global $wpdb; static $vwpalm4is_y9tvm2 = array(); if (empty($vwpalm4is_y9tvm2) ) { $vwpalm4is_cevdqnb5lzm = "SELECT LOWER(`post_name`) FROM `{$wpdb->posts}` WHERE `post_type` = 'achievement-type' AND `post_status` = 'publish'"; $vwpalm4is_ss713erkxf0w = $wpdb->get_col( $vwpalm4is_cevdqnb5lzm, 0 ); $vwpalm4is_y9tvm2 = is_array($vwpalm4is_ss713erkxf0w) ? $vwpalm4is_ss713erkxf0w : $vwpalm4is_y9tvm2; } return $vwpalm4is_y9tvm2; } static function wpalm4is_xwt0jsx7_() { $vwpalm4is_xvesxnc2dk = wpalm4is_yf0g75hqk184::wpalm4is_hd05wlqk(); $vwpalm4is_eutwzgxo_ = self::wpalm4is__nb2s89j1(); if (in_array($vwpalm4is_xvesxnc2dk, $vwpalm4is_eutwzgxo_) ) { add_meta_box( 'memberium-gamipress-achievements', 'Memberium for GamiPress', array(__CLASS__, 'wpalm4is_xv5_b01r' ), $vwpalm4is_xvesxnc2dk, 'side' ); } if ($_SERVER['REQUEST_METHOD'] == 'POST' && isset($_POST['post_type']) && in_array($_POST['post_type'], $vwpalm4is_eutwzgxo_) ) { add_action('save_post', array(__CLASS__, 'wpalm4is_ft7z6h') ); } } static function wpalm4is_xv5_b01r() { global $post; $vwpalm4is_q9orgp = get_post_meta($post->ID, '_memberium_gamipress_badge_add', true); $vwpalm4is_f3gfs_ = get_post_meta($post->ID, '_memberium_gamipress_tag_add', true); echo '<label for="_memberium_gamipress_badge_add">', _e( "Add Badge if Member has Tag", 'memberium' ), ':</label> '; echo '<input name="_memberium_gamipress_badge_add" class="taglistdropdown" style="width:100%; max-width:100%" value="', ( empty($vwpalm4is_q9orgp) ? 0 : $vwpalm4is_q9orgp ), '"><br /><br />'; echo '<label for="_memberium_gamipress_tag_add">', _e( "Add Tag if Member has Badge", 'memberium' ), ':</label> '; echo '<input name="_memberium_gamipress_tag_add" class="taglistdropdown" style="width:100%; max-width:100%" value="', ( empty($vwpalm4is_f3gfs_) ? 0 : $vwpalm4is_f3gfs_ ), '"><br /><br />'; do_action('memberium/gamipress/achievement_metabox'); } static function wpalm4is_ft7z6h($vwpalm4is_wikmdre) { if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) { return; } if (! current_user_can('edit_posts', $vwpalm4is_wikmdre) ) { return; } $vwpalm4is_obr60wde = array( '_memberium_gamipress_badge_add', '_memberium_gamipress_tag_add', ); foreach($vwpalm4is_obr60wde as $vwpalm4is_ndxvp20) { if (isset($_POST[$vwpalm4is_ndxvp20]) ) { update_post_meta($vwpalm4is_wikmdre, $vwpalm4is_ndxvp20, (int) $_POST[$vwpalm4is_ndxvp20]); } } $vwpalm4is_eutwzgxo_ = self::wpalm4is__nb2s89j1(); $vwpalm4is_g87myl0d = array( 'numberposts' => -1, 'order' => 'ASC', 'orderby' => 'ID', 'post_status' => 'publish', 'post_type' => $vwpalm4is_eutwzgxo_, 'fields' => 'ids', ); $vwpalm4is_pr8_ucow9jsf = get_posts($vwpalm4is_g87myl0d); $vwpalm4is_ugmxi_sw = array(); foreach($vwpalm4is_pr8_ucow9jsf as $vwpalm4is_vzoj7cv_rsly) { $vwpalm4is_agvwtn = get_post_meta($vwpalm4is_vzoj7cv_rsly, '_memberium_gamipress_badge_add', true); if ($vwpalm4is_agvwtn) { $vwpalm4is_ugmxi_sw[$vwpalm4is_vzoj7cv_rsly] = $vwpalm4is_agvwtn; } } update_option('memberium/gamipress/assign_by_tag', $vwpalm4is_ugmxi_sw); $vwpalm4is_ugmxi_sw = array(); foreach($vwpalm4is_pr8_ucow9jsf as $vwpalm4is_vzoj7cv_rsly) { $vwpalm4is_agvwtn = get_post_meta($vwpalm4is_vzoj7cv_rsly, '_memberium_gamipress_tag_add', true); if ($vwpalm4is_agvwtn) { $vwpalm4is_ugmxi_sw[$vwpalm4is_vzoj7cv_rsly] = $vwpalm4is_agvwtn; } } update_option('memberium/gamipress/tag_by_badge', $vwpalm4is_ugmxi_sw);  } }
