<?php
/**
 * Copyright (c) 2012-2020 David J Bullock
 * Web Power and Light
 */

 if (! defined( 'ABSPATH' ) ) { die(); } return new wpalm4is_k6v7joebh_4x; final class wpalm4is_k6v7joebh_4x { private $version = '2.4'; private $core;  private $add_child_actionset = 0;  private $child_cancel_actionset = 0;  private $parent_added_actionset = 0;  private $child_field = 'ReferralCode';  private $inherited_fields = '';  private $max_child_accounts = 10;  private $max_child_field = '';  private $parent_cache_ttl = 86400;  private $parent_field = 'ReferralCode'; private $settings = array();  private $tag_mask = '';  private $tag_mask_field = '';  private $tag_translation = array();  private $enabled = false; private $doing_raw_load = false; function __construct() { $this->settings = $this->wpalm4is_fizdgcx9sf(); if ( empty( $this->settings['enabled'] ) ) { return; } $this->wpalm4is_qka65vyfn(); $this->wpalm4is_q7j5kbqf4ta(); } private function wpalm4is_qka65vyfn() { add_action('learndash_quiz_completed', array( $this, 'learndash_quiz_email_notifications' ), 5, 1 ); add_action('memberium_email_change', array( $this, 'wpalm4is_aoe5qty' ) ); add_filter('learndash_get_report_user_ids', array( $this, 'wpalm4is_ki73jp' ), 10, 1 ); add_filter('memberium_contact_load', array( $this, 'wpalm4is_cjkyt7146m_' ), 10, 1 ); add_filter('memberium/umbrella/child_contact_ids', array( $this, 'wpalm4is_g_judeq' ), 10, 1 ); add_filter('memberium/umbrella/child_wpuser_ids', array( $this, 'wpalm4is__wpcv_4ln' ), 10, 1 ); add_filter('memberium/umbrella/child_count', array( $this, 'wpalm4is_aos53p0fz1ig' ), 10, 1 ); add_filter('memberium/umbrella/parent_wpuser_id', array( $this, 'wpalm4is_jc96kt0sj' ), 10, 1 ); if ( defined( 'DOING_CRON' ) ) { add_action('memberium_maintenance12', array( $this, 'wpalm4is_if_i8m' ) ); } } function wpalm4is_jdo0j8leua26() { return $this->version; } function wpalm4is_fizdgcx9sf() { $this->settings = get_option('memberium_umbrella_settings', array() ); $vwpalm4is_vx_n8e7hdrbo = array( 'add_child_actionset' => 0, 'child_cancel_actionset' => 0, 'child_field' => 'ReferralCode', 'ecommerce' => 1, 'inherited_fields' => '', 'ld_quiz_notify_parent' => 0, 'max_child_accounts' => 10, 'parent_added_actionset' => 0, 'parent_cache_ttl' => 86400, 'parent_field' => 'ReferralCode', 'parent_tags' => '', 'tag_mask' => '', 'tag_mask_field' => '', 'tag_translation' => array(), ); $this->settings = wp_parse_args( $this->settings, $vwpalm4is_vx_n8e7hdrbo ); foreach( $this->settings as $vwpalm4is_x3e6m_hobj => $vwpalm4is_kh9vqi_6znd ) { $this->$vwpalm4is_x3e6m_hobj = $this->settings[$vwpalm4is_x3e6m_hobj]; } return $this->settings; } function wpalm4is_v_2cr1ktz3o( $vwpalm4is_ne17fdv8uw4 = false ) { if ( $vwpalm4is_ne17fdv8uw4 === false ) { $vwpalm4is_ne17fdv8uw4 = $this->settings; } update_option( 'memberium_umbrella_settings', $vwpalm4is_ne17fdv8uw4, 'yes' ); }  function wpalm4is_aw8t69( $vwpalm4is_gf2m1t7v8nbz = '' ) { $this->tag_mask = trim( $vwpalm4is_gf2m1t7v8nbz ); $this->settings['tag_mask'] = $this->tag_mask; } function wpalm4is_glmx02fa( $vwpalm4is_f7zvtgq8jid = '' ) { $this->tag_mask_field = $vwpalm4is_f7zvtgq8jid; $this->settings['tag_mask_field'] = $this->tag_mask_field; } function wpalm4is_lakwb9ds2( $vwpalm4is_tvumqo5219hz = 86400 ) { $this->parent_cache_ttl = (int) $vwpalm4is_tvumqo5219hz; $this->settings['parent_cache_ttl'] = $this->parent_cache_ttl; } function wpalm4is_mr5g6f_e( $vwpalm4is_cbkmin3z = 'Email' ) { $this->child_field = $vwpalm4is_cbkmin3z; $this->settings['child_field'] = $this->child_field; } function wpalm4is_mbya_u1sv6e5( $vwpalm4is_a0g4be2, $vwpalm4is_mkticrm6p5bd = true ) { if ( $vwpalm4is_mkticrm6p5bd === null ) { unset( $this->inherited_fields[$vwpalm4is_a0g4be2] ); } else { $this->inherited_fields[$vwpalm4is_a0g4be2] = (boolean) $vwpalm4is_mkticrm6p5bd; } $this->settings['inherited_fields'] = $this->inherited_fields; } function wpalm4is_vrpdt1( $vwpalm4is_jvxp5qj04s = 0, $vwpalm4is_kjgrya36m = 0 ) { if ( ! $vwpalm4is_jvxp5qj04s && ! $vwpalm4is_kjgrya36m ) { return; } if ( $vwpalm4is_kjgrya36m == 0 ) { unset( $this->tag_translation[$vwpalm4is_jvxp5qj04s] ); } if ( $vwpalm4is_kjgrya36m > 0 ) { $this->tag_translation[$vwpalm4is_jvxp5qj04s] = $vwpalm4is_kjgrya36m; } $this->settings['tag_translation'] = $this->tag_translation; } function wpalm4is_c5xjraek( $vwpalm4is_cjd8z3u4y = 'Email3' ) { $this->parent_field = $vwpalm4is_cjd8z3u4y; $this->settings['parent_field'] = $this->parent_field; } function wpalm4is_pcls469( $vwpalm4is_h7x_hqbtks6a ) { $vwpalm4is_h7x_hqbtks6a = (int) $vwpalm4is_h7x_hqbtks6a; $this->add_child_actionset = (int) $vwpalm4is_h7x_hqbtks6a; $this->settings['add_child_actionset'] = $this->add_child_actionset; } function wpalm4is_uhrico( $vwpalm4is_h7x_hqbtks6a ) { $vwpalm4is_h7x_hqbtks6a = (int) $vwpalm4is_h7x_hqbtks6a; $this->parent_added_actionset = (int) $vwpalm4is_h7x_hqbtks6a; $this->settings['parent_added_actionset'] = $this->parent_added_actionset; } function wpalm4is_rp_ilv057u( $vwpalm4is_h7x_hqbtks6a ) { $vwpalm4is_h7x_hqbtks6a = (int) $vwpalm4is_h7x_hqbtks6a; $this->child_cancel_actionset = (int) $vwpalm4is_h7x_hqbtks6a; $this->settings['child_cancel_actionset'] = $this->child_cancel_actionset; }  function wpalm4is_pg4n8rxdawbs() { return $this->settings['tag_mask']; } function wpalm4is_o95037() { return $this->settings['parent_cache_ttl']; } function wpalm4is_iyj1kuq0l() { return $this->settings['tag_mask_field']; } function wpalm4is_tave46() { return $this->settings['parent_field']; } function wpalm4is_cvhgqber() { return $this->settings['child_field']; } function wpalm4is_t3ny_58() {  $vwpalm4is_z3qlki = (int) $this->settings['max_child_accounts'];  if ( ! empty( $this->settings['child_count_add'] ) ) { $vwpalm4is_x3e6m_hobj = strtolower( $this->settings['child_count_add'] ); $vwpalm4is_z3qlki = $vwpalm4is_z3qlki + (int) wpalm4is_xamhc3q6o::wpalm4is_lxnykv81pr( $vwpalm4is_x3e6m_hobj ); }  if ( ! empty( $this->settings['tag_grants'] ) ) { foreach( $this->settings['tag_grants'] as $vwpalm4is_umca1b6 => $vwpalm4is_kh9vqi_6znd ) { if ( wpalm4is_l9n25d::wpalm4is_vodyxmki9r( $vwpalm4is_umca1b6 ) ) { $vwpalm4is_z3qlki = $vwpalm4is_z3qlki + $vwpalm4is_kh9vqi_6znd; } } }  if ( $this->settings['ecommerce'] ) { $vwpalm4is_f_cfqo = memberium_app()->wpalm4is_eze0o74d1p(); if ( ! empty( $vwpalm4is_f_cfqo ) ) { $vwpalm4is__x67loz_sgdw = date('Ymd') . 'T23:59:59'; foreach( $vwpalm4is_f_cfqo as $vwpalm4is_rgln0x3j ) { if ($vwpalm4is_rgln0x3j['Status'] == 'Active' || $vwpalm4is_rgln0x3j['EndDate'] > $vwpalm4is__x67loz_sgdw) { $vwpalm4is_s74ine = $vwpalm4is_rgln0x3j['SubscriptionPlanId']; $vwpalm4is_z3qlki = $vwpalm4is_z3qlki + ( empty( $this->settings['subscriptions'][$vwpalm4is_s74ine] ) ? 0 : ($this->settings['subscriptions'][$vwpalm4is_s74ine] * $vwpalm4is_rgln0x3j['Qty']) ); } } } }  $vwpalm4is_z3qlki = apply_filters( 'umbrella_child_count', $vwpalm4is_z3qlki ); return $vwpalm4is_z3qlki; } function wpalm4is_haw7tzofj9ep() { return $this->settings['add_child_actionset']; } function wpalm4is_sdq0j4wm_() { return $this->settings['parent_added_actionset']; } function wpalm4is_uxfb9c_54a() { return $this->settings['child_cancel_actionset']; }    function wpalm4is_q7j5kbqf4ta() { if ( wp_doing_ajax() || ! is_admin() ) { add_shortcode('umbrella_list_children', array( $this, 'wpalm4is_wq6un58m93o' ) ); add_shortcode('umbrella_child_count', array( $this, 'wpalm4is_b74nmg' ) ); add_shortcode('umbrella_enroll_child', array( $this, 'wpalm4is_v9ora8cdxy' ) ); add_shortcode('umbrella_list_children_nav', array( $this, 'wpalm4is_dkltnubyov' ) ); add_shortcode('umbrella_ld_course_info', array( $this, 'wpalm4is_oslyhz3c9r7' ) ); add_shortcode('umbrella_lms_dashboard', array($this, 'wpalm4is_k05ip2gruqmx') ); add_shortcode('umbrella_transfer_points', array($this, 'wpalm4is_cc82wugk3h7') ); add_shortcode('umbrella_download_csv', array($this, 'wpalm4is_aktwgp8i_') ); if ( isset( $_POST['formtype'] ) && $_POST['formtype'] == 'childenroll' ) { $this->wpalm4is_z7dmlws(); } elseif ( isset( $_POST['formtype'] ) && $_POST['formtype'] == 'childdisconnect' ) { $this->wpalm4is_irjywicu(); } elseif (! empty($_POST['umbrella_transfer_points_wpnonce']) ) { $this->wpalm4is_y1w6c38gbzrp(); } elseif (! empty($_POST['umbrella_download_csv_wpnonce']) ) { $this->wpalm4is_zqis9xrwa(); } } } function wpalm4is_if_i8m() { }    function wpalm4is_ki73jp( $vwpalm4is_iiy2tsd0 ) { $vwpalm4is_lt34k6ngj = $this->wpalm4is__wpcv_4ln(); $vwpalm4is_iiy2tsd0 = array_merge( $vwpalm4is_iiy2tsd0, $vwpalm4is_lt34k6ngj ); return $vwpalm4is_iiy2tsd0; } function wpalm4is_cjkyt7146m_( $vwpalm4is_jbucldi1t7q = array() ) { if ( empty( $vwpalm4is_jbucldi1t7q ) ) { return $vwpalm4is_jbucldi1t7q; } if ( $this->doing_raw_load ) { return $vwpalm4is_jbucldi1t7q; } global $i2sdk; $this->settings = $this->wpalm4is_fizdgcx9sf(); $vwpalm4is_raeyrlsbw80m = $this->wpalm4is_tave46(); $vwpalm4is_wbq1j7 = $this->wpalm4is_cvhgqber(); $vwpalm4is_otbf5j62h = $this->wpalm4is_iyj1kuq0l(); $vwpalm4is_mm350t4 = ! empty( $vwpalm4is_jbucldi1t7q[$vwpalm4is_wbq1j7] ) ? $vwpalm4is_jbucldi1t7q[$vwpalm4is_wbq1j7] : ''; $vwpalm4is_hp41oja['memb_db_fields']['groups'] = isset( $vwpalm4is_jbucldi1t7q['Groups'] ) ? $vwpalm4is_jbucldi1t7q['Groups'] : '';  if ( empty( $vwpalm4is_mm350t4 ) && wpalm4is_l9n25d::wpalm4is_vodyxmki9r( $this->settings['parent_tags'], $vwpalm4is_hp41oja ) ) { if ( ! in_array( $vwpalm4is_raeyrlsbw80m, array( 'Email', 'EmailAddress2', 'EmailAddress3' ) ) ) { $vwpalm4is_jbucldi1t7q[$vwpalm4is_raeyrlsbw80m] = $this->wpalm4is_j64w31b985m(); $vwpalm4is_iomhdlzi73g5 = array( $vwpalm4is_raeyrlsbw80m => $vwpalm4is_jbucldi1t7q[$vwpalm4is_raeyrlsbw80m] ); if ( ! empty( $vwpalm4is_jbucldi1t7q['Id'] ) ) { $i2sdk->isdk->updateCon( (int) $vwpalm4is_jbucldi1t7q['Id'], $vwpalm4is_iomhdlzi73g5 );  $vwpalm4is_jzygsq8e = $this->doing_raw_load; $this->doing_raw_load = true; memberium_app()->wpalm4is_kfhs9u7mp0o4( $vwpalm4is_jbucldi1t7q['Id'] ); $this->doing_raw_load = $vwpalm4is_jzygsq8e; } } return $vwpalm4is_jbucldi1t7q; }  if ( empty( $vwpalm4is_jbucldi1t7q[$vwpalm4is_wbq1j7] ) ) { return $vwpalm4is_jbucldi1t7q; }  if ( wpalm4is_l9n25d::wpalm4is_vodyxmki9r( $this->settings['parent_tags'], $vwpalm4is_hp41oja ) ) { return $vwpalm4is_jbucldi1t7q; } if ( empty( $vwpalm4is_mm350t4 ) ) { return $vwpalm4is_jbucldi1t7q; } if ( ! empty( $vwpalm4is_mm350t4 ) ) { $vwpalm4is_g87myl0d = array( 'parent_id' => $vwpalm4is_mm350t4, 'contact_id' => $vwpalm4is_jbucldi1t7q['Id'], 'contact' => $vwpalm4is_jbucldi1t7q, ); $vwpalm4is_pbpk_qav4m = $this->wpalm4is_gqe6y1f0a3( $vwpalm4is_g87myl0d ); if ( $vwpalm4is_pbpk_qav4m > 0 ) { $vwpalm4is_g87myl0d = array( 'contact_id' => $vwpalm4is_pbpk_qav4m, 'cache_ttl' => $this->wpalm4is_o95037() ); memberium_app()->wpalm4is_r6wmi2bj81l9( $vwpalm4is_g87myl0d ); $vwpalm4is_jbucldi1t7q['!parent_id'] = $vwpalm4is_pbpk_qav4m; $this->doing_raw_load = true; $vwpalm4is_zzxbm4y9q = wpalm4is_bd5uye4ng3l::wpalm4is_cad0k_3hp7m( $vwpalm4is_pbpk_qav4m ); $this->doing_raw_load = false; $vwpalm4is_igxrbnckyfd = explode( ',', $this->settings['parent_tags'] ); $vwpalm4is_i8b361 = isset( $vwpalm4is_zzxbm4y9q['Groups'] ) ? array_filter( explode( ',', $vwpalm4is_zzxbm4y9q['Groups'] ) ) : array(); $vwpalm4is_r_lvoem = isset( $vwpalm4is_zzxbm4y9q[$vwpalm4is_otbf5j62h] ) ? array_filter( explode( ',', $vwpalm4is_zzxbm4y9q[$vwpalm4is_otbf5j62h] ) ) : array(); $vwpalm4is_vsrqt8p = array_filter( explode( ',', $this->wpalm4is_pg4n8rxdawbs() ) ); $vwpalm4is_dlfhec8 = $this->settings['tag_translation']; $vwpalm4is_mbe36i4 = isset( $this->settings['whitelist_memberships'] ) ? explode( ',', $this->settings['whitelist_memberships'] ) : array(); $vwpalm4is_i8b361 = array_diff( $vwpalm4is_i8b361, $vwpalm4is_igxrbnckyfd );   if ( ! empty( $this->settings['tag_whitelist'] ) || ! empty( $this->settings['whitelist_memberships'] ) ) { $vwpalm4is_mbe36i4 = array_filter( explode( ',', $this->settings['tag_whitelist'] ) ); if ( ! empty( $this->settings['whitelist_memberships'] ) ) { $vwpalm4is_la4pzw = wpalm4is_xb7t0i6pzn::wpalm4is_s0xuab5fq6hy(); $vwpalm4is_la4pzw = $vwpalm4is_la4pzw['memberships']; foreach( $vwpalm4is_la4pzw as $vwpalm4is_mp_ceis8 ) { $vwpalm4is_mbe36i4[] = (int) $vwpalm4is_mp_ceis8['main_id']; $vwpalm4is_mbe36i4[] = (int) $vwpalm4is_mp_ceis8['addltag_ids']; $vwpalm4is_mbe36i4[] = (int) $vwpalm4is_mp_ceis8['payf_id']; $vwpalm4is_mbe36i4[] = (int) $vwpalm4is_mp_ceis8['cancel_id']; $vwpalm4is_mbe36i4[] = (int) $vwpalm4is_mp_ceis8['suspend_id']; } unset( $vwpalm4is_la4pzw, $vwpalm4is_mp_ceis8 ); $vwpalm4is_mbe36i4 = array_filter( $vwpalm4is_mbe36i4 ); } $vwpalm4is_i8b361 = array_intersect( $vwpalm4is_i8b361, $vwpalm4is_mbe36i4 ); } else {   $vwpalm4is_i8b361 = array_diff( $vwpalm4is_i8b361, $vwpalm4is_vsrqt8p, $vwpalm4is_r_lvoem ); }  if ( is_array( $vwpalm4is_dlfhec8 ) ) { foreach( $vwpalm4is_dlfhec8 as $vwpalm4is__zo8_jdkqhv => $vwpalm4is_fy48se1ob ) { $vwpalm4is_x3e6m_hobj = array_search( $vwpalm4is__zo8_jdkqhv, $vwpalm4is_i8b361 ); if ( $vwpalm4is_x3e6m_hobj !== false ) { $vwpalm4is_i8b361[$vwpalm4is_x3e6m_hobj] = $vwpalm4is_fy48se1ob; } } } $vwpalm4is_jbucldi1t7q['Groups'] = implode( ',', array_unique( array_filter( array_merge( explode( ',', $vwpalm4is_jbucldi1t7q['Groups'] ), $vwpalm4is_i8b361 ) ) ) ); $vwpalm4is_iyhd9cgr = array_filter( explode( ',', $this->inherited_fields ) );  if ( ! empty( $vwpalm4is_iyhd9cgr ) ) { foreach( $vwpalm4is_iyhd9cgr as $vwpalm4is_a0g4be2 ) { if ( empty( $vwpalm4is_jbucldi1t7q[$vwpalm4is_a0g4be2] ) ) { $vwpalm4is_jbucldi1t7q[$vwpalm4is_a0g4be2] = $vwpalm4is_zzxbm4y9q[$vwpalm4is_a0g4be2]; } } } } } return $vwpalm4is_jbucldi1t7q; } function wpalm4is_aoe5qty( $vwpalm4is_s13i75n4ph = 0, $vwpalm4is_tcon6xrp = 0, $vwpalm4is_va2ithfpq8_ = '', $vwpalm4is_dzqjf460 = '' ) { $vwpalm4is_sx9boc5r3sz = $this->wpalm4is_cvhgqber(); $lparent_field = strtolower( $this->wpalm4is_tave46() ); if ( ! in_array( $lparent_field, array( 'email', 'emailaddress2', 'emailaddress3' ) ) ) { return; } if ( empty( $vwpalm4is_va2ithfpq8_ ) || empty( $vwpalm4is_dzqjf460 ) ) { return; } $vwpalm4is_g87myl0d = array( $vwpalm4is_sx9boc5r3sz => $vwpalm4is_va2ithfpq8_ ); $vwpalm4is_njgibx8dwk0s = $this->wpalm4is_g_judeq( $vwpalm4is_g87myl0d ); if ( is_array( $vwpalm4is_njgibx8dwk0s ) && ! empty( $vwpalm4is_njgibx8dwk0s ) ) { foreach( $vwpalm4is_njgibx8dwk0s as $vwpalm4is_s13i75n4ph ) { $vwpalm4is_iomhdlzi73g5 = array( $vwpalm4is_sx9boc5r3sz => $vwpalm4is_dzqjf460, ); $i2sdk->isdk->updateCon( $vwpalm4is_s13i75n4ph, $vwpalm4is_iomhdlzi73g5 );  } } }    function wpalm4is_j64w31b985m() { return uniqid( 'prnt-', true ); } function wpalm4is_gqe6y1f0a3( $vwpalm4is_g87myl0d = array() ) { global $i2sdk, $wpdb; if ( empty( $vwpalm4is_g87myl0d['contact_id'] ) ) { return false; } $vwpalm4is_jbucldi1t7q = empty( $vwpalm4is_g87myl0d['contact'] ) ? array() : $vwpalm4is_g87myl0d['contact']; $vwpalm4is_s13i75n4ph = empty( $vwpalm4is_g87myl0d['contact_id'] ) ? 0 : $vwpalm4is_g87myl0d['contact_id']; $vwpalm4is_pbpk_qav4m = empty( $vwpalm4is_g87myl0d['parent_id'] ) ? 0 : $vwpalm4is_g87myl0d['parent_id']; $vwpalm4is_o3jon4aztf = $this->settings['child_field']; $vwpalm4is_kk63y_ = explode( ',', $this->settings['parent_tags'] ); $vwpalm4is_uqgkov8 = false; if ( empty( $vwpalm4is_jbucldi1t7q[$vwpalm4is_o3jon4aztf] ) ) { return false; } $vwpalm4is_vx_n8e7hdrbo = array( 'appname' => wpalm4is_xb7t0i6pzn::wpalm4is_mz346l5qyv('appname'), 'contact_id' => isset( $vwpalm4is_jbucldi1t7q['Id'] ) ? $vwpalm4is_jbucldi1t7q['Id'] : 0, 'child_field' => $this->settings['child_field'], 'parent_id' => isset( $vwpalm4is_jbucldi1t7q[$vwpalm4is_o3jon4aztf] ) ? $vwpalm4is_jbucldi1t7q[$vwpalm4is_o3jon4aztf] : '', ); $vwpalm4is_g87myl0d = wp_parse_args( $vwpalm4is_g87myl0d, $vwpalm4is_vx_n8e7hdrbo ); $vwpalm4is_g87myl0d['parent_id'] = $this->wpalm4is_el4sp0c71( $vwpalm4is_g87myl0d['parent_id'], 'parent' ); $vwpalm4is__mnral5zjy = MEMBERIUM_DB_CONTACTS; $vwpalm4is_cevdqnb5lzm = "SELECT `c1`.`id`, `c2`.`value` as `tags` FROM `{$vwpalm4is__mnral5zjy}` AS `c1`, `{$vwpalm4is__mnral5zjy}` AS `c2` WHERE `c1`.`appname` = %s AND `c1`.`fieldname` = %s AND `c1`.`value` = %s AND `c1`.`id` <> %d AND `c2`.`id` = `c1`.`id` AND `c2`.`fieldname` = 'Groups' ORDER BY `c1`.`id`; "; $vwpalm4is_cevdqnb5lzm = $wpdb->prepare( $vwpalm4is_cevdqnb5lzm, $vwpalm4is_g87myl0d['appname'], $vwpalm4is_g87myl0d['child_field'], $vwpalm4is_g87myl0d['parent_id'], $vwpalm4is_g87myl0d['contact_id'] ); $vwpalm4is_zzxbm4y9q = $wpdb->get_row( $vwpalm4is_cevdqnb5lzm ); $vwpalm4is_gf2m1t7v8nbz = explode( ',', $vwpalm4is_zzxbm4y9q->tags ); if ( array_intersect( $vwpalm4is_kk63y_, $vwpalm4is_gf2m1t7v8nbz ) ) { $vwpalm4is_uqgkov8 = $vwpalm4is_zzxbm4y9q->id; } return $vwpalm4is_uqgkov8; } function wpalm4is_aos53p0fz1ig( $vwpalm4is_g87myl0d = array() ) { global $i2sdk, $wpdb; $vwpalm4is_dd4j20qwmn_ = wpalm4is_xb7t0i6pzn::wpalm4is_mz346l5qyv('appname'); $vwpalm4is_sx9boc5r3sz = $this->settings['child_field']; $vwpalm4is_be2swpbuin5 = wpalm4is_xamhc3q6o::wpalm4is_sxkjpbr0vhs3(); $vwpalm4is_r72p_1 = strtolower( $this->settings['parent_field'] ); $vwpalm4is_s13i75n4ph = isset( $vwpalm4is_g87myl0d['contact_id'] ) ? $vwpalm4is_g87myl0d['contact_id'] : $vwpalm4is_be2swpbuin5; $vwpalm4is_pbpk_qav4m = memberium_app()->wpalm4is_pfjn0pa( $vwpalm4is_s13i75n4ph, $vwpalm4is_sx9boc5r3sz ); $vwpalm4is_cm4b8pug = MEMBERIUM_DB_CONTACTS; $vwpalm4is_vx_n8e7hdrbo = array( 'appname' => $vwpalm4is_dd4j20qwmn_, 'child_field' => $vwpalm4is_sx9boc5r3sz, 'contact_id' => $vwpalm4is_s13i75n4ph, 'limit' => 0, 'offset' => 0, 'parent_id' => $vwpalm4is_pbpk_qav4m, ); $vwpalm4is_g87myl0d = wp_parse_args( $vwpalm4is_g87myl0d, $vwpalm4is_vx_n8e7hdrbo ); if ( $vwpalm4is_g87myl0d['parent_id'] <> $this->wpalm4is_el4sp0c71( $vwpalm4is_g87myl0d['parent_id'], 'parent' ) ) { return array(); } $vwpalm4is_g87myl0d['parent_id'] = $this->wpalm4is_el4sp0c71( $vwpalm4is_g87myl0d['parent_id'], 'child' ); $vwpalm4is_cevdqnb5lzm = "SELECT count(*) FROM `{$vwpalm4is_cm4b8pug}` WHERE `appname` = %s AND `fieldname` = %s AND `value` = %s AND `id` <> %d "; $vwpalm4is_cevdqnb5lzm = $wpdb->prepare( $vwpalm4is_cevdqnb5lzm, $vwpalm4is_g87myl0d['appname'], $vwpalm4is_g87myl0d['child_field'], $vwpalm4is_g87myl0d['parent_id'], $vwpalm4is_g87myl0d['contact_id'] ); $vwpalm4is_z3qlki = $wpdb->get_var( $vwpalm4is_cevdqnb5lzm ); return $vwpalm4is_z3qlki; } function wpalm4is_jc96kt0sj($vwpalm4is_g87myl0d = array() ) { $vwpalm4is_vx_n8e7hdrbo = array( 'user_id' => get_current_user_id(), ); $vwpalm4is_g87myl0d = wp_parse_args($vwpalm4is_g87myl0d, $vwpalm4is_vx_n8e7hdrbo); if ( memberium_app()->wpalm4is_gm7uj2r($vwpalm4is_g87myl0d['user_id'])) { return isset($_SESSION['memb_db_fields']['!parent_id']) ? $_SESSION['memb_db_fields']['!parent_id'] : 0; } } function wpalm4is_g_judeq( $vwpalm4is_g87myl0d = array() ) { global $i2sdk, $wpdb; $vwpalm4is_dd4j20qwmn_ = wpalm4is_xb7t0i6pzn::wpalm4is_mz346l5qyv('appname'); $vwpalm4is_sx9boc5r3sz = $this->settings['child_field']; $vwpalm4is_be2swpbuin5 = wpalm4is_xamhc3q6o::wpalm4is_sxkjpbr0vhs3(); $vwpalm4is_r72p_1 = strtolower( $this->settings['parent_field'] ); $vwpalm4is_s13i75n4ph = isset( $vwpalm4is_g87myl0d['contact_id'] ) ? $vwpalm4is_g87myl0d['contact_id'] : $vwpalm4is_be2swpbuin5; $vwpalm4is_pbpk_qav4m = memberium_app()->wpalm4is_pfjn0pa( $vwpalm4is_s13i75n4ph, $vwpalm4is_sx9boc5r3sz ); $vwpalm4is_cm4b8pug = MEMBERIUM_DB_CONTACTS; $vwpalm4is_vx_n8e7hdrbo = array( 'appname' => $vwpalm4is_dd4j20qwmn_, 'child_field' => $vwpalm4is_sx9boc5r3sz, 'contact_id' => $vwpalm4is_s13i75n4ph, 'limit' => 0, 'offset' => 0, 'parent_id' => $vwpalm4is_pbpk_qav4m, ); $vwpalm4is_g87myl0d = wp_parse_args( $vwpalm4is_g87myl0d, $vwpalm4is_vx_n8e7hdrbo ); if ( $vwpalm4is_g87myl0d['parent_id'] <> $this->wpalm4is_el4sp0c71( $vwpalm4is_g87myl0d['parent_id'], 'parent' ) ) { return array(); } $vwpalm4is_g87myl0d['parent_id'] = $this->wpalm4is_el4sp0c71( $vwpalm4is_g87myl0d['parent_id'], 'child' ); $vwpalm4is_ygtsdbaenz = ( $vwpalm4is_g87myl0d['limit'] > 0 ) ? " LIMIT {$vwpalm4is_g87myl0d['limit']} OFFSET {$vwpalm4is_g87myl0d['offset']} " : ''; $vwpalm4is_cevdqnb5lzm = "
			SELECT `c1`.`id`
			FROM `{$vwpalm4is_cm4b8pug}` AS `c1`
			LEFT JOIN `{$vwpalm4is_cm4b8pug}` AS `c2`
			ON ( `c2`.`id` = `c1`.`id` AND `c2`.`appname` = %s AND `c2`.`fieldname` = 'LastName' )
			LEFT JOIN `{$vwpalm4is_cm4b8pug}` AS `c3`
			ON ( `c3`.`id` = `c1`.`id` AND `c3`.`appname` = %s AND `c3`.`fieldname` = 'FirstName' )
			WHERE `c1`.`appname` = %s
			AND `c1`.`fieldname` = %s
			AND `c1`.`value` = %s
			AND `c1`.`id` <> %d
			ORDER BY `c2`.`value`, `c3`.`value`, `c1`.`id` ASC
			{$vwpalm4is_ygtsdbaenz}
		"; $vwpalm4is_cevdqnb5lzm = $wpdb->prepare( $vwpalm4is_cevdqnb5lzm, $vwpalm4is_g87myl0d['appname'], $vwpalm4is_g87myl0d['appname'], $vwpalm4is_g87myl0d['appname'], $vwpalm4is_g87myl0d['child_field'], $vwpalm4is_g87myl0d['parent_id'], $vwpalm4is_g87myl0d['contact_id'] ); $vwpalm4is_njgibx8dwk0s = $wpdb->get_col( $vwpalm4is_cevdqnb5lzm ); return $vwpalm4is_njgibx8dwk0s; } function wpalm4is__wpcv_4ln( $vwpalm4is_g87myl0d = array() ) { $vwpalm4is_njgibx8dwk0s = $this->wpalm4is_g_judeq( $vwpalm4is_g87myl0d ); if ( empty( $vwpalm4is_njgibx8dwk0s ) ) { return array(); } $wp_user_ids = array(); foreach( $vwpalm4is_njgibx8dwk0s as $vwpalm4is_s13i75n4ph ) { $vwpalm4is_tcon6xrp = wpalm4is_bd5uye4ng3l::wpalm4is_v6egzl2n7( $vwpalm4is_s13i75n4ph ); if ( $vwpalm4is_tcon6xrp ) { $wp_user_ids[] = $vwpalm4is_tcon6xrp; } } return $wp_user_ids; } function wpalm4is_iwo7zaf_y() { $vwpalm4is_njgibx8dwk0s = $this->wpalm4is_g_judeq(); return (int) count( $vwpalm4is_njgibx8dwk0s ); }   function wpalm4is_tufv5st( $vwpalm4is_g87myl0d = array() ) { global $i2sdk, $wpdb; $vwpalm4is_vx_n8e7hdrbo = array( 'child_contact' => array(), 'wpalm4is_i6mowsz12gln' => true, 'optin' => true, 'parent_contact_id' => 0, 'parent_contact' => array(), ); $vwpalm4is_g87myl0d = wp_parse_args( $vwpalm4is_g87myl0d, $vwpalm4is_vx_n8e7hdrbo );   if ( $vwpalm4is_g87myl0d['parent_contact_id'] ) { $vwpalm4is_g87myl0d['parent_contact'] = wpalm4is_bd5uye4ng3l::wpalm4is_cad0k_3hp7m( $vwpalm4is_g87myl0d['parent_contact_id'] ); }  if ( $vwpalm4is_g87myl0d['child_contact_id'] ) { $vwpalm4is_g87myl0d['child_contact'] = wpalm4is_bd5uye4ng3l::wpalm4is_cad0k_3hp7m( $vwpalm4is_g87myl0d['child_contact_id'] ); } if ( empty( $vwpalm4is_g87myl0d['child_contact'] ) || empty( $vwpalm4is_g87myl0d['parent_contact'] ) ) { return -1; }  $vwpalm4is_cjd8z3u4y = $this->wpalm4is_tave46(); $vwpalm4is_wp49onfzby7q = isset( $vwpalm4is_g87myl0d['parent_contact'][$vwpalm4is_cjd8z3u4y] ) ? $vwpalm4is_g87myl0d['parent_contact'][$vwpalm4is_cjd8z3u4y] : ''; if ( empty( $vwpalm4is_wp49onfzby7q ) ) { return -2; }  $vwpalm4is_sx9boc5r3sz = $this->wpalm4is_cvhgqber(); if ( ! empty( $vwpalm4is_g87myl0d['child_contact'][$vwpalm4is_sx9boc5r3sz] ) ) { return -3; }  $vwpalm4is_itc61n3zpfd7 = wpalm4is_xb7t0i6pzn::wpalm4is_s0xuab5fq6hy(); $vwpalm4is_urzq9h = isset( $vwpalm4is_itc61n3zpfd7['settings']['password_field']) ? $vwpalm4is_itc61n3zpfd7['settings']['password_field'] : ''; if ( $vwpalm4is_g87myl0d['wpalm4is_i6mowsz12gln'] && empty( $vwpalm4is_g87myl0d['child_contact'][$vwpalm4is_urzq9h] ) ) { $vwpalm4is_g87myl0d['child_contact'][$vwpalm4is_urzq9h] = memberium_app()->wpalm4is_i6mowsz12gln(); }  if ( empty( $vwpalm4is_g87myl0d['child_contact']['Id'] ) && ! empty( $vwpalm4is_g87myl0d['child_contact_id']['Email'] ) ) { $vwpalm4is_iomhdlzi73g5 = $vwpalm4is_g87myl0d['child_contact']; $vwpalm4is_iomhdlzi73g5[$vwpalm4is_sx9boc5r3sz] = $this->wpalm4is_el4sp0c71( $vwpalm4is_wp49onfzby7q, 'child' ); $vwpalm4is_y28pcxdj_s = (int) $i2sdk->isdk->addWithDupCheck( $vwpalm4is_iomhdlzi73g5, 'Email' ); if ( $vwpalm4is_y28pcxdj_s ) { $vwpalm4is_g87myl0d = array( 'contact_id' => $vwpalm4is_y28pcxdj_s, 'cache_ttl' => 0 ); memberium_app()->wpalm4is_r6wmi2bj81l9( $vwpalm4is_g87myl0d ); $vwpalm4is_g87myl0d['child_contact_id'] = $vwpalm4is_y28pcxdj_s; $vwpalm4is_g87myl0d['child_contact']['Id'] = $vwpalm4is_y28pcxdj_s; if ( $vwpalm4is_g87myl0d['optin'] ) { $i2sdk->isdk->optin( $vwpalm4is_g87myl0d['child_contact']['Email'], 'Added by Memberium Umbrella Account System' ); } $i2sdk->isdk->runAS( (int) $vwpalm4is_y28pcxdj_s, (int) $this->settings['add_child_actionset'] ); $i2sdk->isdk->runAS( (int) $vwpalm4is_g87myl0d['parent_contact_id'], (int) $this->settings['parent_added_actionset'] ); return $vwpalm4is_y28pcxdj_s; } } } function wpalm4is_el4sp0c71( $vwpalm4is_d5kqsi90y = '', $vwpalm4is_wkzcwa_hvu3 = 'raw' ) { if ( ! in_array( substr( $vwpalm4is_d5kqsi90y, 0, 5 ), array( 'chld-', 'prnt-' ) ) ) { $vwpalm4is_wkzcwa_hvu3 = 'raw'; } $vwpalm4is_wkzcwa_hvu3 = strtolower( trim( $vwpalm4is_wkzcwa_hvu3 ) ); if ( $vwpalm4is_wkzcwa_hvu3 == 'parent' ) { return 'prnt-' . substr( $vwpalm4is_d5kqsi90y, 5 ); } elseif ( $vwpalm4is_wkzcwa_hvu3 == 'child' ) { return 'chld-' . substr( $vwpalm4is_d5kqsi90y, 5 ); } else { return $vwpalm4is_d5kqsi90y; } }    function wpalm4is_dkltnubyov( $vwpalm4is_xnx425r3, $vwpalm4is__lstjamupz = null, $vwpalm4is_d5kqsi90y ) { if ( ! wpalm4is_l9n25d::wpalm4is_vodyxmki9r( $this->settings['parent_tags'] ) ) { return; } $vwpalm4is_vx_n8e7hdrbo = array( 'limit' => isset( $_GET['limit'] ) ? (int) $_GET['limit'] : 0, 'page' => isset( $_GET['pg'] ) ? (int) $_GET['pg'] : 1, 'parent_id' => wpalm4is_xamhc3q6o::wpalm4is_sxkjpbr0vhs3(), ); $vwpalm4is_xnx425r3 = shortcode_atts( $vwpalm4is_vx_n8e7hdrbo, $vwpalm4is_xnx425r3, 'memberium' ); if ( $vwpalm4is_xnx425r3['limit'] == 0 ) { return; } $vwpalm4is_xnx425r3['count'] = $this->wpalm4is_aos53p0fz1ig(); $vwpalm4is_xnx425r3['page'] = $vwpalm4is_xnx425r3['page'] < 1 ? 1 : $vwpalm4is_xnx425r3['page']; $vwpalm4is_ecwut_1g0lx = $vwpalm4is_xnx425r3['count'] > 0 ? (int) ceil( $vwpalm4is_xnx425r3['count'] / $vwpalm4is_xnx425r3['limit'] ) : 1; if ( $vwpalm4is_ecwut_1g0lx < 2 ) { return; } $vwpalm4is_xnx425r3['page'] = ( $vwpalm4is_xnx425r3['page'] < 1 ) ? 1 : $vwpalm4is_xnx425r3['page']; $vwpalm4is_biblegoq6c = '<div class="memberium_umbrella_nav" style="width:100%;">'; if ( $vwpalm4is_xnx425r3['page'] > 1 ) { $vwpalm4is_biblegoq6c .= '<span class="memberium_umbrella_nav_previous" style="margin-left:30px;margin-right:30px;"><a href="' . add_query_arg( 'pg', ( $vwpalm4is_xnx425r3['page'] - 1) ) . '">&lt;Previous&gt;</a></span>'; } $vwpalm4is_biblegoq6c .= '<span class="">Page ' . ( $vwpalm4is_xnx425r3['page'] ) . ' of ' . ( $vwpalm4is_ecwut_1g0lx ) . '</span>'; if ( $vwpalm4is_xnx425r3['page'] < $vwpalm4is_ecwut_1g0lx ) { $vwpalm4is_biblegoq6c .= '<span class="memberium_umbrella_nav_next" style="margin-left:30px;margin-right:30px;"><a href="' . add_query_arg( 'pg', ( $vwpalm4is_xnx425r3['page'] + 1 ) ) . '">&lt;Next&gt;</a></span>'; } $vwpalm4is_biblegoq6c .= '</div>'; return $vwpalm4is_biblegoq6c; } function wpalm4is_wq6un58m93o( $vwpalm4is_xnx425r3, $vwpalm4is__lstjamupz = null, $vwpalm4is_d5kqsi90y ) { if ( ! wpalm4is_l9n25d::wpalm4is_vodyxmki9r( $this->settings['parent_tags'] ) ) { return; } $vwpalm4is_vx_n8e7hdrbo = array( 'can_disconnect' => 'y', 'limit' => isset( $_GET['limit'] ) ? (int) $_GET['limit'] : 0, 'page' => isset( $_GET['pg'] ) ? (int) $_GET['pg'] : 1, 'parent_id' => wpalm4is_xamhc3q6o::wpalm4is_sxkjpbr0vhs3(), ); $vwpalm4is_xnx425r3 = shortcode_atts( $vwpalm4is_vx_n8e7hdrbo, $vwpalm4is_xnx425r3, 'memberium' ); $vwpalm4is_xnx425r3['can_disconnect'] = wpalm4is_ba1tqjxc::wpalm4is_f3lrh1o( $vwpalm4is_xnx425r3['can_disconnect'], true ); $vwpalm4is_xnx425r3['page'] = ( $vwpalm4is_xnx425r3['page'] > 0 ) ? $vwpalm4is_xnx425r3['page'] : 1; $vwpalm4is_xnx425r3['page'] = ( $vwpalm4is_xnx425r3['page'] < 1 ) ? 1 : $vwpalm4is_xnx425r3['page']; $vwpalm4is_xnx425r3['parent_id'] = (int) $vwpalm4is_xnx425r3['parent_id']; if ( empty($vwpalm4is_xnx425r3['parent_id']) ) { return; } $vwpalm4is_ww1x6r = ( $vwpalm4is_xnx425r3['page'] - 1 ) * $vwpalm4is_xnx425r3['limit']; if ( $vwpalm4is_xnx425r3['limit'] ) { $vwpalm4is_g87myl0d = array( 'contact_id' => $vwpalm4is_xnx425r3['parent_id'], 'limit' => $vwpalm4is_xnx425r3['limit'], 'offset' => $vwpalm4is_ww1x6r ) ; $vwpalm4is_njgibx8dwk0s = $this->wpalm4is_g_judeq( $vwpalm4is_g87myl0d ); } else { $vwpalm4is_njgibx8dwk0s = $this->wpalm4is_g_judeq(); } $count = count( $vwpalm4is_njgibx8dwk0s ); $vwpalm4is_biblegoq6c = ''; if ( ! empty( $vwpalm4is__lstjamupz ) ) { foreach( $vwpalm4is_njgibx8dwk0s as $vwpalm4is_s13i75n4ph ) { $vwpalm4is_fxavjf2 = $vwpalm4is__lstjamupz; $vwpalm4is_byp_f7 = '<form method="post">'; $vwpalm4is_byp_f7 .= '<input type="hidden" name="formtype" value="childdisconnect">'; $vwpalm4is_byp_f7 .= '<input type="hidden" name="contact_id" value="' . $vwpalm4is_s13i75n4ph . '">'; $vwpalm4is_byp_f7 .= '<input type="hidden" name="signature" value="' . md5( 'mmm' . $vwpalm4is_s13i75n4ph ) . '">'; $vwpalm4is_byp_f7 .= '<input type="submit" value="Disconnect">'; $vwpalm4is_byp_f7 .= '</form>'; $vwpalm4is_fxavjf2 = str_ireplace( '%%contact.id%%', $vwpalm4is_s13i75n4ph, $vwpalm4is_fxavjf2 ); $vwpalm4is_fxavjf2 = str_ireplace( '{{contact.id}}', $vwpalm4is_s13i75n4ph, $vwpalm4is_fxavjf2 ); $vwpalm4is_fxavjf2 = str_ireplace( '%%disconnect.button%%', $vwpalm4is_byp_f7, $vwpalm4is_fxavjf2 ); $vwpalm4is_biblegoq6c .= $vwpalm4is_fxavjf2; } $vwpalm4is_biblegoq6c = do_shortcode( $vwpalm4is_biblegoq6c ); } else { $vwpalm4is_biblegoq6c = "<table style='width:100%;'>"; $vwpalm4is_biblegoq6c .= "<tr>"; $vwpalm4is_biblegoq6c .= '<td>First Name</td>'; $vwpalm4is_biblegoq6c .= '<td>Last Name</td>'; $vwpalm4is_biblegoq6c .= '<td>Email</td>'; $vwpalm4is_biblegoq6c .= '<td>Mobile Phone</td>'; $vwpalm4is_biblegoq6c .= '<td</td>'; $vwpalm4is_biblegoq6c .= "</tr>"; if ( count( $vwpalm4is_njgibx8dwk0s ) ) { foreach( $vwpalm4is_njgibx8dwk0s as $vwpalm4is_s13i75n4ph ) { $vwpalm4is_jbucldi1t7q = wpalm4is_bd5uye4ng3l::wpalm4is_cad0k_3hp7m( $vwpalm4is_s13i75n4ph ); $vwpalm4is_biblegoq6c .= '<tr>'; $vwpalm4is_biblegoq6c .= '<td>' . $vwpalm4is_jbucldi1t7q['FirstName'] . '</td>'; $vwpalm4is_biblegoq6c .= '<td>' . $vwpalm4is_jbucldi1t7q['LastName'] . '</td>'; $vwpalm4is_biblegoq6c .= '<td><a href="mailto:' . $vwpalm4is_jbucldi1t7q['Email'] . '">' . $vwpalm4is_jbucldi1t7q['Email'] . '</a></td>'; $vwpalm4is_biblegoq6c .= '<td>' . $vwpalm4is_jbucldi1t7q['Phone3'] . '</td>'; $vwpalm4is_biblegoq6c .= '<td>'; if ( $vwpalm4is_xnx425r3['can_disconnect'] ) { $vwpalm4is_biblegoq6c .= '<form method="post">'; $vwpalm4is_biblegoq6c .= '<input type="hidden" name="formtype" value="childdisconnect">'; $vwpalm4is_biblegoq6c .= '<input type="hidden" name="contact_id" value="' . $vwpalm4is_jbucldi1t7q['Id'] . '">'; $vwpalm4is_biblegoq6c .= '<input type="hidden" name="signature" value="' . md5( 'mmm' . $vwpalm4is_jbucldi1t7q['Id'] ) . '">'; $vwpalm4is_biblegoq6c .= '<input type="submit" value="Disconnect">'; $vwpalm4is_biblegoq6c .= '</form>'; } $vwpalm4is_biblegoq6c .= '</td>'; $vwpalm4is_biblegoq6c .= '</tr>'; } } else { } $vwpalm4is_biblegoq6c .= "</table>"; } return $vwpalm4is_biblegoq6c; } function wpalm4is_irjywicu() { $vwpalm4is_y28pcxdj_s = (int) $_POST['contact_id']; if ( md5( 'mmm' . $vwpalm4is_y28pcxdj_s ) <> $_POST['signature'] ) { return; } global $i2sdk, $memb_messages; $vwpalm4is_iomhdlzi73g5 = array( $this->wpalm4is_cvhgqber() => '', ); $i2sdk->isdk->updateCon( (int) $vwpalm4is_y28pcxdj_s, $vwpalm4is_iomhdlzi73g5 );  $i2sdk->isdk->runAS( (int) $vwpalm4is_y28pcxdj_s, (int) $this->wpalm4is_uxfb9c_54a() ); memberium_app()->wpalm4is_kfhs9u7mp0o4( $vwpalm4is_y28pcxdj_s ); $memb_messages['flash']['create_child_result'] = '<p style="color:green;font-weight:bold;">' . _x( 'Child Account removed.', 'umbrella_list_children', 'memberium' ) . '</p>'; } function wpalm4is_b74nmg( $vwpalm4is_xnx425r3, $vwpalm4is__lstjamupz = null, $vwpalm4is_d5kqsi90y ) { if ( is_super_admin() ) { return; } if ( ! wpalm4is_l9n25d::wpalm4is_vodyxmki9r( $this->settings['parent_tags'] ) ) { return; } $vwpalm4is_p36h_ia9l = $this->wpalm4is_iwo7zaf_y(); $vwpalm4is_yc48xir9fey = $this->wpalm4is_t3ny_58(); if ( empty( $vwpalm4is_xnx425r3 ) ) { return $vwpalm4is_p36h_ia9l . ' ' . _x( 'of', 'umbrella_child_count', 'memberium' ) . ' ' . $vwpalm4is_yc48xir9fey; } $vwpalm4is_vx_n8e7hdrbo = array( 'cancel_text' => 'Cancel', 'confirm_button' => 'Yes, Stop Subscription', 'confirm_cancel' => 'Keep Subscription', 'confirm_title' => 'Cancel Subscription?', 'confirm' => 0, 'date_format' => 'M d, Y', 'jqueryui' => 1, 'onlyids' => '', 'orderby' => 'StartDate', 'sort' => 'a',  'status' => 'all',  ); $vwpalm4is_xnx425r3 = shortcode_atts( $vwpalm4is_vx_n8e7hdrbo, $vwpalm4is_xnx425r3, 'memberium' ); } function wpalm4is_v9ora8cdxy( $vwpalm4is_xnx425r3, $vwpalm4is__lstjamupz = null, $vwpalm4is_d5kqsi90y ) { global $memb_messages; if ( is_super_admin() ) { return; } if ( ! wpalm4is_l9n25d::wpalm4is_vodyxmki9r( $this->settings['parent_tags'] ) ) { return; } $vwpalm4is_biblegoq6c = ''; $vwpalm4is_z3qlki = $this->wpalm4is_iwo7zaf_y(); if ( $vwpalm4is_z3qlki >= $this->wpalm4is_t3ny_58() ) { return '<p style="subacct_maxed">' . _x( 'All sub accounts Are Assigned.', 'umbrella_enroll_child', 'memberium' ) . '</p>' ; } $vwpalm4is_vx_n8e7hdrbo = array( 'button_text' => 'Add Account', 'form_id' => '', ); foreach($vwpalm4is_xnx425r3 as $vwpalm4is_ndxvp20 => $vwpalm4is_x1folrs) { if (! array_key_exists($vwpalm4is_ndxvp20, $vwpalm4is_vx_n8e7hdrbo) ) { $vwpalm4is_vx_n8e7hdrbo[$vwpalm4is_ndxvp20] = $vwpalm4is_x1folrs; } } $vwpalm4is_xnx425r3 = shortcode_atts( $vwpalm4is_vx_n8e7hdrbo, $vwpalm4is_xnx425r3, 'memberium' ); $vwpalm4is_udenakoq2 = array(); $vwpalm4is_whlc9k0m = '<select name="actions">'; if ( is_array( $vwpalm4is_xnx425r3 ) ) { foreach( $vwpalm4is_xnx425r3 as $vwpalm4is_x3e6m_hobj => $vwpalm4is_kh9vqi_6znd ) { $vwpalm4is_x3e6m_hobj = substr( $vwpalm4is_x3e6m_hobj, 1 ); if ( $vwpalm4is_x3e6m_hobj > 0 || $vwpalm4is_x3e6m_hobj === '0' ) { $vwpalm4is_whlc9k0m .= '<option value="' . $vwpalm4is_x3e6m_hobj . '">' . $vwpalm4is_kh9vqi_6znd . '</option>'; $vwpalm4is_o7jwt1ip[] = $vwpalm4is_x3e6m_hobj; } } } $vwpalm4is_whlc9k0m .= '</select>'; $vwpalm4is_udenakoq2 = is_array( $vwpalm4is_o7jwt1ip ) ? implode( ',', $vwpalm4is_o7jwt1ip ) : ''; if ( empty( $vwpalm4is_o7jwt1ip ) ) { $vwpalm4is_whlc9k0m .= ''; } if ( ! empty( $vwpalm4is__lstjamupz ) ) { $vwpalm4is__lstjamupz = str_ireplace( '%%action.dropdown%%', $vwpalm4is_whlc9k0m, $vwpalm4is__lstjamupz ); } $vwpalm4is_szexg1su6 = base64_encode( serialize( array( 'allowed_actions' => $vwpalm4is_udenakoq2, 'custom' => ! empty( $vwpalm4is__lstjamupz ), ) ) ); $vwpalm4is_o5_we2b = memberium_app()->wpalm4is_k0vfdx( $vwpalm4is_szexg1su6 );  if ( $memb_messages['flash']['create_child_result'] > '' ) { $vwpalm4is_biblegoq6c .= $memb_messages['flash']['create_child_result']; } $vwpalm4is_biblegoq6c .= '<form method="POST" action="" id="' . $vwpalm4is_xnx425r3['form_id'] . '">'; $vwpalm4is_biblegoq6c .= '<input type="hidden" name="formtype" value="childenroll">'; $vwpalm4is_biblegoq6c .= "<input type=\"hidden\" name=\"params\" value=\"{$vwpalm4is_szexg1su6}\">"; $vwpalm4is_biblegoq6c .= "<input type=\"hidden\" name=\"digital_signature\" value=\"{$vwpalm4is_o5_we2b}\">"; $vwpalm4is_biblegoq6c .= wp_nonce_field( 'memb_childenroll', '_wpnonce', true, false ); if ( empty( $vwpalm4is__lstjamupz ) ) { $vwpalm4is_biblegoq6c .= '<label>' . _x( 'First Name:', 'umbrella_enroll_child', 'memberium' ) . '</label><input type="text" value="" name="FirstName" required="required"> *<br />'; $vwpalm4is_biblegoq6c .= '<label>' . _x( 'Last Name:', 'umbrella_enroll_child', 'memberium' ) . '</label><input type="text" value="" name="LastName" required="required"> *<br />'; $vwpalm4is_biblegoq6c .= '<label>' . _x( 'Email Address:', 'umbrella_enroll_child', 'memberium' ) . '</label><input type="email" value="" name="Email" required="required"> *<br />'; $vwpalm4is_biblegoq6c .= '<label>' . _x( 'Mobile Number:', 'umbrella_enroll_child', 'memberium' ) . '</label><input type="tel" value="" name="Phone3"><br />'; } else { $vwpalm4is_biblegoq6c .= do_shortcode( $vwpalm4is__lstjamupz ); } $vwpalm4is_biblegoq6c .= '<label></label><input type="submit" value="' . $vwpalm4is_xnx425r3['button_text'] . '" name=""><br />'; $vwpalm4is_biblegoq6c .= '</form>'; $memb_messages['flash']['create_child_result'] = ''; return $vwpalm4is_biblegoq6c; } function wpalm4is_z7dmlws() { global $i2sdk, $memb_messages; if ( ! wp_verify_nonce( $_POST['_wpnonce'], 'memb_childenroll' ) ) { wp_die( 'Security Check Failed - Nonce Validation Error' ); exit; } if ( ! memberium_app()->wpalm4is_khubmk9j72i3( $_POST['digital_signature'], $_POST['params'] ) ) { wp_die( 'Security Check Failed - Signature Validation Error'); exit; } $vwpalm4is_uqgkov8 = (int) wpalm4is_xamhc3q6o::wpalm4is_sxkjpbr0vhs3(); $vwpalm4is_dd4j20qwmn_ = wpalm4is_xb7t0i6pzn::wpalm4is_mz346l5qyv('appname'); $vwpalm4is_cjd8z3u4y = $this->wpalm4is_tave46(); $vwpalm4is_liux9cd72 = strtolower( $vwpalm4is_cjd8z3u4y ); $vwpalm4is_sx9boc5r3sz = $this->wpalm4is_cvhgqber(); $vwpalm4is_y28pcxdj_s = 0; $vwpalm4is_szexg1su6 = unserialize( base64_decode( $_POST['params'] ) ); $vwpalm4is_udenakoq2 = explode( ',', $vwpalm4is_szexg1su6['allowed_actions'] ); $vwpalm4is_hpdac1306 = isset( $_POST['actions'] ) ? (int) $_POST['actions'] : 0;  if ( ! in_array( $vwpalm4is_hpdac1306, $vwpalm4is_udenakoq2 ) ) { $vwpalm4is_hpdac1306 = 0; } $_POST['Email'] = strtolower( trim( $_POST['Email'] ) ); if ( empty( $_POST['Email'] ) ) { $memb_messages['flash']['create_child_result'] = '<p style="color:red;font-weight:bold;">' . _x( 'Email is Required', 'umbrella_enroll_child', 'memberium' ) . '</p>'; return; } if ( empty( $_POST['FirstName'] ) ) { $memb_messages['flash']['create_child_result'] = '<p style="color:red;font-weight:bold;">' . _x( 'First Name is Required', 'umbrella_enroll_child', 'memberium' ) . '</p>'; return; }  if ( strtolower( trim( $_POST['Email'] ) ) == strtolower( trim( wpalm4is_xamhc3q6o::wpalm4is_lxnykv81pr( $vwpalm4is_sx9boc5r3sz ) ) ) ) { $memb_messages['flash']['create_child_result'] = '<p style="color:red;font-weight:bold;">' . _x( "You can't add yourself.", 'umbrella_enroll_child', 'memberium' ) . '</p>'; return; }  $vwpalm4is_mq3gv6sdxeu = array( 'Id', $vwpalm4is_cjd8z3u4y, $vwpalm4is_sx9boc5r3sz ); $vwpalm4is_en8icj3 = $i2sdk->isdk->findByEmail( $_POST['Email'], $vwpalm4is_mq3gv6sdxeu ); foreach( $vwpalm4is_en8icj3 as $vwpalm4is_vzoj7cv_rsly => $child_contact ) { if ( $child_contact[$vwpalm4is_sx9boc5r3sz] == wpalm4is_xamhc3q6o::wpalm4is_lxnykv81pr( $vwpalm4is_liux9cd72 ) ) { $vwpalm4is_y28pcxdj_s = $child_contact['Id']; } if ( empty( $child_contact[$vwpalm4is_sx9boc5r3sz] ) ) { $vwpalm4is_y28pcxdj_s = $child_contact['Id']; } }  if ( $vwpalm4is_y28pcxdj_s == 0 ) {  $vwpalm4is_pqeydcki_6 = $i2sdk->getInfusionsoftFieldsByTable( 'Contact' ); $vwpalm4is_iomhdlzi73g5 = array(); $vwpalm4is_iomhdlzi73g5[$vwpalm4is_sx9boc5r3sz] = $this->wpalm4is_el4sp0c71( wpalm4is_xamhc3q6o::wpalm4is_lxnykv81pr( $vwpalm4is_liux9cd72 ), 'child' ); foreach ( $_POST as $vwpalm4is_a0g4be2 => $vwpalm4is_kh9vqi_6znd ) { if ( in_array( $vwpalm4is_a0g4be2, $vwpalm4is_pqeydcki_6 ) ) { $vwpalm4is_iomhdlzi73g5[$vwpalm4is_a0g4be2] = stripslashes($vwpalm4is_kh9vqi_6znd); } } $vwpalm4is_y28pcxdj_s = (int) $i2sdk->isdk->addWithDupCheck( $vwpalm4is_iomhdlzi73g5, 'Email' ); $i2sdk->isdk->updateCon( $vwpalm4is_y28pcxdj_s, $vwpalm4is_iomhdlzi73g5 ); if ( $vwpalm4is_y28pcxdj_s > 0 ) { $i2sdk->isdk->optin( $_POST['Email'], 'Added by Memberium Umbrella Account System' ); $i2sdk->isdk->runAS( (int) $vwpalm4is_y28pcxdj_s, (int) $this->settings['child_added_actionset'] ); $i2sdk->isdk->runAS( (int) $vwpalm4is_uqgkov8, (int) $this->settings['parent_added_actionset'] ); if ( $vwpalm4is_hpdac1306 ) { $i2sdk->isdk->runAS( (int) $vwpalm4is_y28pcxdj_s, (int) $vwpalm4is_hpdac1306 ); } $memb_messages['flash']['create_child_result'] = '<p style="color:green;font-weight:bold;">' . _x( 'Child Account added.', 'umbrella_enroll_child', 'memberium' ) . '</p>'; } } else { if ( empty( $child_contact[$vwpalm4is_sx9boc5r3sz] ) ) { $vwpalm4is_iomhdlzi73g5 = array( $vwpalm4is_sx9boc5r3sz => $this->wpalm4is_el4sp0c71( wpalm4is_xamhc3q6o::wpalm4is_lxnykv81pr( $vwpalm4is_liux9cd72 ), 'child' ), ); $i2sdk->isdk->updateCon( $vwpalm4is_y28pcxdj_s, $vwpalm4is_iomhdlzi73g5 );  $i2sdk->isdk->runAS( $vwpalm4is_y28pcxdj_s, (int) $this->settings['child_added_actionset'] ); $i2sdk->isdk->runAS( $vwpalm4is_uqgkov8, (int) $this->settings['parent_added_actionset'] ); if ( $vwpalm4is_hpdac1306 ) { $i2sdk->isdk->runAS( (int) $vwpalm4is_y28pcxdj_s, (int) $vwpalm4is_hpdac1306 ); } $memb_messages['flash']['create_child_result'] = '<p style="color:green;font-weight:bold;">' . _x( 'Child Account assigned.', 'umbrella_enroll_child', 'memberium' ) . '</p>'; } else { $memb_messages['flash']['create_child_result'] = '<p style="color:red;font-weight:bold;">' . _x( 'That account already assigned to a user.', 'umbrella_enroll_child', 'memberium' ) . '</p>'; } }  if ( $vwpalm4is_y28pcxdj_s ) { memberium_app()->wpalm4is_kfhs9u7mp0o4($vwpalm4is_y28pcxdj_s); } do_action('memberium_umbrella_add_child', $vwpalm4is_y28pcxdj_s, $vwpalm4is_uqgkov8); return; } function wpalm4is_oslyhz3c9r7($vwpalm4is_xnx425r3, $vwpalm4is__lstjamupz = null, $vwpalm4is_d5kqsi90y) { if ( ! is_user_logged_in() ) { return; } $vwpalm4is_vx_n8e7hdrbo = array( 'contact_id' => isset( $_GET['contact_id'] ) ? $_GET['contact_id'] : wpalm4is_xamhc3q6o::wpalm4is_sxkjpbr0vhs3(), ); $vwpalm4is_xnx425r3 = shortcode_atts( $vwpalm4is_vx_n8e7hdrbo, $vwpalm4is_xnx425r3, 'memberium' ); $vwpalm4is_xnx425r3['contact_id'] = (int) $vwpalm4is_xnx425r3['contact_id']; if ( ! $vwpalm4is_xnx425r3['contact_id'] ) { return '<p>No valid user to display.</p>'; }  $vwpalm4is_lkl4avtgpxr = is_super_admin();  if ( ! $vwpalm4is_lkl4avtgpxr ) { $vwpalm4is_lt34k6ngj = $this->wpalm4is_g_judeq(); $vwpalm4is_lkl4avtgpxr = in_array( $vwpalm4is_xnx425r3['contact_id'], $vwpalm4is_lt34k6ngj ); }  if ( ! $vwpalm4is_lkl4avtgpxr ) { $vwpalm4is_lkl4avtgpxr = ( $vwpalm4is_xnx425r3['contact_id'] == $_SESSION['memb_db_fields']['id'] ); }  if ( $vwpalm4is_lkl4avtgpxr ) { $vwpalm4is_tcon6xrp = wpalm4is_bd5uye4ng3l::wpalm4is_v6egzl2n7( $vwpalm4is_xnx425r3['contact_id'] ); if ( $vwpalm4is_tcon6xrp ) { return do_shortcode( "[ld_course_info user_id='{$vwpalm4is_tcon6xrp}']" ); } else { $vwpalm4is_lkl4avtgpxr = false; } }  if ( ! $vwpalm4is_lkl4avtgpxr ) { return "<p>Access not permitted to this user's course records</p>"; } } function wpalm4is_k05ip2gruqmx($vwpalm4is_xnx425r3, $vwpalm4is__lstjamupz = null, $vwpalm4is_d5kqsi90y) { if ( ! wpalm4is_l9n25d::wpalm4is_vodyxmki9r( $this->settings['parent_tags'] ) ) { return; } $vwpalm4is_vx_n8e7hdrbo = array( 'course_class' => 'umbrella_lms_dashboard_course', 'course_style' => 'margin-bottom:6px;padding:20px 10px 20px 10px;background-color:#eee;', 'date_format' => 'F j, Y', 'template' => $vwpalm4is_d5kqsi90y, 'user_class' => 'umbrella_lms_dashboard_user', 'user_style' => 'margin-bottom:12px;padding:20px 10px 20px 10px;background-color:#eee;', ); $vwpalm4is_xnx425r3 = shortcode_atts($vwpalm4is_vx_n8e7hdrbo, $vwpalm4is_xnx425r3, 'memberium'); $vwpalm4is_kzbf_tguy6h = array(); $vwpalm4is_pn2ze3wx7s5l = array(); $vwpalm4is_lt34k6ngj = $this->wpalm4is__wpcv_4ln(); if (count($vwpalm4is_lt34k6ngj) ) { $vwpalm4is_g87myl0d = array( 'fields' => array('ID', 'display_name', 'user_email'), 'include' => $vwpalm4is_lt34k6ngj, 'order' => 'ASC', 'orderby' => 'display_name', ); $vwpalm4is_vgmkn5doqef3 = new WP_User_Query( $vwpalm4is_g87myl0d ); $vwpalm4is_kzbf_tguy6h = $vwpalm4is_vgmkn5doqef3->results; } foreach($vwpalm4is_kzbf_tguy6h as $vwpalm4is_x3e6m_hobj => $vwpalm4is_n_bsw6d3x) { $uid = $vwpalm4is_n_bsw6d3x->ID;  if (function_exists('learndash_user_get_enrolled_courses') ) { $vwpalm4is_yoth_dva = learndash_user_get_enrolled_courses($uid); sort($vwpalm4is_yoth_dva); $vwpalm4is_wemxsgpu = get_user_meta($uid, '_sfwd-course_progress', true); $vwpalm4is_kzbf_tguy6h[$vwpalm4is_x3e6m_hobj]->courses = array(); foreach($vwpalm4is_yoth_dva as $vwpalm4is_dyx3_uc2ai) { if (get_post_status($vwpalm4is_dyx3_uc2ai) == 'publish' && get_post_type($vwpalm4is_dyx3_uc2ai) == 'sfwd-courses') { $vwpalm4is_sxkc2voun = get_post($vwpalm4is_dyx3_uc2ai); $vwpalm4is_zyt2re7 = learndash_get_course_steps_count($vwpalm4is_dyx3_uc2ai); $vwpalm4is_las62py_ekh4 = isset($vwpalm4is_wemxsgpu[$vwpalm4is_dyx3_uc2ai]['last_id']) ? $vwpalm4is_wemxsgpu[$vwpalm4is_dyx3_uc2ai]['last_id'] : 0; $vwpalm4is_n3u2ynwc4 = learndash_course_get_completed_steps($uid, $vwpalm4is_dyx3_uc2ai); $vwpalm4is_i2we5gos46 = empty($vwpalm4is_zyt2re7) ? 0 : (int) ($vwpalm4is_n3u2ynwc4 / $vwpalm4is_zyt2re7 * 100); $vwpalm4is_kzbf_tguy6h[$vwpalm4is_x3e6m_hobj]->courses[$vwpalm4is_dyx3_uc2ai] = new stdclass; $vwpalm4is_kzbf_tguy6h[$vwpalm4is_x3e6m_hobj]->courses[$vwpalm4is_dyx3_uc2ai]->course_title = $vwpalm4is_sxkc2voun->post_title; $vwpalm4is_kzbf_tguy6h[$vwpalm4is_x3e6m_hobj]->courses[$vwpalm4is_dyx3_uc2ai]->completed_timestamp = function_exists('learndash_user_get_course_completed_date') ? (int) learndash_user_get_course_completed_date($uid, $vwpalm4is_dyx3_uc2ai) : 0; $vwpalm4is_kzbf_tguy6h[$vwpalm4is_x3e6m_hobj]->courses[$vwpalm4is_dyx3_uc2ai]->course_steps = $vwpalm4is_zyt2re7; $vwpalm4is_kzbf_tguy6h[$vwpalm4is_x3e6m_hobj]->courses[$vwpalm4is_dyx3_uc2ai]->completed_steps = $vwpalm4is_n3u2ynwc4; $vwpalm4is_kzbf_tguy6h[$vwpalm4is_x3e6m_hobj]->courses[$vwpalm4is_dyx3_uc2ai]->step_title = empty($vwpalm4is_las62py_ekh4) ? 'None' : get_the_title($vwpalm4is_las62py_ekh4); $vwpalm4is_kzbf_tguy6h[$vwpalm4is_x3e6m_hobj]->courses[$vwpalm4is_dyx3_uc2ai]->percentage = $vwpalm4is_i2we5gos46; $vwpalm4is_kzbf_tguy6h[$vwpalm4is_x3e6m_hobj]->courses[$vwpalm4is_dyx3_uc2ai]->access_expired = (int) ld_course_access_expired($vwpalm4is_dyx3_uc2ai, $uid); $vwpalm4is_kzbf_tguy6h[$vwpalm4is_x3e6m_hobj]->courses[$vwpalm4is_dyx3_uc2ai]->expiration_timestamp = (int) ld_course_access_expires_on($vwpalm4is_dyx3_uc2ai, $uid); } else { } } }  }  return wpalm4is_ba1tqjxc::wpalm4is_rkqsc9gi7mrx($vwpalm4is_d5kqsi90y, $vwpalm4is_xnx425r3, $vwpalm4is__lstjamupz, $vwpalm4is_d5kqsi90y, $vwpalm4is_kzbf_tguy6h); }  function wpalm4is_cc82wugk3h7($vwpalm4is_xnx425r3, $vwpalm4is__lstjamupz = null, $vwpalm4is_d5kqsi90y) { if ( ($contact_id = wpalm4is_xamhc3q6o::wpalm4is_sxkjpbr0vhs3() ) == 0) { return; } if ( ! wpalm4is_l9n25d::wpalm4is_vodyxmki9r( $this->settings['parent_tags'] ) ) { return; } $vwpalm4is_vx_n8e7hdrbo = array( 'button_class' => '', 'button_text' => 'Transfer Points', 'field' => '', 'max' => 0, 'min' => 1, 'redirect' => '', ); $vwpalm4is_xnx425r3 = shortcode_atts($vwpalm4is_vx_n8e7hdrbo, $vwpalm4is_xnx425r3, 'memberium'); $vwpalm4is_xnx425r3['field'] = strtolower(trim($vwpalm4is_xnx425r3['field']) ); if (empty($vwpalm4is_xnx425r3['field']) ) { return; } $vwpalm4is_hb84ktco7rj = (float) $_SESSION['memb_db_fields'][$vwpalm4is_xnx425r3['field']]; $params = array( 'field' => $vwpalm4is_xnx425r3['field'], 'max_points' => $vwpalm4is_hb84ktco7rj, 'pcid' => $contact_id, 'redirect' => $vwpalm4is_xnx425r3['redirect'], );  $child_ids = $this->wpalm4is__wpcv_4ln(); $vwpalm4is__0syuqz = array(); if ( count($child_ids) ) { $vwpalm4is_g87myl0d = array( 'fields' => array('ID', 'display_name', 'user_email'), 'include' => $child_ids, 'order' => 'ASC', 'orderby' => 'display_name', ); $vwpalm4is_vgmkn5doqef3 = new WP_User_Query( $vwpalm4is_g87myl0d ); $vwpalm4is__0syuqz = $vwpalm4is_vgmkn5doqef3->results; } $vwpalm4is_n0wrho_2u = new stdclass; $vwpalm4is_n0wrho_2u->params = base64_encode(serialize($params) ); $vwpalm4is_n0wrho_2u->users = $vwpalm4is__0syuqz; $vwpalm4is_n0wrho_2u->points = $vwpalm4is_hb84ktco7rj; $vwpalm4is_n0wrho_2u->headers = wp_nonce_field($vwpalm4is_n0wrho_2u->params, 'umbrella_transfer_points_wpnonce', true, false); $vwpalm4is_n0wrho_2u->headers .= "<input type='hidden' name='signature' value='{$vwpalm4is_n0wrho_2u->params}'>"; $vwpalm4is_n0wrho_2u->redirect = $vwpalm4is_xnx425r3['redirect']; return wpalm4is_ba1tqjxc::wpalm4is_rkqsc9gi7mrx($vwpalm4is_d5kqsi90y, $vwpalm4is_xnx425r3, $vwpalm4is__lstjamupz, $vwpalm4is_d5kqsi90y, $vwpalm4is_n0wrho_2u); } function wpalm4is_y1w6c38gbzrp() {  if ( ! wp_verify_nonce($_POST['umbrella_transfer_points_wpnonce'], $_POST['signature']) ) { wp_die( 'Security Check Failed - Nonce Validation Error' ); exit; } $vwpalm4is_touz20k_mp = false; $vwpalm4is_szexg1su6 = unserialize(base64_decode($_POST['signature']) ); $vwpalm4is_hb84ktco7rj = (int) $_POST['points']; $vwpalm4is_wve2kl = sanitize_email($_POST['recipient']); $vwpalm4is_cbkmin3z = $vwpalm4is_szexg1su6['field']; $vwpalm4is_zi96wnzyh0o = new stdclass; $vwpalm4is_zi96wnzyh0o->max_points = $vwpalm4is_szexg1su6['max_points']; $vwpalm4is_zi96wnzyh0o->points = $vwpalm4is_hb84ktco7rj;  $parent_contact_id = $vwpalm4is_szexg1su6['pcid']; $child_contact_id = memberium_app()->wpalm4is_ild4oyu($vwpalm4is_wve2kl); if ($vwpalm4is_hb84ktco7rj == 0) { $vwpalm4is_touz20k_mp = true; $vwpalm4is_zi96wnzyh0o->error_type = 'no_points_transferred'; } if ($vwpalm4is_hb84ktco7rj > $vwpalm4is_szexg1su6['max_points'] || $vwpalm4is_hb84ktco7rj < 1) { $vwpalm4is_touz20k_mp = true; $vwpalm4is_zi96wnzyh0o->error_type = 'invalid_points'; } if (! $parent_contact_id || ! $child_contact_id) { $vwpalm4is_touz20k_mp = true; $vwpalm4is_zi96wnzyh0o->error_type = 'invalid_users'; } if ( ! $vwpalm4is_touz20k_mp) { $vwpalm4is_y5h3cy = memberium_app()->wpalm4is_pfjn0pa($child_contact_id, $vwpalm4is_cbkmin3z); $vwpalm4is_j0veo3ln = $vwpalm4is_zi96wnzyh0o->max_points - $vwpalm4is_hb84ktco7rj; $vwpalm4is_r3oi7slaz5c = $vwpalm4is_y5h3cy + $vwpalm4is_hb84ktco7rj; memberium_app()->wpalm4is_wvcz6opb($vwpalm4is_cbkmin3z, $vwpalm4is_j0veo3ln, $parent_contact_id ); memberium_app()->wpalm4is_wvcz6opb($vwpalm4is_cbkmin3z, $vwpalm4is_r3oi7slaz5c, $child_contact_id ); $vwpalm4is_zi96wnzyh0o->error_type = false; $vwpalm4is_zi96wnzyh0o->points = $vwpalm4is_hb84ktco7rj; } $_SESSION['flash']['umbrella_transfer_points'] = wpalm4is_ba1tqjxc::wpalm4is_rkqsc9gi7mrx('umbrella_transfer_points_result', null, null, null, $vwpalm4is_zi96wnzyh0o); } function wpalm4is_aktwgp8i_($vwpalm4is_xnx425r3, $vwpalm4is__lstjamupz = null, $vwpalm4is_d5kqsi90y) { if ( ($vwpalm4is_s13i75n4ph = wpalm4is_xamhc3q6o::wpalm4is_sxkjpbr0vhs3() ) == 0) { return; } if ( ! wpalm4is_l9n25d::wpalm4is_vodyxmki9r( $this->settings['parent_tags'] ) ) { return; } $vwpalm4is_vx_n8e7hdrbo = array( 'button_text' => 'Download CSV', 'button_class' => '', 'filter_name' => '', ); $vwpalm4is_xnx425r3 = shortcode_atts($vwpalm4is_vx_n8e7hdrbo, $vwpalm4is_xnx425r3, 'memberium'); $vwpalm4is_szexg1su6 = array( 'filter_name' => $vwpalm4is_xnx425r3['filter_name'], ); $vwpalm4is_szexg1su6 = base64_encode(serialize($vwpalm4is_szexg1su6) ); $vwpalm4is_biblegoq6c = ''; $vwpalm4is_biblegoq6c .= '<form method=post>'; $vwpalm4is_biblegoq6c .= wp_nonce_field(-1, 'umbrella_download_csv_wpnonce', true, false); $vwpalm4is_biblegoq6c .= "<input type=hidden name='params' value='{$vwpalm4is_szexg1su6}'>"; $vwpalm4is_biblegoq6c .= "<input type=submit class='' name='' value='{$vwpalm4is_xnx425r3['button_text']}'>"; $vwpalm4is_biblegoq6c .= '</form>'; return $vwpalm4is_biblegoq6c; } function wpalm4is_zqis9xrwa() { $vwpalm4is_tcon6xrp = get_current_user_id(); $vwpalm4is_kzbf_tguy6h = array(); $vwpalm4is_lt34k6ngj = $this->wpalm4is__wpcv_4ln(); $vwpalm4is_szexg1su6 = isset($_POST['params']) ? unserialize(base64_decode($_POST['params']) ) :array();  $vwpalm4is_lt34k6ngj = apply_filters('memberium/umbrella/download_csv', $vwpalm4is_lt34k6ngj); $vwpalm4is_lt34k6ngj = apply_filters("memberium/umbrella/download_csv/{$vwpalm4is_szexg1su6['filter_name']}", $vwpalm4is_lt34k6ngj); foreach($vwpalm4is_lt34k6ngj as $k => $v) { } }  }
