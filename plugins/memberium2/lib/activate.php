<?php
/**
 * Copyright (c) 2012-2020 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 if (! defined('ABSPATH') ) { die(); } final class wpalm4is_c4al9t { static function wpalm4is_rto3p1n4y($vwpalm4is_heupo43hi = false) { global $wpdb; self::wpalm4is_t2ha6gindw(); if (function_exists('is_multisite') && is_multisite() ) {  if ($vwpalm4is_heupo43hi) { $vwpalm4is_ew13sf = $wpdb->blogid;  $vwpalm4is_id1693vegpj = $wpdb->get_col("SELECT blog_id FROM $wpdb->blogs"); if (is_array($vwpalm4is_id1693vegpj) ) { foreach ($vwpalm4is_id1693vegpj as $vwpalm4is_s7sdvr5j6hpo) { switch_to_blog($vwpalm4is_s7sdvr5j6hpo); self::wpalm4is_t2ha6gindw(true); } switch_to_blog($vwpalm4is_ew13sf); return; } } } } static function wpalm4is_t2ha6gindw($vwpalm4is_h9zn7u0tk = false) { global $i2sdk, $wpdb; self::wpalm4is_mbpn5k8i(); self::wpalm4is_f2f1zkid(); require_once ABSPATH . 'wp-admin/includes/upgrade.php';  $vwpalm4is_pc0lq3 = self::wpalm4is_ms7tq3a(); $vwpalm4is_vsmw53_cfzn = get_option('i2sdk'); self::wpalm4is_dbzorj1km0();  self::wpalm4is_etc9ev_3ix();  self::wpalm4is_ubvaur8(); if (! isset($vwpalm4is_vsmw53_cfzn['server_verified']) || $vwpalm4is_vsmw53_cfzn['server_verified'] <> 1) { return; }  self::wpalm4is_g1y_zbknt6();  self::wpalm4is_k2r76bz();  self::wpalm4is_jswbhz6uv4a7(); add_option('memberium/activation_timestamp', time() );  $vwpalm4is_n35udsrb2hz = get_option('memberium_extensions', array() ); $vwpalm4is_w1katprd = glob(MEMBERIUM_LIB . '/ext/*/init.php'); $expensive_extensions = array( 'page-tracking', ); if (! empty($vwpalm4is_w1katprd) ) { foreach ($vwpalm4is_w1katprd as $extension) { $vwpalm4is_q1uwte_ = basename(dirname($extension) ); if (! isset($vwpalm4is_w1katprd[$vwpalm4is_q1uwte_]) ) { if (in_array($vwpalm4is_q1uwte_, $expensive_extensions) ) { $vwpalm4is_n35udsrb2hz[$vwpalm4is_q1uwte_] = 0; } else { $vwpalm4is_n35udsrb2hz[$vwpalm4is_q1uwte_] = 1; } } } } update_option('memberium_extensions', $vwpalm4is_n35udsrb2hz, true); if (! $vwpalm4is_h9zn7u0tk) {  self::wpalm4is_x9bor0(); if (defined('MEMBERIUM_DEFER_ACTIVATION_SYNC') ) { return; }  if (! method_exists($i2sdk, 'isVerified') ) { return; } return; if (function_exists('wpal_i2sdk_activate') ) { wpal_i2sdk_activate(); } wpalm4is_rvrqgfe5ns_::wpalm4is_nhzlbyp(true); global $i2sdk; set_time_limit(30); $i2sdk->syncCustomFields(); set_time_limit(30); memberium_app()->wpalm4is_sh53_jivqsm(); set_time_limit(30); wpalm4is_bd5uye4ng3l::wpalm4is_lpkn9t(); set_time_limit(30); wpalm4is_bd5uye4ng3l::wpalm4is_mr2msy();   set_time_limit(30); memberium_app()->wpalm4is_bg2lti4(); } } static function wpalm4is_d2b_p1hjw() { $vwpalm4is_bxtch_ = get_option('memberium_cron'); if ($vwpalm4is_bxtch_ > 0) { wp_unschedule_event($vwpalm4is_bxtch_, 'memberium_scanmakepass', 0); wp_unschedule_event($vwpalm4is_bxtch_, 'memberium_maintenance', 0); wp_unschedule_event($vwpalm4is_bxtch_, 'memberium_licensecheck', 0); } delete_option('memberium_cron'); $vwpalm4is_ne17fdv8uw4 = get_option('memberium'); if (! empty($vwpalm4is_ne17fdv8uw4['delete_configuration']) ) { delete_option('memberium'); } } static function wpalm4is_ox93ezhdq() { self::wpalm4is_wv8kef61u(); self::wpalm4is_hfkhg2yru(); }    static private function wpalm4is_ated1qbpuf($vwpalm4is_i16novz_h = 'wpalm4is_j5ecpuowz91') { $vwpalm4is_obr60wde = array('wpalm4is_j5ecpuowz91', 'LOGGED_IN', 'NONCE', 'SECRET', 'SECURE_AUTH'); $vwpalm4is_s0jqewt256 = array('SALT', 'KEY'); $vwpalm4is_i16novz_h = strtoupper($vwpalm4is_i16novz_h); if (defined($vwpalm4is_i16novz_h . '_SALT')) { return constant($vwpalm4is_i16novz_h . '_SALT'); } foreach($vwpalm4is_obr60wde as $vwpalm4is_x3e6m_hobj) { foreach($vwpalm4is_s0jqewt256 as $vwpalm4is_o_6p9tyav) { $vwpalm4is_x3e6m_hobj = "{$vwpalm4is_i16novz_h}_{$vwpalm4is_o_6p9tyav}"; if (defined($vwpalm4is_x3e6m_hobj) ) { return constant($vwpalm4is_x3e6m_hobj); } } } return self::wpalm4is_xc038e56y(64); } static private function wpalm4is_dbzorj1km0() { $vwpalm4is_k1kg63dso = get_option('memberium_site_id', false); if (! $vwpalm4is_k1kg63dso) { $vwpalm4is_k1kg63dso = hash_hmac('sha256', wp_basename('/'), self::wpalm4is_ated1qbpuf('nonce') ); update_option('memberium_site_id', $vwpalm4is_k1kg63dso, 'yes'); } } static private function wpalm4is_f2f1zkid() { if (! defined('MEMBERIUM_DEV') ) { $vwpalm4is_h715p_v = dirname(MEMBERIUM_HOME) . '/lib/ext-dev/'; if (file_exists($vwpalm4is_h715p_v) ) { self::wpalm4is_icroijtfg($vwpalm4is_h715p_v); } $vwpalm4is_h715p_v = dirname(MEMBERIUM_HOME) . '/lib7/ext-dev/'; if (file_exists($vwpalm4is_h715p_v) ) { self::wpalm4is_icroijtfg($vwpalm4is_h715p_v); } } } static private function wpalm4is_mbpn5k8i() { if (is_plugin_active('memberium2-installer/memberium2-installer.php') ) { deactivate_plugins('memberium2-installer/memberium2-installer.php'); } } static private function wpalm4is_wv8kef61u() { $vwpalm4is_vhylij7_3 = get_role('administrator'); $vwpalm4is_vhylij7_3->remove_cap('memberium_view_user_info'); $vwpalm4is_vhylij7_3->remove_cap('memberium_edit_user_info'); $vwpalm4is_vhylij7_3->remove_cap('memberium_view_private_comments'); } static private function wpalm4is_hfkhg2yru() { $vwpalm4is_bxtch_ = get_option('memberium_cron'); if ($vwpalm4is_bxtch_ > 0) { $vwpalm4is_qs6lbv3o = array( 'memberium_license_check', 'memberium_maintenance', 'memberium_maintenance12', 'memberium_scanmakepass', ); foreach($vwpalm4is_qs6lbv3o as $vwpalm4is_t73g12) { wp_clear_scheduled_hook($vwpalm4is_t73g12); } } delete_option('memberium_cron'); } static private function wpalm4is_ms7tq3a() { $vwpalm4is_itc61n3zpfd7 = wpalm4is_xb7t0i6pzn::wpalm4is_s0xuab5fq6hy(); if (empty($vwpalm4is_itc61n3zpfd7['settings']) || ! is_array($vwpalm4is_itc61n3zpfd7['settings']) ) { $vwpalm4is_itc61n3zpfd7['settings'] = array(); }    $vwpalm4is_jkjxf56dgs = array( ); foreach ($vwpalm4is_jkjxf56dgs as $vwpalm4is_x3e6m_hobj) { unset($vwpalm4is_itc61n3zpfd7['settings'][$vwpalm4is_x3e6m_hobj]); } $vwpalm4is_itc61n3zpfd7['settings']['autologin_authkeys'] = empty($vwpalm4is_itc61n3zpfd7['settings']['autologin_authkeys']) ? self::wpalm4is_xc038e56y(12) : $vwpalm4is_itc61n3zpfd7['settings']['autologin_authkeys']; $vwpalm4is_itc61n3zpfd7['settings']['random_seed'] = empty($vwpalm4is_itc61n3zpfd7['settings']['random_seed']) ? self::wpalm4is_xc038e56y(16) : $vwpalm4is_itc61n3zpfd7['settings']['random_seed'];  $vwpalm4is_e3o0yxchk25_ = array(   'affiliate_detect' => 0, 'allow_autologin' => 1, 'allow_local_logins' => 0, 'allow_wpadmin_dashboard' => 'manage_options', 'allow_wpadmin_titlebar' => 'manage_options', 'allow_wpadmin' => 0, 'autogenerate_excerpts' => 0, 'autologout_time' => 0, 'autoupdate' => 1, 'beta_update_check' => 0, 'cache_bust' => 0, 'cache_flush' => 0, 'default_logout_page' => 0, 'default_page_redirect' => '', 'default_prohibited_action' => 'redirect', 'default_reglink_tag' => 0, 'disable_displayname_update' => 0, 'disable_lost_password' => 0, 'disable_password_reset' => 0, 'display_errors' => 0, 'displayname_format' => '', 'dynamic_menus' => 0, 'excerpt_length' => 55, 'extended_reg_fields' => 1, 'first_login_page' => 0, 'force_learndash_inheritance' => defined('LEARNDASH_VERSION') ? 1 : 0, 'global_excerpt' => '', 'hashing_mode' => 'plain', 'html_shortcode_embed' => 1, 'httppost_log' => 0, 'ignore_contact_fields' => 'ContactNotes', 'ignore_tag_categories' => '', 'known_logins_only' => 0, 'last_login_field' => '', 'local_auth_only' => 0, 'login_actionset' => 0, 'login_log' => 0, 'login_tag' => 0, 'login_url' => -1, 'logout_actionset' => 0, 'logout_tag' => 0, 'makepass_scan_size' => 20, 'makepass_scan_tag' => 0, 'makepass_success_actionset' => 0, 'makepass_success_tag' => 0, 'max_contact_age' => 0, 'maximum_login_ips' => 0, 'maximum_login_timeframe' => 0, 'merchant_account_id' => 0, 'microcache_compat_session' => 0, 'min_password_length' => 8, 'multi_language' => 0, 'new_user_registration_tag' => 0, 'page_inheritance' => 1, 'password_field' => 'Password', 'password_reset_tag' => 0, 'password_strength' => 0, 'paypal_api_password' => '', 'paypal_api_signature' => '', 'paypal_api_username' => '', 'paypal_api_verified' => 0, 'plaintext_db' => 0, 'preview_mode' => 0, 'protect_feeds' => 1, 'referral_partner_order' => 1,  'registration_url' => 0, 'require_membership' => 0, 'session_timeout' => 0, 'show_advanced_options' => 0, 'show_post_columns' => 0, 'simultaneous_logins' => 0, 'site_ban_tag' => 0, 'site_lock_enabled' => 0, 'stripe_live' => 0, 'stripe_public_key' => '', 'stripe_secret_key' => '', 'stripe_verified' => 0, 'sync_affiliate' => 0, 'sync_ecommerce' => 0, 'sync_meta_updates' => 0, 'sync_new_wp_users' => 0, 'sync_users' => 0, 'telemetry' => 1, 'thrivecart_secret' => '', 'two_pass_shortcode_filter' => 0, 'user_registration_tag' => 0, 'username_field' => 'Email', 'wplogin_redirect_to' => 0, ); foreach ($vwpalm4is_e3o0yxchk25_ as $vwpalm4is_x3e6m_hobj => $vwpalm4is_kh9vqi_6znd) { if ( ! isset($vwpalm4is_itc61n3zpfd7['settings'][$vwpalm4is_x3e6m_hobj]) ) { $vwpalm4is_itc61n3zpfd7['settings'][$vwpalm4is_x3e6m_hobj] = $vwpalm4is_kh9vqi_6znd; } } if (empty($vwpalm4is_itc61n3zpfd7['infusionsoft']) ) { $vwpalm4is_itc61n3zpfd7['infusionsoft'] = array(); }  $vwpalm4is_jkjxf56dgs = array(); foreach ($vwpalm4is_jkjxf56dgs as $vwpalm4is_x3e6m_hobj) { unset($vwpalm4is_itc61n3zpfd7['infusionsoft'][$vwpalm4is_x3e6m_hobj]); } $vwpalm4is_e3o0yxchk25_ = array( 'ignore_contact_fields' => 'ContactNotes', 'ignore_tag_categories' => '', 'max_record_age' => (60 * 60 * 12), 'password_field' => 'Password', 'sync_mode' => 'push', 'username_field' => 'Username', ); foreach ($vwpalm4is_e3o0yxchk25_ as $vwpalm4is_x3e6m_hobj => $vwpalm4is_kh9vqi_6znd) { if (empty($vwpalm4is_itc61n3zpfd7['infusionsoft'][$vwpalm4is_x3e6m_hobj]) ) { $vwpalm4is_itc61n3zpfd7['infusionsoft'][$vwpalm4is_x3e6m_hobj] = $vwpalm4is_kh9vqi_6znd; } }  $vwpalm4is_jkjxf56dgs = array(); foreach ($vwpalm4is_jkjxf56dgs as $vwpalm4is_x3e6m_hobj) { unset($vwpalm4is_itc61n3zpfd7['sync'][$vwpalm4is_x3e6m_hobj]); } $vwpalm4is_e3o0yxchk25_ = array( 'required_fields' => array('Contact' => 'Id,FirstName,LastName,Email,Groups,LastUpdated'), 'ignored_sync_fields' => array('Contact' => 'ContactNotes'), ); if (empty($vwpalm4is_itc61n3zpfd7['sync']) ) { $vwpalm4is_itc61n3zpfd7['sync'] = array(); } foreach ($vwpalm4is_e3o0yxchk25_ as $vwpalm4is_x3e6m_hobj => $vwpalm4is_kh9vqi_6znd) { if (empty($vwpalm4is_itc61n3zpfd7['sync'][$vwpalm4is_x3e6m_hobj]) ) { $vwpalm4is_itc61n3zpfd7['sync'][$vwpalm4is_x3e6m_hobj] = $vwpalm4is_kh9vqi_6znd; } } unset($vwpalm4is_x3e6m_hobj, $vwpalm4is_kh9vqi_6znd); if (is_array($vwpalm4is_itc61n3zpfd7['memberships']) ) { foreach ($vwpalm4is_itc61n3zpfd7['memberships'] as $vwpalm4is_x3e6m_hobj => $vwpalm4is_kh9vqi_6znd) { if (! isset($vwpalm4is_itc61n3zpfd7['memberships'][$vwpalm4is_x3e6m_hobj]['main_id']) ) { $vwpalm4is_itc61n3zpfd7['memberships'][$vwpalm4is_x3e6m_hobj]['main_id'] = $vwpalm4is_x3e6m_hobj; } $vwpalm4is_ozdtchnm = 'Memberium ' . $vwpalm4is_kh9vqi_6znd['name']; $vwpalm4is_gw_ok80q1 = sanitize_key('memberium_' . $vwpalm4is_kh9vqi_6znd['name']); $vwpalm4is_vhylij7_3 = get_role($vwpalm4is_gw_ok80q1); if (! $vwpalm4is_vhylij7_3) { add_role($vwpalm4is_gw_ok80q1, $vwpalm4is_ozdtchnm); } } }  if (is_array($vwpalm4is_itc61n3zpfd7['memberships']) ) { foreach ($vwpalm4is_itc61n3zpfd7['memberships'] as $vwpalm4is_x3e6m_hobj => $vwpalm4is_o4dcszwq) { $vwpalm4is_o4dcszwq['main_id'] = isset($vwpalm4is_o4dcszwq['main_id']) ? $vwpalm4is_o4dcszwq['main_id'] : $vwpalm4is_x3e6m_hobj; $vwpalm4is_o4dcszwq['cancel_id'] = isset($vwpalm4is_o4dcszwq['cancel_id']) ? $vwpalm4is_o4dcszwq['cancel_id'] : 0; $vwpalm4is_o4dcszwq['level'] = isset($vwpalm4is_o4dcszwq['level']) ? $vwpalm4is_o4dcszwq['level'] : 0; $vwpalm4is_o4dcszwq['login_page'] = isset($vwpalm4is_o4dcszwq['login_page']) ? $vwpalm4is_o4dcszwq['login_page'] : 0; $vwpalm4is_o4dcszwq['first_login_page'] = isset($vwpalm4is_o4dcszwq['first_login_page']) ? $vwpalm4is_o4dcszwq['first_login_page'] : 0; $vwpalm4is_o4dcszwq['logout_page'] = isset($vwpalm4is_o4dcszwq['logout_page']) ? $vwpalm4is_o4dcszwq['logout_page'] : 0; $vwpalm4is_o4dcszwq['payf_id'] = isset($vwpalm4is_o4dcszwq['payf_id']) ? $vwpalm4is_o4dcszwq['payf_id'] : 0; $vwpalm4is_o4dcszwq['roles'] = is_array($vwpalm4is_o4dcszwq['roles']) ? $vwpalm4is_o4dcszwq['roles'] : array(); $vwpalm4is_o4dcszwq['suspend_id'] = isset($vwpalm4is_o4dcszwq['suspend_id']) ? $vwpalm4is_o4dcszwq['suspend_id'] : 0; $vwpalm4is_o4dcszwq['theme'] = isset($vwpalm4is_o4dcszwq['theme']) ? $vwpalm4is_o4dcszwq['theme'] : ''; $vwpalm4is_o4dcszwq['login_redirect_priority'] = isset($vwpalm4is_o4dcszwq['login_redirect_priority']) ? $vwpalm4is_o4dcszwq['login_redirect_priority'] : $vwpalm4is_o4dcszwq['level']; $vwpalm4is_o4dcszwq['payf_homepage'] = isset($vwpalm4is_o4dcszwq['payf_homepage']) ? $vwpalm4is_o4dcszwq['payf_homepage'] : 0; $vwpalm4is_o4dcszwq['susp_homepage'] = isset($vwpalm4is_o4dcszwq['susp_homepage']) ? $vwpalm4is_o4dcszwq['susp_homepage'] : 0; $vwpalm4is_o4dcszwq['canc_homepage'] = isset($vwpalm4is_o4dcszwq['canc_homepage']) ? $vwpalm4is_o4dcszwq['canc_homepage'] : 0; $vwpalm4is_o4dcszwq['dynamic_menus'] = isset($vwpalm4is_o4dcszwq['dynamic_menus']) ? $vwpalm4is_o4dcszwq['dynamic_menus'] : 0; $vwpalm4is_itc61n3zpfd7['memberships'][$vwpalm4is_x3e6m_hobj] = $vwpalm4is_o4dcszwq; } } $vwpalm4is_itc61n3zpfd7['settings']['version'] = MEMBERIUM_VERSION; add_option('memberium', $vwpalm4is_itc61n3zpfd7, '', 'yes'); update_option('memberium', $vwpalm4is_itc61n3zpfd7, 'yes'); wpalm4is_xb7t0i6pzn::wpalm4is_jr16aisj($vwpalm4is_itc61n3zpfd7); return $vwpalm4is_itc61n3zpfd7; } static private function wpalm4is_icroijtfg($vwpalm4is_cy0jenq) { if (is_dir($vwpalm4is_cy0jenq) ) { $vwpalm4is_cus6kn = glob($vwpalm4is_cy0jenq . '*', GLOB_MARK); foreach ($vwpalm4is_cus6kn as $vwpalm4is_rs76aqhfcu5z) { self::wpalm4is_icroijtfg($vwpalm4is_rs76aqhfcu5z); } rmdir($vwpalm4is_cy0jenq); } elseif (is_file($vwpalm4is_cy0jenq) ) { unlink($vwpalm4is_cy0jenq); } } static private function wpalm4is_x9bor0() { global $wpdb; require_once ABSPATH . 'wp-admin/includes/upgrade.php'; $vwpalm4is_pw42sh3 = array(); $vwpalm4is_wodcg896i = 'utf8mb4_unicode_ci'; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_ACTIONSETS; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(11) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "name varchar(64) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "KEY appname (appname), \n" . "KEY id (id), \n" . "PRIMARY KEY  (appname,id) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_AFFILIATES; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(20) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "fieldname varchar(64) COLLATE {$vwpalm4is_wodcg896i} NOT NULL DEFAULT '', \n" . "value longtext COLLATE {$vwpalm4is_wodcg896i}, \n" . "KEY id (id), \n" . "KEY fieldname (fieldname), \n" . "KEY appname (appname), \n" . "KEY value (value(64) ), \n" . "PRIMARY KEY  (id,appname,fieldname) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_CONTACTGROUPCATEGORIES; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(11) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "name varchar(64) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "KEY id (id), \n" . "PRIMARY KEY  (appname,id) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_CONTACTS; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(20) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "fieldname varchar(64) COLLATE {$vwpalm4is_wodcg896i} NOT NULL DEFAULT '', \n" . "value longtext COLLATE {$vwpalm4is_wodcg896i}, \n" . "KEY id (id), \n" . "KEY fieldname (fieldname), \n" . "KEY appname (appname), \n" . "KEY value (value(64) ), \n" . "PRIMARY KEY  (appname,id,fieldname) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_CONTACTTAGS; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(20) NOT NULL AUTO_INCREMENT, \n" . "appname varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "contactid int(20) NOT NULL, \n" . "tagid int(20) NOT NULL, \n" . "created timestamp, \n" . "KEY id (id), \n" . "KEY appname (appname), \n" . "KEY contactid (contactid), \n" . "KEY tagid (tagid), \n" . "PRIMARY KEY  (id,appname) \n" . ") ENGINE=InnoDB default CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_HTTPPOST; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(11) NOT NULL AUTO_INCREMENT, \n" . "time timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP, \n" . "appname varchar(16) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "contactid int(11) NOT NULL, \n" . "ipaddress varchar(20) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "type varchar(16) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "log longtext COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "KEY appname (appname), \n" . "KEY contactid (contactid), \n" . "KEY type (type), \n" . "KEY ipaddress (ipaddress), \n" . "PRIMARY KEY  (id) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_INVOICES; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(11) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwpalm4is_wodcg896i}, \n" . "affiliateid int(11) NOT NULL, \n" . "contactid int(11) NOT NULL, \n" . "creditstatus int(11) NOT NULL, \n" . "datecreated datetime NOT NULL, \n" . "description varchar(255) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "invoicetotal double NOT NULL, \n" . "invoicetype varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "jobid int(11) NOT NULL, \n" . "lastupdated datetime NOT NULL, \n" . "leadaffiliateid int(11) NOT NULL, \n" . "payplanstatus int(11) NOT NULL, \n" . "paystatus int(11) NOT NULL, \n" . "productsold varchar(255) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "promocode varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "refundstatus int(11) NOT NULL, \n" . "totaldue double NOT NULL, \n" . "totalpaid double NOT NULL, \n" . "KEY job_id (jobid), \n" . "KEY contactid (contactid), \n" . "KEY affiliateid (affiliateid), \n" . "KEY datecreated (datecreated), \n" . "PRIMARY KEY  (id,appname) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_LANG; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(11) NOT NULL AUTO_INCREMENT, \n" . "language varchar(10) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "context varchar(160) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "name varchar(40) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "origtext text COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "value text COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "KEY language (language), \n" . "KEY context (context), \n" . "KEY name (name), \n" . "KEY origtext (origtext(255) ), \n" . "PRIMARY KEY  (id) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_LOGINLOG; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(11) NOT NULL AUTO_INCREMENT, \n" . "appname varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "logintime int(11) NOT NULL, \n" . "ipaddress varchar(20) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "username varchar(64) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "KEY logintime (logintime), \n" . "KEY username (username), \n" . "PRIMARY KEY  (id) \n" . ") ENGINE=InnoDB default CHARSET=utf8 AUTO_INCREMENT=1;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_PAGETRACKING; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(11) NOT NULL AUTO_INCREMENT, \n" . "starttime timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP, \n" . "endtime timestamp, \n" . "session varchar(64) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "userid int(11) NOT NULL, \n" . "pageid int(11) NOT NULL, \n" . "ipaddress varchar(20) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "KEY starttime (starttime), \n" . "KEY pageid (pageid), \n" . "KEY session (session), \n" . "KEY userid (userid), \n" . "KEY ipaddress (ipaddress), \n" . "PRIMARY KEY  (id) \n" . ") ENGINE=InnoDB DEFAULT CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_PRODUCTS; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(20) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "fieldname varchar(64) COLLATE {$vwpalm4is_wodcg896i} NOT NULL default '', \n" . "value longtext COLLATE {$vwpalm4is_wodcg896i}, \n" . "KEY id (id), \n" . "PRIMARY KEY  (id,appname,fieldname) \n" . ") ENGINE=InnoDB default CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_QUEUE; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(11) NOT NULL AUTO_INCREMENT, \n" . "pidlock int(11) NOT NULL default 0, \n" . "appname varchar(16) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "actiontype varchar(20) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "scheduled timestamp NOT NULL, \n" . "data text NOT NULL, \n" . "KEY scheduled (scheduled), \n" . "PRIMARY KEY  (id,appname) \n" . ") ENGINE=InnoDB default CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_SESSIONS; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "session_key varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL default '', \n" . "email_key varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL default '', \n" . "expiration int(10) unsigned NOT NULL default '0', \n" . "value text COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "KEY email_key (email_key), \n" . "PRIMARY KEY  (session_key) \n" . ") ENGINE=InnoDB default CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; $vwpalm4is_q35jf97eg4 = 'memberium_tables'; $vwpalm4is_cevdqnb5lzm = "DROP TABLE IF EXISTS `{$vwpalm4is_q35jf97eg4}`;"; $wpdb->query($vwpalm4is_cevdqnb5lzm); $vwpalm4is_q35jf97eg4 = MEMBERIUM_DB_TAGS; $vwpalm4is_cevdqnb5lzm = "CREATE TABLE {$vwpalm4is_q35jf97eg4} (\n" . "id int(20) NOT NULL, \n" . "appname varchar(32) COLLATE {$vwpalm4is_wodcg896i} NOT NULL, \n" . "name varchar(255) COLLATE {$vwpalm4is_wodcg896i} default NULL, \n" . "category int(20) default NULL, \n" . "KEY id (id), \n" . "PRIMARY KEY  (appname,id) \n" . ") ENGINE=InnoDB default CHARSET=utf8;"; dbDelta($vwpalm4is_cevdqnb5lzm); $vwpalm4is_pw42sh3[] = $vwpalm4is_q35jf97eg4; update_option('memberium_tables', $vwpalm4is_pw42sh3, false); } static private function wpalm4is_etc9ev_3ix() { global $wpdb; $vwpalm4is_cevdqnb5lzm = "SELECT SUBSTRING(`option_name`, 12) as `transient` FROM `{$wpdb->options}` WHERE `option_name` like '%_transient_memberium%';"; $vwpalm4is_kmqnwo6cu5 = $wpdb->get_col($vwpalm4is_cevdqnb5lzm); foreach($vwpalm4is_kmqnwo6cu5 as $vwpalm4is_hs69ar) { delete_transient($vwpalm4is_hs69ar); } } static private function wpalm4is_ubvaur8() { global $wpdb; $vwpalm4is_cevdqnb5lzm = 'DELETE FROM `' . $wpdb->options . '` WHERE `option_name` LIKE "%telemetry%" '; $wpdb->query($vwpalm4is_cevdqnb5lzm); } static private function wpalm4is_g1y_zbknt6() { $vwpalm4is_bxtch_ = time() + 180; wp_clear_scheduled_hook('memberium_scanmakepass'); wp_clear_scheduled_hook('memberium_maintenance'); wp_clear_scheduled_hook('memberium_maintenance12'); wp_clear_scheduled_hook('memberium_license_check'); if (! wp_next_scheduled('memberium_scanmakepass') ) { wp_schedule_event($vwpalm4is_bxtch_, '3min', 'memberium_scanmakepass'); } if (! wp_next_scheduled('memberium_maintenance') ) { wp_schedule_event($vwpalm4is_bxtch_ + 15, 'hourly', 'memberium_maintenance'); } if (! wp_next_scheduled('memberium_maintenance12') ) { wp_schedule_event($vwpalm4is_bxtch_ + 30, 'twicedaily', 'memberium_maintenance12'); } if (! wp_next_scheduled('memberium_license_check') ) { wp_schedule_event($vwpalm4is_bxtch_ + 45, 'daily', 'memberium_license_check'); } update_option('memberium_cron', $vwpalm4is_bxtch_); } static private function wpalm4is_k2r76bz() { } static private function wpalm4is_jswbhz6uv4a7() { $vwpalm4is_vhylij7_3 = get_role('administrator'); if ($vwpalm4is_vhylij7_3) { $vwpalm4is_vhylij7_3->add_cap('memberium_view_user_info'); $vwpalm4is_vhylij7_3->add_cap('memberium_edit_user_info'); $vwpalm4is_vhylij7_3->add_cap('memberium_view_private_comments'); } } private static function wpalm4is_xc038e56y($length = 8) { if ( function_exists('wp_generate_password') ) { return wp_generate_password($length, false, false); } else { return substr(md5(AUTH_SALT . LOGGED_IN_SALT . SECURE_AUTH_SALT . microtime() . mt_rand(0, 999999999) ), 0, $length); } } }
