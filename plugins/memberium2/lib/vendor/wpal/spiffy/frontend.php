<?php
/**
 * Copyright (c) 2020 David J Bullock
 * Web Power and Light, LLC
 * https://webpowerandlight.com
 * support@webpowerandlight.com
 *
 */

 if (! defined('ABSPATH') ) { die(); } final class wpalm4is_z_0rp9xi { private function wpalm4is_srmgvnxzdawe() { add_action('wpalm4is_feu7co', array($this, 'wpalm4is_gro7cwkl2'), 10, 0); add_action('memberium_remove_shortcodes', array($this, 'wpalm4is_g518pm'), 10, 0); if (! empty($_POST['memb_form_type']) ) { add_action('template_redirect', array($this, 'wpalm4is_ywpomt'), 1); } } private function wpalm4is_o3kfhsrqj94b() { $vwpalm4is_kznk57u36q['standard'] = array( 'memb_spiffy_login' => 'wpalm4is_w0ovsm86_pcq', ); return $vwpalm4is_kznk57u36q; } function wpalm4is_ywpomt() { $vwpalm4is_ze54f6jvopnr = strtolower($_POST['memb_form_type']); $vwpalm4is_vebc_h = array( 'memberium/spiffy_login_button' => 'wpalm4is_o8a5qehfys', ); if (array_key_exists($vwpalm4is_ze54f6jvopnr, $vwpalm4is_vebc_h)) { $vwpalm4is_fgo2p1h = $vwpalm4is_vebc_h[$vwpalm4is_ze54f6jvopnr]; $this->$vwpalm4is_fgo2p1h(); } } function wpalm4is_gro7cwkl2() { $vwpalm4is_gf2m1t7v8nbz = $this->wpalm4is_o3kfhsrqj94b();  if (isset($vwpalm4is_gf2m1t7v8nbz['standard']) && is_array($vwpalm4is_gf2m1t7v8nbz['standard']) ) { foreach($vwpalm4is_gf2m1t7v8nbz['standard'] as $vwpalm4is_agvwtn => $vwpalm4is_kbo2k6l_m3) { add_shortcode($vwpalm4is_agvwtn, array($this, $vwpalm4is_kbo2k6l_m3) ); } } } function wpalm4is_g518pm() { $vwpalm4is_gf2m1t7v8nbz = $this->wpalm4is_o3kfhsrqj94b(); if (isset($vwpalm4is_gf2m1t7v8nbz['standard']) && is_array($vwpalm4is_gf2m1t7v8nbz['standard']) ) { foreach($vwpalm4is_gf2m1t7v8nbz['standard'] as $vwpalm4is_agvwtn => $vwpalm4is_kbo2k6l_m3) { remove_shortcode($vwpalm4is_agvwtn); } } } function wpalm4is_w0ovsm86_pcq($vwpalm4is_xnx425r3, $vwpalm4is__lstjamupz = NULL, $vwpalm4is_d5kqsi90y = '') { if (! wpalm4is_rvrqgfe5ns_::wpalm4is_ot80ov2b() ) { return; } if (! is_user_logged_in() ) { return; } if (! wpalm4is_rvrqgfe5ns_::wpalm4is_ot80ov2b() ) { return; } $vwpalm4is_thjdtmzsl7e = wpalm4is_xb7t0i6pzn::wpalm4is_s0xuab5fq6hy('settings', 'spiffy_subdomain'); if (empty($vwpalm4is_thjdtmzsl7e) && is_super_admin() ) { return "<strong style='color:red;'>Admin Notice:  The [{$vwpalm4is_d5kqsi90y}] shortcode has been disabled due to missing configuration.</strong>"; } $vwpalm4is_vx_n8e7hdrbo = array( 'button_text' => 'Get Spiffy Login', 'button_url' => '', 'css_button_class' => 'memb_spiffy_login_button', 'css_button_id' => 'memb_spiffy_login_button', 'css_button_name' => 'memb_spiffy_login_button', 'css_button_style' => '', 'css_class' => 'memb_spiffy_login_form', 'css_id' => 'memb_spiffy_login_form', 'css_message_class' => 'memb_spiffy_login_message', 'css_message_id' => 'memb_spiffy_login_message', 'css_message_style' => '', 'css_name' => 'memb_spiffy_login_form', 'css_style' => '', 'message' => 'Please check your email for your Spiffy login link.', 'email' => empty($_SESSION['memb_db_fields']['email']) ? wp_get_current_user()->user_email : $_SESSION['memb_db_fields']['email'], 'style' => '', ); $vwpalm4is_xnx425r3 = shortcode_atts($vwpalm4is_vx_n8e7hdrbo, $vwpalm4is_xnx425r3, 'memberium'); $vwpalm4is_xavx4e9gd2fr = array( 'email' => $vwpalm4is_xnx425r3['email'], 'message' => $vwpalm4is_xnx425r3['message'], ); $vwpalm4is_xavx4e9gd2fr = base64_encode(serialize($vwpalm4is_xavx4e9gd2fr) ); $vwpalm4is_o5_we2b = memberium_app()->wpalm4is_k0vfdx($vwpalm4is_xavx4e9gd2fr); $vwpalm4is_hjm_46rgqxn = wp_nonce_field('memb_spiffy_login_' . $vwpalm4is_xnx425r3['css_id'], '_wpnonce', true, false); $vwpalm4is_jldbwy4r = ''; $vwpalm4is_pl2e5v7_ = wpalm4is_xb7t0i6pzn::wpalm4is_fv6n32('memb_spiffy_login'); if (! empty($vwpalm4is_pl2e5v7_)) { $vwpalm4is_jldbwy4r .= "<div id='{$vwpalm4is_xnx425r3['css_message_id']}' class='{$vwpalm4is_xnx425r3['css_message_class']}' style='{$vwpalm4is_xnx425r3['css_message_style']}'>{$vwpalm4is_pl2e5v7_}</div>"; } else { $vwpalm4is_jldbwy4r .= "<form name='{$vwpalm4is_xnx425r3['css_name']}' id='{$vwpalm4is_xnx425r3['css_id']}' method='post' action=''>"; $vwpalm4is_jldbwy4r .= "<input type='hidden' name='memb_form_type' value='memberium/spiffy_login_button'>"; $vwpalm4is_jldbwy4r .= "<input type='hidden' name='form_id' value='{$vwpalm4is_xnx425r3['css_id']}'>"; $vwpalm4is_jldbwy4r .= "<input type='hidden' name='parameters' value='{$vwpalm4is_xavx4e9gd2fr}'>"; $vwpalm4is_jldbwy4r .= "<input type='hidden' name='signature' value='{$vwpalm4is_o5_we2b}'>"; $vwpalm4is_jldbwy4r .= $vwpalm4is_hjm_46rgqxn; if (empty($vwpalm4is_xnx425r3['button_url']) ) { $vwpalm4is_jldbwy4r .= "<input type='submit' style='{$vwpalm4is_xnx425r3['css_button_style']}' id='{$vwpalm4is_xnx425r3['css_button_id']}' value='{$vwpalm4is_xnx425r3['button_text']}'>"; } else { $vwpalm4is_jldbwy4r .= "<input type='image' src='{$button_url}' class='{$css_class}' id='{$vwpalm4is_og8zvm9ru}' >"; } $vwpalm4is_jldbwy4r .= "</form>"; } return $vwpalm4is_jldbwy4r; }    function wpalm4is_o8a5qehfys() { if (! wpalm4is_rvrqgfe5ns_::wpalm4is_c8me3ltrxcn4() ) { return; } if (! wp_verify_nonce($_POST['_wpnonce'], "memb_spiffy_login_{$_POST['form_id']}") ) { wp_die(_x('Security Check Failed - Nonce Validation Error', 'wpalm4is_w0ovsm86_pcq', 'memberium') ); exit; } if (! memberium_app()->wpalm4is_khubmk9j72i3($_POST['signature'], $_POST['parameters']) ) { wp_die(_x('Security Check Failed - Signature Validation Error', 'wpalm4is_w0ovsm86_pcq', 'memberium') ); exit; } $vwpalm4is_x9_vubwacm = wpalm4is_xb7t0i6pzn::wpalm4is_s0xuab5fq6hy('settings', 'spiffy_subdomain'); $vwpalm4is_xavx4e9gd2fr = unserialize(base64_decode($_POST['parameters']));  $vwpalm4is_sf9tqcp3 = 'https://api.spiffy.co/customer-portal/auth'; $vwpalm4is_g87myl0d = array( 'headers' => array( 'x-subdomain' => $vwpalm4is_x9_vubwacm, ), 'body' => array( 'email' => $vwpalm4is_xavx4e9gd2fr['email'], ), 'sslverify' => false, ); $vwpalm4is_ukra4p = wp_remote_post($vwpalm4is_sf9tqcp3, $vwpalm4is_g87myl0d); wpalm4is_xb7t0i6pzn::wpalm4is_u2bhlsidn7('memb_spiffy_login', $vwpalm4is_xavx4e9gd2fr['message'] ); } function __construct() { $this->wpalm4is_srmgvnxzdawe(); } }
