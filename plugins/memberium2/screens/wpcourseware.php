<?php
 if (!defined('ABSPATH') ) { die(); } if (! current_user_can('manage_options') ) { wp_die(__('You do not have sufficient permissions to access this page.') ); } global $i2sdk, $wpdb, $wpcwdb; $vwpalm4is_abzu71e3m5a = get_option('memberium_wpcw', array() ); if ($_SERVER['REQUEST_METHOD'] == 'POST') { if ($_POST['type'] == 'courses') { $vwpalm4is_abzu71e3m5a['courses']['access_tags'] = $_POST['access_tags']; $vwpalm4is_abzu71e3m5a['courses']['completion_tag'] = $_POST['completion_tag']; } elseif ($_POST['type'] == 'modules') { $vwpalm4is_abzu71e3m5a['modules']['completion_tag'] = $_POST['completion_tag']; } update_option('memberium_wpcw', $vwpalm4is_abzu71e3m5a); } $vwpalm4is_cevdqnb5lzm = "SELECT `course_id`, `course_title`, `course_desc`, `course_opt_user_access` FROM `{$wpcwdb->courses}` WHERE '1' ORDER BY `course_opt_user_access` ASC, `course_id` DESC;"; $vwpalm4is_pn2ze3wx7s5l = $wpdb->get_results($vwpalm4is_cevdqnb5lzm, ARRAY_A); if (count($vwpalm4is_pn2ze3wx7s5l) ) { echo '<h2>WP Courseware Courses</h2>'; echo '<form method="post" action="">'; echo '<input type="hidden" name="type" value="courses">'; echo '<table class="widefat" style="white-space:nowrap;">'; echo '<tr>'; echo '<td>Title</td>'; echo '<td>Mode</td>'; echo '<td>Access Tag</td>'; echo '<td>Completion Tag</td>'; echo '</tr>'; foreach($vwpalm4is_pn2ze3wx7s5l as $vwpalm4is_ikcmtds4qzr6) { $vwpalm4is_aj6y3fmptcqz = (bool) ($vwpalm4is_ikcmtds4qzr6['course_opt_user_access'] == 'default_hide'); $vwpalm4is_cpdr_ohmnk = isset($vwpalm4is_abzu71e3m5a['courses']['access_tags'][$vwpalm4is_ikcmtds4qzr6['course_id']]) ? $vwpalm4is_abzu71e3m5a['courses']['access_tags'][$vwpalm4is_ikcmtds4qzr6['course_id']] : ''; $vwpalm4is_p3zx6t01l = isset($vwpalm4is_abzu71e3m5a['courses']['completion_tag'][$vwpalm4is_ikcmtds4qzr6['course_id']]) ? $vwpalm4is_abzu71e3m5a['courses']['completion_tag'][$vwpalm4is_ikcmtds4qzr6['course_id']] : ''; echo '<tr>'; echo '<td><strong>', $vwpalm4is_ikcmtds4qzr6['course_title'], '</strong><br>', $vwpalm4is_ikcmtds4qzr6['course_desc'], '</td>'; echo '<td>', $vwpalm4is_aj6y3fmptcqz ? '<strong style="color:red;">Protected</strong>' : '<strong style="color:green;">Public</strong>', '</td>'; if ($vwpalm4is_aj6y3fmptcqz) { echo '<td><input style="width:300px;" type="text" class="multitaglist" value="', $vwpalm4is_cpdr_ohmnk, '" name="access_tags[', $vwpalm4is_ikcmtds4qzr6['course_id'], ']"></td>'; } else { echo '<td><em>Automatic</em>'; echo '<input type="hidden" value="0" name="access_tags[', $vwpalm4is_ikcmtds4qzr6['course_id'], ']"></td>'; } echo '<td><input type="text" style="width:300px;" class="multitaglist" value="', $vwpalm4is_p3zx6t01l, '" name="completion_tag[', $vwpalm4is_ikcmtds4qzr6['course_id'], ']"></td>'; echo '</tr>'; } unset($vwpalm4is_ikcmtds4qzr6, $vwpalm4is_aj6y3fmptcqz, $vwpalm4is_cpdr_ohmnk, $vwpalm4is_p3zx6t01l, $vwpalm4is_pn2ze3wx7s5l); echo '</table>'; echo '<p><input type="submit" class="button-primary"value="Update" /></p>'; echo '</form>'; $vwpalm4is_cevdqnb5lzm = "SELECT * FROM {$wpcwdb->modules} WHERE 1 ORDER BY parent_course_id ASC, module_order ASC;"; $vwpalm4is_zp18lt = $wpdb->get_results($vwpalm4is_cevdqnb5lzm, ARRAY_A); if (count($vwpalm4is_zp18lt) ) { echo '<h2>WP Courseware Modules</h2>'; echo '<form method="post" action="">'; echo '<input type="hidden" name="type" value="modules">'; echo '<table class="widefat" style="white-space:nowrap;">'; echo '<tr>'; echo '<td>Title</td>'; echo '<td>Completion Tag</td>'; echo '</tr>'; foreach($vwpalm4is_zp18lt as $vwpalm4is_mc_5ftp39k) { $vwpalm4is_p3zx6t01l = isset($vwpalm4is_abzu71e3m5a['modules']['completion_tag'][$vwpalm4is_mc_5ftp39k['module_id']]) ? $vwpalm4is_abzu71e3m5a['modules']['completion_tag'][$vwpalm4is_mc_5ftp39k['module_id']] : ''; echo '<tr>'; echo '<td><strong>', $vwpalm4is_mc_5ftp39k['module_title'], '</strong><br>', $vwpalm4is_mc_5ftp39k['module_desc'], '</td>'; echo '<td><input type="text" style="width:300px;" class="multitaglist" value="', $vwpalm4is_p3zx6t01l, '" name="completion_tag[', $vwpalm4is_mc_5ftp39k['module_id'], ']"></td>'; echo '</tr>'; } unset($vwpalm4is_mc_5ftp39k, $vwpalm4is_p3zx6t01l, $vwpalm4is_zp18lt); echo '</table>'; echo '<p><input type="submit" class="button-primary"value="Update" /></p>'; echo '</form>'; } else { echo '<p>No modules found.</p>'; } } else { echo '<p>No courses found.</p>'; } $vwpalm4is_gf2m1t7v8nbz = wpalm4is_l9n25d::wpalm4is_d35w2jzaf(true); $vwpalm4is_gf2m1t7v8nbz = $vwpalm4is_gf2m1t7v8nbz['mc']; $vwpalm4is_xwlqeir = array(); $vwpalm4is_xwlqeir[] = array('id' => 0, 'text' => '(None)'); foreach ( (array) $vwpalm4is_gf2m1t7v8nbz as $vwpalm4is_vzoj7cv_rsly => $vwpalm4is_agvwtn) { if (! in_array($vwpalm4is_vzoj7cv_rsly, $vwpalm4is_o8bfda195zi) ) { $vwpalm4is_xwlqeir[] = array('id' => $vwpalm4is_vzoj7cv_rsly, 'text' => $vwpalm4is_agvwtn . ' (' . $vwpalm4is_vzoj7cv_rsly . ')'); } } $vwpalm4is_xwlqeir = json_encode($vwpalm4is_xwlqeir); echo '<script>'; echo 'var taglist = ', $vwpalm4is_xwlqeir, ';'; echo '</script>';
