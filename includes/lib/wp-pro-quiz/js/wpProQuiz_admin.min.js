jQuery(function(a){function e(e,t){var i={onChange:null},r={contain:null,pageLeft:null,pageRight:null,currentPage:null},o=function(){var e=r.currentPage.children().length,t=+r.currentPage.val();r.pageLeft.hide(),r.pageRight.hide(),1<t&&r.pageLeft.show(),t+1<=e&&r.pageRight.show()};this.getCurrentPage=function(){return r.currentPage.val()},this.setNumPage=function(e){r.currentPage.empty();for(var t=1;t<=e;t++)a(document.createElement("option")).val(t).text(t).appendTo(r.currentPage);o()},function(){a.extend(r,{contain:e,pageLeft:e.find(".navigationLeft"),pageRight:e.find(".navigationRight"),currentPage:e.find(".navigationCurrentPage")}),a.extend(i,t),r.pageLeft.click(function(){r.currentPage.val(+r.currentPage.val()-1),o(),i.onChange&&i.onChange(r.currentPage.val())}),r.pageRight.click(function(){r.currentPage.val(+r.currentPage.val()+1),o(),i.onChange&&i.onChange(r.currentPage.val())}),r.currentPage.change(function(){o(),i.onChange&&i.onChange(r.currentPage.val())})}()}a.fn.wpProQuiz_preview=function(){var t={openPreview:function(e){window.open(a(e).attr("href"),"wpProQuizPreview","width=900,height=900")}};(function(){a(".wpProQuiz_prview").click(function(a){t.openPreview(this),a.preventDefault()})})()},a.fn.wpProQuiz_quizOverall=function(){var t={changeExport:function(e){$input=a(e),$export=a(".wpProQuiz_exportList"),$ul=$export.find("ul").first(),$export.find("li").remove(),a("input[name=\"exportItems\"]").each(function(){if($this=a(this),this.checked){var e=$this.parent().parent().find(".wpProQuiz_quizName a:eq(0)").text();a("<li>"+e+"</li>").appendTo($ul)}})},startExport:function(){return($ele=a("input[name=\"exportItems\"]:checked"),1>$ele.length)?(alert(wpProQuizLocalize.no_selected_quiz),!1):($hidden=a("#exportHidden"),$hidden.html(""),a("input[name=\"exportItems\"]").each(function(){$this=a(this),this.checked&&a("<input type=\"hidden\" value=\""+this.value+"\" name=\"exportIds[]\">").appendTo($hidden)}),!0)}};(function(){a(".wpProQuiz_delete").click(function(t){var e=confirm(wpProQuizLocalize.delete_msg);return!!e||(t.preventDefault(),!1)}),a(".wpProQuiz_import").click(function(t){t.preventDefault(),a(".wpProQuiz_importList").toggle("fast"),a(".wpProQuiz_exportList").hide(),a(".wpProQuiz_exportCheck").hide()}),a(".wpProQuiz_export").click(function(t){t.preventDefault(),a(".wpProQuiz_exportList").toggle("fast"),a(".wpProQuiz_exportCheck").toggle("fast"),a(".wpProQuiz_importList").hide()}),a("input[name=\"exportItems\"]").change(function(){t.changeExport(this)}),a("input[name=\"exportItemsAll\"]").change(function(){var e=a("input[name=\"exportItems\"]");this.checked?e.attr("checked",!0):e.attr("checked",!1),e.change()}),a("#exportStart").click(function(a){t.startExport()||a.preventDefault()})})()},a.fn.wpProQuiz_questionOverall=function(){var t={saveSort:function(){var e=jQuery("#wpProQuiz_nonce").data("nonce"),i={action:"wp_pro_quiz_update_sort",nonce:e,sort:t.parseSortArray()},r=window.location.pathname+window.location.search,o=r.replace("admin.php","admin-ajax.php")+"&action=save_sort";a.post(o,i,function(){a("#sortMsg").show(400).delay(1e3).hide(400)})},parseSortArray:function(){var e=[];return a("tbody tr").each(function(){e.push(this.id.replace("wpProQuiz_questionId_",""))}),e},sortUpdate:function(){a(".wpProQuiz_questionOverall tbody").children().each(function(){$t=a(this).children().first().text(a(this).index()+1)})},loadQuestionCopy:function(){var e=a("#questionCopySelect"),t=window.location.pathname+window.location.search,i=t.replace("admin.php","admin-ajax.php")+"&action=load_question",r=jQuery("#wpProQuiz_nonce").data("nonce");e.hide(),e.empty(),a("#loadDataImg").show(),a.post(i,{action:"wp_pro_quiz_load_question",nonce:r,excludeId:1},function(t){a.each(t,function(t,i){var r=a(document.createElement("optgroup"));r.attr("label",i.name),a.each(i.question,function(e,t){a(document.createElement("option")).val(t.id).text(t.name).appendTo(r)}),e.append(r)}),a("#loadDataImg").hide(),e.show()},"json")}};(function(){a(".wp-list-table tbody").sortable({handle:".wpProQuiz_move",update:t.sortUpdate}),a(".wpProQuiz_delete").click(function(t){var e=confirm(wpProQuizLocalize.delete_msg);return!!e||(t.preventDefault(),!1)}),a("#wpProQuiz_saveSort").click(function(a){a.preventDefault(),t.saveSort()}),a("#wpProQuiz_questionCopy").click(function(i){var e=a(".wpProQuiz_questionCopy");e.is(":visible")?e.hide():(e.show(),t.loadQuestionCopy()),i.preventDefault()})})()},a.fn.wpProQuiz_quizEdit=function(){var t={addResult:function(){a("#resultList").children().each(function(){if("none"==a(this).css("display")){var e=a(this),t=e.find("textarea[name=\"resultTextGrade[text][]\"]"),i=t.attr("id"),r=!0;return e.find("input[name=\"resultTextGrade[prozent][]\"]").val("1"),e.find("input[name=\"resultTextGrade[activ][]\"]").val("1").keyup(),"undefined"==typeof tinymce||null==tinymce.editors[i]||tinymce.editors[i].isHidden()||(r=!1),null==switchEditors||r||(switchEditors.go(i,"toggle"),switchEditors.go(i,"toggle")),"undefined"!=typeof tinymce&&null!=tinymce.editors[i]?tinymce.editors[i].setContent(""):t.val(""),"undefined"==typeof tinymce||null==tinymce.editors[i]||r||tinyMCE.execCommand("mceRemoveControl",!1,i),e.parent().children(":visible").last().after(e),"undefined"==typeof tinymce||null==tinymce.editors[i]||r||tinyMCE.execCommand("mceAddControl",!1,i),a(this).show(),null==switchEditors||r||switchEditors.go(i,"toggle"),!1}})},deleteResult:function(t){a(t).parent().parent().hide(),a(t).siblings("input[name=\"resultTextGrade[activ][]\"]").val("0")},changeResult:function(i){var e=a(i);return t.validResultInput(e.val())?(e.siblings(".resultProzent").text(e.val()),e.removeAttr("style"),!0):(e.css("background-color","#FF9696"),!1)},validResultInput:function(e){return!i(e)&&(e=e.replace(/\,/,"."),!!(!isNaN(e)&&100>=+e&&0<=+e)&&(null==e.match(/\./)||3>e.split(".")[1].length))},validInput:function(){if(i(a("#wpProQuiz_title").val()))return alert(wpProQuizLocalize.no_title_msg),!1;var e="";if(e="undefined"==typeof tinymce||null==tinymce.editors.text||tinymce.editors.text.isHidden()?a("textarea[name=\"text\"]").val():tinymce.editors.text.getContent(),i(e))return alert(wpProQuizLocalize.no_quiz_start_msg),!1;if(a("#wpProQuiz_resultGradeEnabled:checked").length){var r=!0;if(a("#resultList").children().each(function(){if(a(this).is(":visible")&&!t.validResultInput(a(this).find("input[name=\"resultTextGrade[prozent][]\"]").val()))return r=!1,!1}),!r)return alert(wpProQuizLocalize.fail_grade_result),!1}return!0},resetLock:function(){var e=window.location.pathname+window.location.search,t=e.replace("post.php","admin-ajax.php");t=t.replace("action=edit","action=reset_lock");var i=a("input[name=\"resetQuizLock\"]").data("nonce");a.post(t,{action:"wp_pro_quiz_reset_lock",nonce:i},function(){a("#resetLockMsg").show("fast").delay(2e3).hide("fast")})},generateFormIds:function(){var e=0;a("#form_table tbody > tr").each(function(){a(this).find("[name^=\"form[]\"]").each(function(){var t=a(this).attr("name").substr(6);a(this).attr("name","form["+e+"]"+t)}),++e})}},i=function(e){return e=a.trim(e),!e||0===e.length};(function(){a("#statistics_on").change(function(){this.checked?(a("#statistics_ip_lock_tr").show(),a("#statistics_show_profile_tr").show()):(a("#statistics_ip_lock_tr").hide(),a("#statistics_show_profile_tr").hide())}),a(".addResult").click(function(){t.addResult()}),a(".deleteResult").click(function(){t.deleteResult(this)}),a("input[name=\"resultTextGrade[prozent][]\"]").keyup(function(){t.changeResult(this)}).keydown(function(e){13==e.which&&e.preventDefault()}),a("#wpProQuiz_resultGradeEnabled").change(function(){this.checked?(a("#resultGrade").show(),a("#resultNormal").hide()):(a("#resultGrade").hide(),a("#resultNormal").show())}),window.postL10n?(a("#wpProQuiz_save,input[name=save]").click(function(){t.generateFormIds(),a("select[name=\"prerequisiteList[]\"] option").attr("selected","selected")}),a("#publish").click(function(){t.generateFormIds(),a("select[name=\"prerequisiteList[]\"] option").attr("selected","selected")}),a("#save-post").click(function(){t.generateFormIds(),a("select[name=\"prerequisiteList[]\"] option").attr("selected","selected")})):window.wp.data.subscribe(()=>{!0===window.wp.data.select("core/editor").isSavingPost()&&(t.generateFormIds(),a("select[name=\"prerequisiteList[]\"] option").attr("selected","selected"))}),a("input[name=\"template\"]").click(function(r){return"0"==a("select[name=\"templateSaveList\"]").val()&&i(a("input[name=\"templateName\"]").val())?(alert(wpProQuizLocalize.temploate_no_name),r.preventDefault(),!1):void(t.generateFormIds(),a("select[name=\"prerequisiteList[]\"] option").attr("selected","selected"))}),a("select[name=\"templateSaveList\"]").change(function(){var e=a("input[name=\"templateName\"]");"0"==a(this).val()?e.show():e.hide()}).change(),a("input[name=\"quizRunOnce\"]").change(function(){this.checked?(a("#wpProQuiz_quiz_run_once_type").show(),a("input[name=\"quizRunOnceType\"]:checked").change()):a("#wpProQuiz_quiz_run_once_type").hide()}),a("input[name=\"quizRunOnceType\"]").change(function(){this.checked&&("1"==this.value||"3"==this.value)?a("#wpProQuiz_quiz_run_once_cookie").show():a("#wpProQuiz_quiz_run_once_cookie").hide()}),a("input[name=\"resetQuizLock\"]").click(function(){return t.resetLock(),!1}),a(".wpProQuiz_demoBox a").mouseover(function(t){var e=a(this),i=a(document).width(),r=e.siblings().outerWidth(!0);if(t.pageX+r>i){var o=i-(t.pageX+r+30);a(this).next().css("left",o+"px")}a(this).next().show()}).mouseout(function(){a(this).next().hide()}).click(function(){return!1}),a("input[name=\"showMaxQuestion\"]").change(function(){this.checked?a("#wpProQuiz_showMaxBox").show():a("#wpProQuiz_showMaxBox").hide()}),a("#btnPrerequisiteAdd").click(function(){a("select[name=\"quizList\"] option:selected").removeAttr("selected").appendTo("select[name=\"prerequisiteList[]\"]")}),a("#btnPrerequisiteDelete").click(function(){a("select[name=\"prerequisiteList[]\"] option:selected").removeAttr("selected").appendTo("select[name=\"quizList\"]")}),a("input[name=\"prerequisite\"]").change(function(){this.checked?a("#prerequisiteBox").show():a("#prerequisiteBox").hide()}).change(),a("input[name=\"toplistDataAddMultiple\"]").change(function(){this.checked?a("#toplistDataAddBlockBox").show():a("#toplistDataAddBlockBox").hide()}).change(),a("input[name=\"toplistActivated\"]").change(function(){this.checked?a("#toplistBox > tr:gt(0)").show():a("#toplistBox > tr:gt(0)").hide()}).change(),a("input[name=\"showReviewQuestion\"]").change(function(){this.checked?a(".wpProQuiz_reviewQuestionOptions").show():a(".wpProQuiz_reviewQuestionOptions").hide()}).change(),a("#statistics_on").change(),a("#wpProQuiz_resultGradeEnabled").change(),a("input[name=\"quizRunOnce\"]").change(),a("input[name=\"quizRunOnceType\"]:checked").change(),a("input[name=\"showMaxQuestion\"]").change(),a("#form_add").click(function(){a("#form_table tbody > tr:eq(0)").clone(!0).appendTo("#form_table tbody").show(),a("#form_table tbody tr:last input[type=\"text\"]").focus()}),a("input[name=\"form_delete\"]").click(function(){var e=a(this).parents("tr");"0"==e.find("input[name=\"form[][form_id]\"]").val()?e.remove():(e.find("input[name=\"form[][form_delete]\"]").val(1),e.hide())}),a("#form_table tbody").sortable({handle:".form_move",update:t.sortUpdate}),a(".form_move").click(function(){return!1}),a("select[name=\"form[][type]\"]").change(function(){switch(+a(this).val()){case 7:case 8:a(this).siblings(".editDropDown").show();break;default:a(this).siblings(".editDropDown, .dropDownEditBox").hide();}}).change(),a(".editDropDown").click(function(){return a(".dropDownEditBox").not(a(this).siblings(".dropDownEditBox").toggle()).hide(),!1}),a(".dropDownEditBox input").click(function(){a(this).parent().hide()})})()},a.fn.wpProQuiz_statistics=function(){var e="wpProQuiz_typeAnonymeUser",t=!0,i={loadStatistics:function(e){var t=window.location.pathname+window.location.search,r=t.replace("admin.php","admin-ajax.php")+"&action=load_statistics";a("#wpProQuiz_loadData").show(),a("#wpProQuiz_statistics_content, #wpProQuiz_statistics_overview").hide(),a.post(r,{action:"wp_pro_quiz_load_statistics",userId:e},i.setStatistics,"json")},setStatistics:function(t){var o=a(".wpProQuiz_statistics_table"),n=o.find("tbody");if("wpProQuiz_typeOverview"!=e){var s=function(e,t,a){e.find(".wpProQuiz_cCorrect").text(t.cCorrect+" ("+t.pCorrect+"%)"),e.find(".wpProQuiz_cIncorrect").text(t.cIncorrect+" ("+t.pIncorrect+"%)"),e.find(".wpProQuiz_cTip").text(t.cTip),e.find(".wpProQuiz_cPoints").text(t.cPoints),!0==a&&o.find(".wpProQuiz_cResult").text(t.result+"%")};s(o,t.clear,!1),a.each(t.items,function(e,t){s(n.find("#wpProQuiz_tr_"+t.id),t,!1)}),s(o.find("tfoot"),t.global,!0),a("#wpProQuiz_loadData").hide(),a("#wpProQuiz_statistics_content, .wpProQuiz_statistics_table").show()}},loadOverview:function(){a(".wpProQuiz_statistics_table, #wpProQuiz_statistics_content, #wpProQuiz_statistics_overview").hide(),a("#wpProQuiz_loadData").show();var r=window.location.pathname+window.location.search,o=r.replace("admin.php","admin-ajax.php")+"&action=load_statistics",n={action:"wp_pro_quiz_load_statistics",overview:!0,pageLimit:a("#wpProQuiz_pageLimit").val(),onlyCompleted:+a("#wpProQuiz_onlyCompleted").is(":checked"),page:a("#wpProQuiz_currentPage").val(),generatePageNav:+t};a.post(o,n,function(r){if(a("#wpProQuiz_statistics_overview_data").empty(),"wpProQuiz_typeOverview"==e){var o=a("<tr><th><a href=\"#\">---</a></th><th class=\"wpProQuiz_points\">---</th><th class=\"wpProQuiz_cCorrect\" style=\"color: green;\">---</th><th class=\"wpProQuiz_cIncorrect\" style=\"color: red;\">---</th><th class=\"wpProQuiz_cTip\">---</th><th class=\"wpProQuiz_cResult\" style=\"font-weight: bold;\">---</th></tr>");a.each(r.items,function(e,t){var i=o.clone();i.find("a").text(t.userName).data("userId",t.userId).click(function(){return a("#userSelect").val(a(this).data("userId")),a("#wpProQuiz_typeRegisteredUser").click(),!1}),t.completed?(i.find(".wpProQuiz_points").text(t.cPoints),i.find(".wpProQuiz_cCorrect").text(t.cCorrect+" ("+t.pCorrect+"%)"),i.find(".wpProQuiz_cIncorrect").text(t.cIncorrect+" ("+t.pIncorrect+"%)"),i.find(".wpProQuiz_cTip").text(t.cTip),i.find(".wpProQuiz_cResult").text(t.result+"%")):i.find("th").removeAttr("style"),a("#wpProQuiz_statistics_overview_data").append(i)}),null!=r.page&&(i.setPageNav(r.page),t=!1),a("#wpProQuiz_loadData").hide(),a("#wpProQuiz_statistics_overview").show()}},"json")},loadFormOverview:function(){a("#wpProQuiz_tabFormOverview").show()},changeTab:function(t){e=t,"wpProQuiz_typeRegisteredUser"==t?i.loadStatistics(a("#userSelect").val()):"wpProQuiz_typeAnonymeUser"==t?i.loadStatistics(0):"wpProQuiz_typeForm"==t?i.loadFormOverview():i.loadOverview()},resetStatistic:function(t){var r="wpProQuiz_typeRegisteredUser"==e?a("#userSelect").val():0,o=window.location.pathname+window.location.search,n=o.replace("admin.php","admin-ajax.php")+"&action=reset";a.post(n,{action:"wp_pro_quiz_statistics",userId:r,complete:t},function(){i.changeTab(e)})},setPageNav:function(e){e=Math.ceil(e/a("#wpProQuiz_pageLimit").val()),a("#wpProQuiz_currentPage").empty();for(var t=1;t<=e;t++)a(document.createElement("option")).val(t).text(t).appendTo(a("#wpProQuiz_currentPage"));a("#wpProQuiz_pageLeft, #wpProQuiz_pageRight").hide(),1<a("#wpProQuiz_currentPage option").length&&a("#wpProQuiz_pageRight").show()}};(function(){a(".wpProQuiz_tab").click(function(){var e=a(this);return!e.hasClass("button-primary")&&("wpProQuiz_typeRegisteredUser"==e.attr("id")?a("#wpProQuiz_userBox").show():a("#wpProQuiz_userBox").hide(),a(".wpProQuiz_tab").removeClass("button-primary").addClass("button-secondary"),e.removeClass("button-secondary").addClass("button-primary"),i.changeTab(e.attr("id")),!1)}),a("#userSelect").change(function(){i.changeTab("wpProQuiz_typeRegisteredUser")}),a(".wpProQuiz_update").click(function(){return i.changeTab(e),!1}),a("#wpProQuiz_reset").click(function(){var e=confirm(wpProQuizLocalize.reset_statistics_msg);return e&&i.resetStatistic(!1),!1}),a(".wpProQuiz_resetComplete").click(function(){var e=confirm(wpProQuizLocalize.reset_statistics_msg);return e&&i.resetStatistic(!0),!1}),a("#wpProQuiz_pageLimit, #wpProQuiz_onlyCompleted").change(function(){return a("#wpProQuiz_currentPage").val(0),t=!0,i.changeTab(e),!1}),a("#wpProQuiz_currentPage").change(function(){a("#wpProQuiz_pageLeft, #wpProQuiz_pageRight").hide(),1==a("#wpProQuiz_currentPage option").length||(a("#wpProQuiz_currentPage option:first-child:selected").length?a("#wpProQuiz_pageRight").show():a("#wpProQuiz_currentPage option:last-child:selected").length?a("#wpProQuiz_pageLeft").show():a("#wpProQuiz_pageLeft, #wpProQuiz_pageRight").show()),i.changeTab(e)}),a("#wpProQuiz_pageRight").click(function(){return a("#wpProQuiz_currentPage option:selected").next().attr("selected","selected"),a("#wpProQuiz_currentPage").change(),!1}),a("#wpProQuiz_pageLeft").click(function(){return a("#wpProQuiz_currentPage option:selected").prev().attr("selected","selected"),a("#wpProQuiz_currentPage").change(),!1}),i.changeTab("wpProQuiz_typeAnonymeUser")})()},a.fn.wpProQuiz_toplist=function(){var e={sort:a("#wpProQuiz_sorting"),pageLimit:a("#wpProQuiz_pageLimit"),currentPage:a("#wpProQuiz_currentPage"),loadDataBox:a("#wpProQuiz_loadData"),pageLeft:a("#wpProQuiz_pageLeft"),pageRight:a("#wpProQuiz_pageRight"),dataBody:a("#wpProQuiz_toplistTable tbody"),rowClone:a("#wpProQuiz_toplistTable tbody tr:eq(0)").clone(),content:a("#wpProQuiz_content")},t={loadData:function(t){var i=window.location.pathname+window.location.search,r=i.replace("admin.php","admin-ajax.php")+"&action=load_toplist",o=a("#wpProQuiz_loadData").data("nonce"),n=this,s={action:"wp_pro_quiz_load_toplist",nonce:o,sort:e.sort.val(),limit:e.pageLimit.val(),page:e.currentPage.val()};t!=null&&a.extend(s,t),e.loadDataBox.show(),e.content.hide(),a.post(r,s,function(t){n.handleDataRequest(t.data),t.nav!=null&&n.handleNav(t.nav),e.loadDataBox.hide(),e.content.show()},"json")},handleNav:function(t){e.currentPage.empty();for(var r=1;r<=t.pages;r++)a(document.createElement("option")).val(r).text(r).appendTo(e.currentPage);this.checkNav()},handleDataRequest:function(t){var i=this;e.dataBody.empty(),a.each(t,function(t,a){var i=e.rowClone.clone().children();i.eq(0).children().val(a.id),i.eq(1).find("strong").text(a.name),i.eq(1).find(".inline_editUsername").val(a.name),i.eq(2).find(".wpProQuiz_email").text(a.email),i.eq(2).find("input").val(a.email),i.eq(3).text(a.type),i.eq(4).text(a.date),i.eq(5).text(a.points),i.eq(6).text(a.result),i.parent().show().appendTo(e.dataBody)}),t.length||a(document.createElement("td")).attr("colspan","7").text(wpProQuizLocalize.no_data_available).css({"font-weight":"bold","text-align":"center",padding:"5px"}).appendTo(document.createElement("tr")).appendTo(e.dataBody),a(".wpProQuiz_delete").click(function(){if(confirm(wpProQuizLocalize.confirm_delete_entry)){var e=Array(a(this).closest("tr").find("input[name=\"checkedData[]\"]").val());i.loadData({a:"delete",toplistIds:e})}return!1}),a(".wpProQuiz_edit").click(function(){var e=a(this).closest("tr");return e.find(".row-actions").hide(),e.find(".inline-edit").show(),e.find(".wpProQuiz_username, .wpProQuiz_email").hide(),e.find(".inline_editUsername, .inline_editEmail").show(),!1}),a(".inline_editSave").click(function(){var e=a(this).closest("tr"),t=e.find(".inline_editUsername").val(),r=e.find(".inline_editEmail").val();return i.isEmpty(t)||i.isEmpty(r)?(alert(wpProQuizLocalize.not_all_fields_completed),!1):(i.loadData({a:"edit",toplistId:e.find("input[name=\"checkedData[]\"]").val(),name:t,email:r}),!1)}),a(".inline_editCancel").click(function(){var e=a(this).closest("tr");return e.find(".row-actions").show(),e.find(".inline-edit").hide(),e.find(".wpProQuiz_username, .wpProQuiz_email").show(),e.find(".inline_editUsername, .inline_editEmail").hide(),e.find(".inline_editUsername").val(e.find(".wpProQuiz_username").text()),e.find(".inline_editEmail").val(e.find(".wpProQuiz_email").text()),!1})},checkNav:function(){var t=e.currentPage.val();1==t?e.pageLeft.hide():e.pageLeft.show(),t==e.currentPage.children().length?e.pageRight.hide():e.pageRight.show()},isEmpty:function(e){return e=a.trim(e),!e||0===e.length}};(function(){e.sort.change(function(){t.loadData()}),e.pageLimit.change(function(){t.loadData({nav:1})}),e.currentPage.change(function(){t.checkNav(),t.loadData()}),e.pageLeft.click(function(){e.currentPage.val(+e.currentPage.val()-1),t.checkNav(),t.loadData()}),e.pageRight.click(function(){e.currentPage.val(+e.currentPage.val()+1),t.checkNav(),t.loadData()}),a("#wpProQuiz_deleteAll").click(function(){t.loadData({a:"deleteAll"})}),a("#wpProQuiz_action").click(function(){var e=a("#wpProQuiz_actionName").val();if("0"!=e){var i=a("input[name=\"checkedData[]\"]:checked").map(function(){return a(this).val()}).get();t.loadData({a:e,toplistIds:i})}}),a("#wpProQuiz_checkedAll").change(function(){this.checked?a("input[name=\"checkedData[]\"]").attr("checked","checked"):a("input[name=\"checkedData[]\"]").removeAttr("checked","checked")}),t.loadData({nav:1})})()},a(".wpProQuiz_quizOverall").length&&a(".wpProQuiz_quizOverall").wpProQuiz_preview(),a(".wpProQuiz_quizOverall").length&&a(".wpProQuiz_quizOverall").wpProQuiz_quizOverall(),a(".wpProQuiz_quizEdit").length&&a(".wpProQuiz_quizEdit").wpProQuiz_quizEdit(),a(".wpProQuiz_questionOverall").length&&a(".wpProQuiz_questionOverall").wpProQuiz_questionOverall(),a(".wpProQuiz_toplist").length&&a(".wpProQuiz_toplist").wpProQuiz_toplist(),function(){function t(e){""!=e&&(a(e).css("float","none"),a(e).css("visibility","visible"),a(e).show())}function i(e){""!=e&&(a(e).hide(),a(e).css("visibility","hidden"))}function r(e){""!=e&&a(e).show().fadeOut(1500)}var o=this;o={displayChecked:function(e,t,a,i){var r=a?!e.checked:e.checked;i?r?t.attr("disabled","disabled"):t.removeAttr("disabled"):r?t.show():t.hide()},isEmpty:function(e){return e=a.trim(e),!e||0===e.length},isNumber:function(e){return e=a.trim(e),!o.isEmpty(e)&&!isNaN(e)},getMceContent:function(e){if("undefined"==typeof tinymce||typeof tinymce==null||"undefined"==typeof tinymce.editors)return a("#"+e).val();var t=tinymce.editors[e];return null==t||t.isHidden()?a("#"+e).val():t.getContent()},ajaxPost:function(e,t,i){var r=jQuery("#wpProQuiz_nonce").data("nonce");a.post(ajaxurl,{action:"wp_pro_quiz_admin_ajax",nonce:r,func:e,data:t},i,"json")}};var n=function(){a(".wpProQuiz_tab_wrapper a").click(function(){var e=a(this),t=e.data("tab"),i=e.siblings(".button-primary").removeClass("button-primary").addClass("button-secondary");return e.removeClass("button-secondary").addClass("button-primary"),a(i.data("tab")).hide("fast"),a(t).show("fast"),a(document).trigger({type:"changeTab",tabId:t}),!1})},s={gobalSettings:function(){var e={categoryDelete:function(e){t(".categorySpinner"),o.ajaxPost("categoryDelete",{categoryId:e},function(t){t.err||(i(".categorySpinner"),r(".categoryDeleteUpdate"),a("select[name=\"category\"] option[value=\""+e+"\"]").remove(),a("select[name=\"category\"]").change())})},categoryEdit:function(e,n){var s={categoryId:e,categoryName:a.trim(n)};return o.isEmpty(n)?void alert(wpProQuizLocalize.category_no_name):void(t(".categorySpinner"),o.ajaxPost("categoryEdit",s,function(t){t.err||(i(".categorySpinner"),r(".categoryEditUpdate"),a("select[name=\"category\"] option[value=\""+e+"\"]").text(s.categoryName),a("select[name=\"category\"]").val(""),a("select[name=\"category\"]").change())}))},changeTimeFormat:function(e,t){"0"!=t.val()&&a("input[name=\""+e+"\"]").val(t.val())},templateDelete:function(e,n){n?t(".templateQuestionSpinner"):t(".templateQuizSpinner"),o.ajaxPost("templateDelete",{templateId:e,type:n},function(t){t.err||(n?(i(".templateQuestionSpinner"),r(".templateQuestionDeleteUpdate"),a("select[name=\"templateQuestion\"] option[value=\""+e+"\"]").remove(),a("select[name=\"templateQuestion\"]").val(""),a("select[name=\"templateQuestion\"]").change()):(i(".templateQuizSpinner"),r(".templateQuizDeleteUpdate"),a("select[name=\"templateQuiz\"] option[value=\""+e+"\"]").remove(),a("select[name=\"templateQuiz\"]").val(""),a("select[name=\"templateQuiz\"]").change()))})},templateEdit:function(e,n,s){if(o.isEmpty(n))return void alert(wpProQuizLocalize.category_no_name);var c={templateId:e,name:a.trim(n),type:s};s?t(".templateQuestionSpinner"):t(".templateQuizSpinner"),o.ajaxPost("templateEdit",c,function(t){t.err||(s?(i(".templateQuestionSpinner"),r(".templateQuestionEditUpdate"),a("select[name=\"templateQuestion\"] option[value=\""+e+"\"]").text(c.name),a("select[name=\"templateQuestion\"]").val(""),a("select[name=\"templateQuestion\"]").change()):(i(".templateQuizSpinner"),r(".templateQuizEditUpdate"),a("select[name=\"templateQuiz\"] option[value=\""+e+"\"]").text(c.name),a("select[name=\"templateQuiz\"]").val(""),a("select[name=\"templateQuiz\"]").change()))})}};(function(){a("select[name=\"category\"]").change(function(){""==a(this).val()?a("input[name=\"categoryEditText\"]").val(""):a("input[name=\"categoryEditText\"]").val(a("option:selected",this).text())}),a("input[name=\"categoryDelete\"]").click(function(){var t=a("select[name=\"category\"] option:selected").val();""!=t&&e.categoryDelete(t)}),a("input[name=\"categoryEdit\"]").click(function(){var t=a("select[name=\"category\"] option:selected").val();if(""!=t){var i=a("input[name=\"categoryEditText\"]").val();e.categoryEdit(t,i)}}),a("select[name=\"templateQuiz\"]").change(function(){""==a(this).val()?a("input[name=\"templateQuizEditText\"]").val(""):a("input[name=\"templateQuizEditText\"]").val(a("option:selected",this).text())}),a("input[name=\"templateQuizEdit\"]").click(function(){var t=a("select[name=\"templateQuiz\"] option:selected").val();if(""!=t){var i=a("input[name=\"templateQuizEditText\"]").val();e.templateEdit(t,i,0)}}),a("input[name=\"templateQuizDelete\"]").click(function(){var t=a("select[name=\"templateQuiz\"] option:selected").val();""!=t&&e.templateDelete(t,0)}),a("select[name=\"templateQuestion\"]").change(function(){""==a(this).val()?a("input[name=\"templateQuestionEditText\"]").val(""):a("input[name=\"templateQuestionEditText\"]").val(a("option:selected",this).text())}),a("input[name=\"templateQuestionEdit\"]").click(function(){var t=a("select[name=\"templateQuestion\"] option:selected").val();if(""!=t){var i=a("input[name=\"templateQuestionEditText\"]").val();e.templateEdit(t,i,1)}}),a("input[name=\"templateQuestionDelete\"]").click(function(){var t=a("select[name=\"templateQuestion\"] option:selected").val();""!=t&&e.templateDelete(t,1)}),a("#statistic_time_format_select").change(function(){e.changeTimeFormat("statisticTimeFormat",a(this))}),a(document).bind("changeTab",function(e){switch(a("#problemInfo").hide("fast"),e.tabId){case"#problemContent":a("#problemInfo").show("fast");break;case"#emailSettingsTab":}})})()},questionEdit:function(){var t=this,i=a.noop(),r={answerChildren:a(".answer_felder > div"),pointsModus:a("input[name=\"answerPointsActivated\"]"),gPoints:a("input[name=\"points\"]")};t={generateArrayIndex:function(){var e=a("input[name=\"answerType\"]:checked").val();e="single"==e||"multiple"==e?"classic_answer":e,a(".answerList").each(function(){var t=a(this).parent().attr("class");a(this).children().each(function(r){a(this).find("[name^=\"answerData\"]").each(function(){var a=this.name,i=a.search(/\](\[\w+\])+$/),o=e==t?r:"none";0<i&&(this.name="answerData["+o+a.substring(i,a.length))})})})},globalValidate:function(){if("undefined"!==typenow&&"sfwd-question"==typenow){if(o.isEmpty(o.getMceContent("content")))return alert(wpProQuizLocalize.no_question_msg),!1;}else if(o.isEmpty(o.getMceContent("question")))return alert(wpProQuizLocalize.no_question_msg),!1;if(!r.pointsModus.is(":checked")){var e=r.gPoints.val();if(!o.isNumber(e)||1>e)return alert(wpProQuizLocalize.no_nummber_points),!1}else if("free_answer"==a("input[name=\"answerType\"]:checked").val())return alert(wpProQuizLocalize.dif_points),!1;return!0},answerRemove:function(){var e=a(this).parent();return 1<e.parent().children().length?e.remove():alert(wpProQuizLocalize.no_delete_answer),!1},addCategory:function(){var e=a.trim(a("input[name=\"categoryAdd\"]").val()),t=jQuery("#wpProQuiz_nonce").data("nonce");if(!o.isEmpty(e)){o.ajaxPost("categoryAdd",{categoryName:e,nonce:t},function(e){if(e.err)return void a("#categoryMsgBox").text(e.err).show("fast").delay(2e3).hide("fast");var t=a(document.createElement("option")).val(e.categoryId).text(e.categoryName).attr("selected","selected");a("select[name=\"category\"]").append(t).change()})}},addMediaClick:function(){var e,t=a(this).closest("li"),i=t.find("input[name=\"answerData[][html]\"]:eq(0)"),r=t.find(".wpProQuiz_text:eq(0)");return void 0===e?void(e=wp.media.frames.media_upload_frame=wp.media({frame:"select",library:{type:["image","audio","video"]},multiple:!1}),e.on("select",function(){var t=e.state().get("selection").first().toJSON();"image"===t.type&&(r.val(r.val()+"<img src=\""+t.url+"\" alt=\""+t.alt+"\" />"),i.attr("checked",!0)),"audio"===t.type&&(r.val(r.val()+"[audio src=\""+t.url+"\"][/audio]"),i.attr("checked",!0)),"video"===t.type&&(r.val(r.val()+"[video src=\""+t.url+"\"][/video]"),i.attr("checked",!0))}),e.open()):void e.open()}};var n={classic_answer:function(){var e=0,i=0,n=0;return a(".classic_answer .answerList").children().each(function(){var r=a(this);if(!o.isEmpty(r.find("textarea[name=\"answerData[][answer]\"]").val())){e++,r.find("input[name=\"answerData[][correct]\"]:checked").length&&i++;var t=r.find("input[name=\"answerData[][points]\"]").val();o.isNumber(t)&&0<=t&&n++}}),e?i||a("input[name=\"disableCorrect\"]").is(":checked")&&a("input[name=\"answerPointsDiffModusActivated\"]").is(":checked")&&a("input[name=\"answerPointsActivated\"]").is(":checked")&&"single"==a("input[name=\"answerType\"]:checked").val()?!(n!=e&&r.pointsModus.is(":checked"))||(alert(wpProQuizLocalize.no_nummber_points_new),!1):(alert(wpProQuizLocalize.no_correct_msg),!1):(alert(wpProQuizLocalize.no_answer_msg),!1)},free_answer:function(){return!o.isEmpty(a(".free_answer textarea[name=\"answerData[][answer]\"]").val())||(alert(wpProQuizLocalize.no_answer_msg),!1)},cloze_answer:function(){return!o.isEmpty(o.getMceContent("cloze"))||(alert(wpProQuizLocalize.no_answer_msg),!1)},sort_answer:function(){var e=0,i=0;return a(".sort_answer .answerList").children().each(function(){var r=a(this);if(!o.isEmpty(r.find("textarea[name=\"answerData[][answer]\"]").val())){e++;var t=r.find("input[name=\"answerData[][points]\"]").val();o.isNumber(t)&&0<=t&&i++}}),e?!(i!=e&&r.pointsModus.is(":checked"))||(alert(wpProQuizLocalize.no_nummber_points_new),!1):(alert(wpProQuizLocalize.no_answer_msg),!1)},matrix_sort_answer:function(){var e=0,i=0,n=!0,s=0;return a(".matrix_sort_answer .answerList").children().each(function(){var r=a(this),t=r.find("input[name=\"answerData[][points]\"]").val();o.isEmpty(r.find("textarea[name=\"answerData[][answer]\"]").val())?!o.isEmpty(r.find("textarea[name=\"answerData[][sort_string]\"]").val())&&(s++,o.isNumber(t)&&0<=t&&i++):(e++,s++,o.isEmpty(r.find("textarea[name=\"answerData[][sort_string]\"]").val())&&(n=!1),o.isNumber(t)&&0<=t&&i++)}),e?n?!(i!=s&&r.pointsModus.is(":checked"))||(alert(wpProQuizLocalize.no_nummber_points_new),!1):(alert(wpProQuizLocalize.no_sort_element_criterion),!1):(alert(wpProQuizLocalize.no_answer_msg),!1)},assessment_answer:function(){return!o.isEmpty(o.getMceContent("assessment"))||(alert(wpProQuizLocalize.no_answer_msg),!1)}},s=function(){a("#wpProQuiz_tip").change(function(){o.displayChecked(this,a("#wpProQuiz_tipBox"))}).change(),a("#wpProQuiz_correctSameText").change(function(){o.displayChecked(this,a("#wpProQuiz_incorrectMassageBox"),!0),o.displayChecked(this,a("#learndash_question_message_incorrect_answer"),!0)}),a("input[name=\"answerType\"]").click(function(){r.answerChildren.hide();var e=this.value;if("single"==e?("undefined"!==typenow&&"sfwd-question"==typenow?a("#learndash_question_single_choice_options").show():a("#singleChoiceOptions").show(),a("input[name=\"disableCorrect\"]").change()):("undefined"!==typenow&&"sfwd-question"==typenow?a("#learndash_question_single_choice_options").hide():a("#singleChoiceOptions").hide(),a(".classic_answer .wpProQuiz_classCorrect").parent().parent().show()),"single"==e||"multiple"==e){var t="single"==e?"radio":"checkbox";e="classic_answer",a(".wpProQuiz_classCorrect").each(function(){a("<input type="+t+" />").attr({name:this.name,value:this.value,checked:this.checked}).addClass("wpProQuiz_classCorrect wpProQuiz_checkbox").insertBefore(this)}).remove()}"essay"==e?(a("input[name=\"answerPointsActivated\"]").attr("checked",!1),a("input[name=\"showPointsInBox\"]").attr("checked",!1),a("input[name=\"points\"]").attr("disabled",!1),a("#wpProQuiz_answerPointsActivated").hide(),a("#wpProQuiz_correctMessageBox").hide(),a("#learndash_question_message_correct_answer").hide(),a("input[name=\"correctSameText\"]").attr("checked",!1),a("textarea[name=\"correctMsg\"]").val(""),a("#wpProQuiz_incorrectMassageBox").hide(),a("#learndash_question_message_incorrect_answer").hide(),a("textarea[name=\"incorrectMsg\"]").val(""),a("#wpProQuiz_showPointsBox").hide()):(a("#wpProQuiz_answerPointsActivated").show(),a("#wpProQuiz_correctMessageBox").show(),a("#learndash_question_message_correct_answer").show(),a("#wpProQuiz_incorrectMassageBox").show(),a("#learndash_question_message_incorrect_answer").show()),i=null==n[e]?a.noop():n[e],a("."+e).show()}),a("input[name=\"answerType\"]:checked").click(),a("#wpProQuiz_correctSameText").change(),a(".deleteAnswer").click(t.answerRemove),a(".addAnswer").click(function(){var e=a(this).attr("data-default-value");null==e&&(e=0);var i=a(this).siblings("ul"),r=i.find("li:eq(0)").clone();return r.find(".wpProQuiz_checkbox").removeAttr("checked"),r.find(".wpProQuiz_text").val(""),r.find(".wpProQuiz_points").val(e),r.find(".deleteAnswer").click(t.answerRemove),r.find(".addMedia").click(t.addMediaClick),r.appendTo(i),!1}),a(".sort_answer ul, .classic_answer ul, .matrix_sort_answer ul").sortable({handle:".wpProQuiz_move"}),a("#saveQuestion").click(function(){return!!t.globalValidate()&&(t.generateArrayIndex(),!0)}),a("#publish").click(function(){return!!t.globalValidate()&&(t.generateArrayIndex(),!0)}),a("#save-post").click(function(){return!!t.globalValidate()&&(t.generateArrayIndex(),!0)}),a(r.pointsModus).change(function(){o.displayChecked(this,a(".wpProQuiz_answerPoints")),o.displayChecked(this,a("#wpProQuiz_showPointsBox")),o.displayChecked(this,r.gPoints,!1,!0),o.displayChecked(this,a("input[name=\"answerPointsDiffModusActivated\"]"),!0,!0),this.checked?(a("input[name=\"answerPointsDiffModusActivated\"]").change(),a("input[name=\"disableCorrect\"]").change()):(a(".classic_answer .wpProQuiz_classCorrect").parent().parent().show(),a("input[name=\"disableCorrect\"]").attr("disabled","disabled"))}).change(),a("select[name=\"category\"]").change(function(){var e=a(this),t=a("#categoryAddBox").hide();"-1"==e.val()&&t.show()}).change(),a("#categoryAddBtn").click(function(){t.addCategory()}),a(".addMedia").click(t.addMediaClick),a("input[name=\"answerPointsDiffModusActivated\"]").change(function(){o.displayChecked(this,a("input[name=\"disableCorrect\"]"),!0,!0),this.checked?a("input[name=\"disableCorrect\"]").change():a(".classic_answer .wpProQuiz_classCorrect").parent().parent().show()}).change(),a("input[name=\"disableCorrect\"]").change(function(){o.displayChecked(this,a(".classic_answer .wpProQuiz_classCorrect").parent().parent(),!0)}).change(),a("#clickPointDia").click(function(){return a(".pointDia").toggle("fast"),!1}),a("input[name=\"template\"]").click(function(i){return"0"==a("select[name=\"templateSaveList\"]").val()&&o.isEmpty(a("input[name=\"templateName\"]").val())?(alert(wpProQuizLocalize.temploate_no_name),i.preventDefault(),!1):void t.generateArrayIndex()}),a("select[name=\"templateSaveList\"]").change(function(){var e=a("input[name=\"templateName\"]");"0"==a(this).val()?e.show():e.hide()}).change()};(function(){r.answerChildren.hide(),s()})()},statistic:function(){var e=this,t=a("#quizId").val(),i="users",r={currentPage:a("#wpProQuiz_currentPage"),pageLeft:a("#wpProQuiz_pageLeft"),pageRight:a("#wpProQuiz_pageRight"),testSelect:a("#testSelect")};e={loadStatistic:function(e){o.ajaxPost("statisticLoad",{userId:e},function(){})},loadUsersStatistic:function(){var i=a("#userSelect").val(),r={userId:i,quizId:t,testId:a("#testSelect").val()};e.toggleLoadBox(!1),o.ajaxPost("statisticLoad",r,function(t){a.each(t.question,function(){var t=a("#wpProQuiz_tr_"+this.questionId);e.setStatisticData(t,this)}),a.each(t.category,function(t,i){var r=a("#wpProQuiz_ctr_"+t);e.setStatisticData(r,i)}),a("#testSelect option:gt(0)").remove();var i=a("#testSelect");a.each(t.tests,function(){var e=a(document.createElement("option"));e.val(this.id),e.text(this.date),t.testId==this.id&&e.attr("selected",!0),i.append(e)}),e.parseFormData(t.formData),e.toggleLoadBox(!0)})},loadUsersStatistic_:function(i,r){e.toggleLoadBox(!1),o.ajaxPost("statisticLoad",{userId:i,quizId:t,testId:r},function(t){a.each(t.question,function(){var t=a("#wpProQuiz_tr_"+this.questionId);e.setStatisticData(t,this)}),a.each(t.category,function(t,i){var r=a("#wpProQuiz_ctr_"+t);e.setStatisticData(r,i)}),a("#testSelect option:gt(0)").remove();var o=a("#testSelect");a.each(t.tests,function(){var e=a(document.createElement("option"));e.val(this.id),e.text(this.date),t.testId==this.id&&e.attr("selected",!0),o.append(e)}),e.parseFormData(t.formData),a("#userSelect").val(i),a("#testSelect").val(r),e.toggleLoadBox(!0)})},parseFormData:function(e){var t=a("#wpProQuiz_form_box");return null==e?void t.hide():void(a.each(e,function(e,t){a("#form_id_"+e).text(t)}),t.show())},setStatisticData:function(e,t){e.find(".wpProQuiz_cCorrect").text(t.correct),e.find(".wpProQuiz_cIncorrect").text(t.incorrect),e.find(".wpProQuiz_cTip").text(t.hint),e.find(".wpProQuiz_cPoints").text(t.points),e.find(".wpProQuiz_cResult").text(t.result),e.find(".wpProQuiz_cTime").text(t.questionTime),e.find(".wpProQuiz_cCreateTime").text(t.date)},toggleLoadBox:function(e){var t=a("#wpProQuiz_loadData"),i=a("#wpProQuiz_content");e?(t.hide(),i.show()):(i.hide(),t.show())},reset:function(i){var n=a("#userSelect").val();if(confirm(wpProQuizLocalize.reset_statistics_msg)){var s={quizId:t,userId:n,testId:r.testSelect.val(),type:i};e.toggleLoadBox(!1),o.ajaxPost("statisticReset",s,function(){e.loadUsersStatistic()})}},loadStatisticOverview:function(i){var n={quizId:t,pageLimit:a("#wpProQuiz_pageLimit").val(),onlyCompleted:+a("#wpProQuiz_onlyCompleted").is(":checked"),page:r.currentPage.val(),nav:+i};e.toggleLoadBox(!1),o.ajaxPost("statisticLoadOverview",n,function(t){var i=a("#wpProQuiz_statistics_overview_data"),r=i.children(),o=r.first().clone();r.slice(1).remove(),a.each(t.items,function(){var t=o.clone();e.setStatisticData(t,this),t.find("a").text(this.userName).data("userId",this.userId).click(function(){return a("#userSelect").val(a(this).data("userId")),a("#wpProQuiz_typeUser").click(),!1}),t.show().appendTo(i)}),o.remove(),e.toggleLoadBox(!0),t.page!=null&&e.handleNav(t.page)})},handleNav:function(t){for(var r=a("#wpProQuiz_currentPage").empty(),o=1;o<=t;o++)a(document.createElement("option")).val(o).text(o).appendTo(r);e.checkNavBar()},checkNavBar:function(){var e=r.currentPage.val();1==e?r.pageLeft.hide():r.pageLeft.show(),e==r.currentPage.children().length?r.pageRight.hide():r.pageRight.show()},refresh:function(){"users"==i?e.loadUsersStatistic():"formOverview"==i?e.loadFormsOverview(!0):e.loadStatisticOverview(!0)},loadFormsOverview:function(i){var r={quizId:t,pageLimit:a("#wpProQuiz_fromPageLimit").val(),onlyUser:a("#wpProQuiz_formUser").val(),page:a("#wpProQuiz_formCurrentPage").val(),nav:+i};e.toggleLoadBox(!1),o.ajaxPost("statisticLoadFormOverview",r,function(t){var i=a("#wpProQuiz_statistics_form_data"),r=i.children(),o=r.first().clone();r.slice(1).remove(),a.each(t.items,function(){var t=o.clone();e.setStatisticData(t,this),t.find("a").text(this.userName).data("userId",this.userId).data("testId",this.testId).click(function(){return e.switchTabOnLoad("users"),e.loadUsersStatistic_(a(this).data("userId"),a(this).data("testId")),!1}),t.show().appendTo(i)}),o.remove(),e.toggleLoadBox(!0),t.page!=null&&e.handleFormNav(t.page)})},handleFormNav:function(t){for(var r=a("#wpProQuiz_formCurrentPage").empty(),o=1;o<=t;o++)a(document.createElement("option")).val(o).text(o).appendTo(r);e.checkFormNavBar()},checkFormNavBar:function(){var e=a("#wpProQuiz_formCurrentPage").val();1==e?a("#wpProQuiz_formPageLeft").hide():a("#wpProQuiz_formPageLeft").show(),e==a("#wpProQuiz_formCurrentPage").children().length?a("#wpProQuiz_formPageRight").hide():a("#wpProQuiz_formPageRight").show()},switchTabOnLoad:function(e){a(".wpProQuiz_tab").removeClass("button-primary").addClass("button-secondary"),a(".wpProQuiz_tabContent").hide();var t=a("#wpProQuiz_typeOverview");"users"==e?(i="users",a("#wpProQuiz_tabUsers").show(),t=a("#wpProQuiz_typeUser")):"formOverview"==e?(i="formOverview",a("#wpProQuiz_tabFormOverview").show(),t=a("#wpProQuiz_typeForm")):(i="overview",a("#wpProQuiz_tabOverview").show()),t.removeClass("button-secondary").addClass("button-primary")}};var n=function(){a("#userSelect, #testSelect").change(function(){e.loadUsersStatistic()}),a(".wpProQuiz_update").click(function(){e.refresh()}),a("#wpProQuiz_reset").click(function(){e.reset(0)}),a("#wpProQuiz_resetUser").click(function(){e.reset(1)}),a(".wpProQuiz_resetComplete").click(function(){e.reset(2)}),a(".wpProQuiz_tab").click(function(){var t=a(this);return a(".wpProQuiz_tab").removeClass("button-primary").addClass("button-secondary"),t.removeClass("button-secondary").addClass("button-primary"),a(".wpProQuiz_tabContent").hide(),"wpProQuiz_typeUser"==t.attr("id")?(i="users",a("#wpProQuiz_tabUsers").show(),e.loadUsersStatistic()):"wpProQuiz_typeForm"==t.attr("id")?(i="formOverview",a("#wpProQuiz_tabFormOverview").show(),e.loadFormsOverview(!0)):(i="overview",a("#wpProQuiz_tabOverview").show(),e.loadStatisticOverview(!0)),!1}),a("#wpProQuiz_onlyCompleted").change(function(){r.currentPage.val(1),e.loadStatisticOverview(!0)}),a("#wpProQuiz_pageLimit").change(function(){r.currentPage.val(1),e.loadStatisticOverview(!0)}),r.pageLeft.click(function(){r.currentPage.val(+r.currentPage.val()-1),e.loadStatisticOverview(!1),e.checkNavBar()}),r.pageRight.click(function(){r.currentPage.val(+r.currentPage.val()+1),e.loadStatisticOverview(!1),e.checkNavBar()}),r.currentPage.change(function(){e.loadStatisticOverview(!1),e.checkNavBar()}),a("#wpProQuiz_formUser, #wpProQuiz_fromPageLimit").change(function(){a("#wpProQuiz_formCurrentPage").val(1),e.loadFormsOverview(!0)}),a("#wpProQuiz_formPageLeft").click(function(){a("#wpProQuiz_formCurrentPage").val(+r.currentPage.val()-1),e.loadFormsOverview(!1),e.checkFormNavBar()}),a("#wpProQuiz_formPageRight").click(function(){a("#wpProQuiz_formCurrentPage").val(+r.currentPage.val()+1),e.loadFormsOverview(!1),e.checkFormNavBar()}),a("#wpProQuiz_formCurrentPage").change(function(){e.loadFormsOverview(!1),e.checkFormNavBar()}),e.loadUsersStatistic()};n()},statisticNew:function(){var t=a("#quizId").val(),i=a("#quiz").val(),r=null,n=null,s={data:{quizId:t,quiz:i,users:-1,pageLimit:100,dateFrom:0,dateTo:0,generateNav:0},changeFilter:function(){var e=function(e){var t=e.datepicker("getDate");return null===t?0:t.getTime()/1e3};return a.extend(this.data,{users:a("#wpProQuiz_historyUser").val(),pageLimit:a("#wpProQuiz_historyPageLimit").val(),dateFrom:e(a("#datepickerFrom")),dateTo:e(a("#datepickerTo")),generateNav:1}),this.data}},c={data:{pageLimit:100,onlyCompleted:0,generateNav:0,quizId:t,quiz:i},changeFilter:function(){a.extend(this.data,{pageLimit:a("#wpProQuiz_overviewPageLimit").val(),onlyCompleted:+a("#wpProQuiz_overviewOnlyCompleted").is(":checked"),generateNav:1})}},l={deleteUserStatistic:function(e,i){if(!confirm(wpProQuizLocalize.reset_statistics_msg))return!1;o.ajaxPost("statisticResetNew",{refId:e,userId:i,quizId:t,type:0},function(){a("#wpProQuiz_user_overlay").hide(),s.changeFilter(),d.loadHistoryAjax(),c.changeFilter(),d.loadOverviewAjax()})},deleteAll:function(){if(!confirm(wpProQuizLocalize.reset_statistics_msg))return!1;o.ajaxPost("statisticResetNew",{quizId:t,type:1},function(){s.changeFilter(),d.loadHistoryAjax(),c.changeFilter(),d.loadOverviewAjax()})}},d={loadHistoryAjax:function(){var e=a.extend({page:s.data.generateNav?1:r.getCurrentPage()},s.data);d.loadBox(!0);var t=a("#wpProQuiz_historyLoadContext").hide();o.ajaxPost("statisticLoadHistory",e,function(e){t.html(e.html).show(),e.navi&&r.setNumPage(e.navi),s.data.generateNav=0,t.find(".user_statistic").click(function(){return d.loadUserAjax(0,a(this).data("ref_id"),!1),!1}),t.find(".wpProQuiz_delete").click(function(){return l.deleteUserStatistic(a(this).parents("tr").find(".user_statistic").data("ref_id"),0),!1}),d.loadBox(!1)})},loadUserAjax:function(e,i,r){a("#wpProQuiz_user_overlay, #wpProQuiz_loadUserData").show();var n=a("#wpProQuiz_user_content").hide();o.ajaxPost("statisticLoadUser",{quizId:t,userId:e,refId:i,avg:+r},function(t){n.html(t.html),n.find(".wpProQuiz_update").click(function(){return d.loadUserAjax(e,i,r),!1}),n.find("#wpProQuiz_resetUserStatistic").click(function(){l.deleteUserStatistic(i,e)}),n.find(".statistic_data").click(function(){return a(this).parents("tr").next().toggle("fast"),!1}),a("#wpProQuiz_loadUserData").hide(),jQuery("body").trigger("learndash-statistics-contentchanged"),n.show()})},loadBox:function(e){e?a("#wpProQuiz_loadDataHistory").show():a("#wpProQuiz_loadDataHistory").hide()},loadOverviewAjax:function(){var e=a.extend({page:c.data.generateNav?1:n.getCurrentPage()},c.data);a("#wpProQuiz_loadDataOverview").show();var t=a("#wpProQuiz_overviewLoadContext").hide();o.ajaxPost("statisticLoadOverviewNew",e,function(e){t.html(e.html).show(),e.navi&&n.setNumPage(e.navi),c.data.generateNav=0,t.find(".user_statistic").click(function(){return d.loadUserAjax(a(this).data("user_id"),0,!0),!1}),t.find(".wpProQuiz_delete").click(function(){return l.deleteUserStatistic(0,a(this).parents("tr").find(".user_statistic").data("user_id")),!1}),a("#wpProQuiz_loadDataOverview").hide()})}};(function(){r=new e(a("#historyNavigation"),{onChange:function(){d.loadHistoryAjax()}}),n=new e(a("#overviewNavigation"),{onChange:function(){d.loadOverviewAjax()}}),(a("#datepickerFrom").length||a("#datepickerTo").length)&&(a(document).on("DOMNodeInserted",function(t){"ui-datepicker-div"==t.target.id&&a("#ui-datepicker-div").addClass("learndash-datepicker")}),a("#datepickerFrom").datepicker({closeText:wpProQuizLocalize.closeText,currentText:wpProQuizLocalize.currentText,monthNames:wpProQuizLocalize.monthNames,monthNamesShort:wpProQuizLocalize.monthNamesShort,dayNames:wpProQuizLocalize.dayNames,dayNamesShort:wpProQuizLocalize.dayNamesShort,dayNamesMin:wpProQuizLocalize.dayNamesMin,dateFormat:wpProQuizLocalize.dateFormat,firstDay:wpProQuizLocalize.firstDay,changeMonth:!0,onClose:function(e){a("#datepickerTo").datepicker("option","minDate",e)}}),a("#datepickerTo").datepicker({closeText:wpProQuizLocalize.closeText,currentText:wpProQuizLocalize.currentText,monthNames:wpProQuizLocalize.monthNames,monthNamesShort:wpProQuizLocalize.monthNamesShort,dayNames:wpProQuizLocalize.dayNames,dayNamesShort:wpProQuizLocalize.dayNamesShort,dayNamesMin:wpProQuizLocalize.dayNamesMin,dateFormat:wpProQuizLocalize.dateFormat,firstDay:wpProQuizLocalize.firstDay,changeMonth:!0,onClose:function(e){a("#datepickerFrom").datepicker("option","maxDate",e)}})),a("#filter").click(function(){s.changeFilter(),d.loadHistoryAjax()}),a("#wpProQuiz_overlay_close").click(function(){a("#wpProQuiz_user_overlay").hide()}),a("#wpProQuiz_tabHistory .wpProQuiz_update").click(function(){return s.changeFilter(),d.loadHistoryAjax(),!1}),a("#wpProQuiz_tabOverview .wpProQuiz_update").click(function(){return c.changeFilter(),d.loadOverviewAjax(),!1}),a(".wpProQuiz_resetComplete").click(function(){return l.deleteAll(),!1}),a("#overviewFilter").click(function(){c.changeFilter(),d.loadOverviewAjax()}),s.changeFilter(),d.loadHistoryAjax(),c.changeFilter(),d.loadOverviewAjax()})()}};(function(){n();var e=a.noop;a(".wpProQuiz_questionEdit").length||a("body.learndash-post-type.sfwd-question").length?e=s.questionEdit:a(".wpProQuiz_globalSettings").length?e=s.gobalSettings:a(".wpProQuiz_statistics").length?e=s.statistic:a(".wpProQuiz_statisticsNew").length&&(e=s.statisticNew),e(),a(".wpProQuiz_demoImgBox a").mouseover(function(t){var e=a(this),i=a(document).width(),r=e.siblings().outerWidth(!0);if(t.pageX+r>i){var o=i-(t.pageX+r+30);a(this).next().css("left",o+"px")}a(this).next().show()}).mouseout(function(){a(this).next().hide()}).click(function(){return!1})})()}()});